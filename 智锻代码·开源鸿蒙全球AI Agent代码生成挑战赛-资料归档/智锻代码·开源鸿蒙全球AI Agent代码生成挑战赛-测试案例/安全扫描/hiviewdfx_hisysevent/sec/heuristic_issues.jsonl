{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "adapter/native/idl/src/sys_event_rule.cpp", "line": 42, "evidence": "SysEventRule* ret = new(std::nothrow) SysEventRule();", "description": "内存/对象分配给 ret 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_rule.cpp", "line": 46, "evidence": "if (!parcel.ReadString(ret->domain)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_rule.cpp", "line": 49, "evidence": "if (!parcel.ReadString(ret->eventName)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_rule.cpp", "line": 52, "evidence": "if (!parcel.ReadString(ret->tag)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_rule.cpp", "line": 55, "evidence": "if (!parcel.ReadUint32(ret->ruleType)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_rule.cpp", "line": 58, "evidence": "if (!parcel.ReadUint32(ret->eventType)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 53, "evidence": "if (!ashmem->MapReadAndWriteAshmem()) {", "description": "可能对指针 ashmem 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 64, "evidence": "ashmem->UnmapAshmem();", "description": "可能对指针 ashmem 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 65, "evidence": "ashmem->CloseAshmem();", "description": "可能对指针 ashmem 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 86, "evidence": "if (!ashmem->WriteToAshmem(translated, strlen(translated), offset)) {", "description": "可能对指针 ashmem 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 113, "evidence": "bool ret = ashmem->MapReadAndWriteAshmem();", "description": "可能对指针 ashmem 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 121, "evidence": "auto origin = ashmem->ReadFromAshmem(allSize[i], offset);", "description": "可能对指针 ashmem 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 122, "evidence": "dest.emplace_back(Str8ToStr16(std::string(reinterpret_cast<const char*>(origin))));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 91, "evidence": "offset += allSize[i];", "description": "vector allSize 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "adapter/native/idl/src/ash_mem_utils.cpp", "line": 123, "evidence": "offset += allSize[i];", "description": "vector allSize 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_listener_proxy.cpp", "line": 27, "evidence": "eventListener->OnEvent(domain, eventName, eventType, eventDetail);", "description": "可能对指针 eventListener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_listener_proxy.cpp", "line": 40, "evidence": "return callbackDeathRecipient->GetEventListener();", "description": "可能对指针 callbackDeathRecipient 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_listener_proxy.cpp", "line": 49, "evidence": "eventListener->OnServiceDied();", "description": "可能对指针 eventListener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_query_proxy.cpp", "line": 30, "evidence": "queryCallback->OnQuery(destSysEvents, seq);", "description": "可能对指针 queryCallback 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_query_proxy.cpp", "line": 37, "evidence": "queryCallback->OnComplete(reason, total, seq);", "description": "可能对指针 queryCallback 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "adapter/native/idl/src/hisysevent_delegate.cpp", "line": 73, "evidence": "spListenerCallBack = new OHOS::HiviewDFX::HiSysEventListenerProxy(listener);", "description": "内存/对象分配给 spListenerCallBack 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.55, "severity": "low"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_delegate.cpp", "line": 77, "evidence": "service->RemoveDeathRecipient(spListenerCallBack->GetCallbackDeathRecipient());", "description": "可能对指针 service 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_delegate.cpp", "line": 77, "evidence": "service->RemoveDeathRecipient(spListenerCallBack->GetCallbackDeathRecipient());", "description": "可能对指针 spListenerCallBack 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/hisysevent_delegate.cpp", "line": 222, "evidence": "return sam->CheckSystemAbility(DFX_SYS_EVENT_SERVICE_ABILITY_ID);", "description": "可能对指针 sam 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "adapter/native/idl/src/query_argument.cpp", "line": 42, "evidence": "QueryArgument* ret = new(std::nothrow) QueryArgument();", "description": "内存/对象分配给 ret 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/query_argument.cpp", "line": 46, "evidence": "if (!parcel.ReadInt64(ret->beginTime)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/query_argument.cpp", "line": 49, "evidence": "if (!parcel.ReadInt64(ret->endTime)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/query_argument.cpp", "line": 52, "evidence": "if (!parcel.ReadInt32(ret->maxEvents)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/query_argument.cpp", "line": 55, "evidence": "if (!parcel.ReadInt64(ret->fromSeq)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/query_argument.cpp", "line": 58, "evidence": "if (!parcel.ReadInt64(ret->toSeq)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "adapter/native/idl/src/sys_event_query_rule.cpp", "line": 42, "evidence": "SysEventQueryRule* ret = new SysEventQueryRule();", "description": "内存/对象分配给 ret 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_query_rule.cpp", "line": 46, "evidence": "if (!parcel.ReadUint32(ret->eventType)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_query_rule.cpp", "line": 49, "evidence": "if (!parcel.ReadUint32(ret->ruleType)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_query_rule.cpp", "line": 52, "evidence": "if (!parcel.ReadString(ret->domain)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_query_rule.cpp", "line": 55, "evidence": "if (!parcel.ReadString(ret->condition)) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/src/sys_event_query_rule.cpp", "line": 58, "evidence": "if (!parcel.ReadStringVector(&(ret->eventList))) {", "description": "可能对指针 ret 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "adapter/native/idl/include/iquery_sys_event_callback.h", "line": 25, "evidence": "class IQuerySysEventCallback : public IRemoteBroker {", "description": "类 IQuerySysEventCallback 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "adapter/native/idl/include/parcelable_vector_rw.h", "line": 49, "evidence": "rules.emplace_back(*rulePtr);", "description": "可能对指针 rulePtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_tool_listener.cpp", "line": 36, "evidence": "std::cout << eventJsonDecorator->DecorateEventJsonStr(*sysEvent) << std::endl;", "description": "可能对指针 sysEvent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_tool_listener.cpp", "line": 36, "evidence": "std::cout << eventJsonDecorator->DecorateEventJsonStr(*sysEvent) << std::endl;", "description": "可能对指针 eventJsonDecorator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_tool_listener.cpp", "line": 39, "evidence": "std::cout << sysEvent->AsJson() << std::endl;", "description": "可能对指针 sysEvent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_json_decorator.cpp", "line": 187, "evidence": "if (!reader->parse(origin.data(), origin.data() + origin.size(), &eventJson, &errs)) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_json_decorator.cpp", "line": 205, "evidence": "std::string key = *it;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_json_decorator.cpp", "line": 231, "evidence": "return this->Decorate((iter == marks.end() ? Validity::KV_BOTH_VALID : iter->second), kv.first, kv.second);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/hisysevent_json_decorator.cpp", "line": 50, "evidence": "const std::string VALID_LEVELS[] = { \"        \", \"     \" };", "description": "string VALID_LEVELS 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/main.cpp", "line": 29, "evidence": "if (!client->ParseCmdLine(argc, argv)) {", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/main.cpp", "line": 30, "evidence": "client->DoCmdHelp();", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/main.cpp", "line": 33, "evidence": "if (!client->DoAction()) {", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/main.cpp", "line": 34, "evidence": "client->DoCmdHelp();", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/main.cpp", "line": 40, "evidence": "client->WaitClient();", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 93, "evidence": "key.push_back(json[curPos]);", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 108, "evidence": "value = ParseBrackets(json, json[curPos]);", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 138, "evidence": "number.push_back(json[curPos]);", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 153, "evidence": "txt.push_back(json[curPos]);", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 156, "evidence": "txt.push_back(json[curPos++]);", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 169, "evidence": "} else if (json[curPos] == rightBracket) {", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 175, "evidence": "val.push_back(json[curPos++]);", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/native/json_flatten_parser.cpp", "line": 177, "evidence": "val.push_back(json[curPos++]);", "description": "string json 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_tool_query.cpp", "line": 37, "evidence": "for_each((*sysEvents).cbegin(), (*sysEvents).cend(), [this] (const HiSysEventRecord& sysEventRecord) {", "description": "可能对指针 sysEvents 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/hisysevent_tool_query.cpp", "line": 39, "evidence": "std::cout << this->eventJsonDecorator->DecorateEventJsonStr(sysEventRecord) << std::endl;", "description": "可能对指针 eventJsonDecorator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/native/util/string_util.cpp", "line": 35, "evidence": "char* data = new(std::nothrow) char[src.length() + 1]{0};", "description": "内存/对象分配给 data 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/native/util/string_util.cpp", "line": 52, "evidence": "char* data = new(std::nothrow) char[str.length() + 1]{0};", "description": "内存/对象分配给 data 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/native/util/string_util.cpp", "line": 70, "evidence": "char** data = new(std::nothrow) char* [len]{0};", "description": "内存/对象分配给 data 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/util/string_util.cpp", "line": 43, "evidence": "*dst = data;", "description": "可能对指针 dst 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/util/string_util.cpp", "line": 60, "evidence": "*sp = data;", "description": "可能对指针 sp 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/util/string_util.cpp", "line": 80, "evidence": "*strs = data;", "description": "可能对指针 strs 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/util/include/string_util.h", "line": 35, "evidence": "*p = nullptr;", "description": "可能对指针 p 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/util/include/string_util.h", "line": 43, "evidence": "auto realPs = *ps;", "description": "可能对指针 ps 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "frameworks/native/c_wrapper/include/hisysevent_rust_listener.h", "line": 25, "evidence": "class HiSysEventRustListener : public OHOS::HiviewDFX::HiSysEventListener {", "description": "类 HiSysEventRustListener 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 53, "evidence": "auto records = new(std::nothrow) HiSysEventRecordC[size];", "description": "内存/对象分配给 records 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 48, "evidence": "if (sysEvents == nullptr || sysEvents->empty()) {", "description": "可能对指针 sysEvents 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 49, "evidence": "querier_->onQueryWrapperCb(querier_->onQueryRustCb, nullptr, 0);", "description": "可能对指针 querier_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 52, "evidence": "size_t size = sysEvents->size();", "description": "可能对指针 sysEvents 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 59, "evidence": "if (HiSysEventRecordConvertor::ConvertRecord(sysEvents->at(i), records[i]) != 0) {", "description": "可能对指针 sysEvents 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 65, "evidence": "querier_->onQueryWrapperCb(querier_->onQueryRustCb, records, size);", "description": "可能对指针 querier_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 75, "evidence": "querier_->onCompleteWrapperCb(querier_->onCompleteRustCb, reason, total);", "description": "可能对指针 querier_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 81, "evidence": "if ((querier == nullptr) || (querier->status == STATUS_MEM_FREED)) {", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 84, "evidence": "if (querier->status == STATUS_MEM_NEED_RECYCLE) {", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 85, "evidence": "querier->status = STATUS_MEM_FREED;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_querier.cpp", "line": 89, "evidence": "querier->status = STATUS_MEM_NEED_RECYCLE;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 50, "evidence": "if (querier == nullptr || querier->status != STATUS_NORMAL) {", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 69, "evidence": "beginTime = arg->beginTime;", "description": "可能对指针 arg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 70, "evidence": "endTime = arg->endTime;", "description": "可能对指针 arg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 71, "evidence": "maxEvents = arg->maxEvents;", "description": "可能对指针 arg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 79, "evidence": "g_queriers[std::make_pair(querier->onQueryRustCb, querier->onCompleteRustCb)] = querierRust;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 87, "evidence": "if (watcher == nullptr || watcher->status != STATUS_NORMAL) {", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 103, "evidence": "g_baseWatchers[std::make_pair(watcher->onEventRustCb, watcher->onServiceDiedRustCb)] = baseListenerRust;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 107, "evidence": "g_watchers[std::make_pair(watcher->onEventRustCb, watcher->onServiceDiedRustCb)] = listenerRust;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 114, "evidence": "if (watcher == nullptr || watcher->status != STATUS_NORMAL) {", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 117, "evidence": "auto watcherKey = std::make_pair(watcher->onEventRustCb, watcher->onServiceDiedRustCb);", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 122, "evidence": "auto ret = HiSysEventBaseManager::RemoveListener(watcherIter->second);", "description": "可能对指针 watcherIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 128, "evidence": "g_baseWatchers.erase(watcherIter->first);", "description": "可能对指针 watcherIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 138, "evidence": "auto watcherKey = std::make_pair(watcher->onEventRustCb, watcher->onServiceDiedRustCb);", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 143, "evidence": "auto listener = watcherIter->second;", "description": "可能对指针 watcherIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 145, "evidence": "listener->RecycleWatcher(watcher);", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 149, "evidence": "g_watchers.erase(watcherIter->first);", "description": "可能对指针 watcherIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 158, "evidence": "auto querierKey = std::make_pair(querier->onQueryRustCb, querier->onCompleteRustCb);", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 163, "evidence": "auto callback = querierIter->second;", "description": "可能对指针 querierIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 165, "evidence": "callback->RecycleQuerier(querier);", "description": "可能对指针 callback 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 169, "evidence": "g_queriers.erase(querierIter->first);", "description": "可能对指针 querierIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 60, "evidence": "eventList.emplace_back(rules[i].eventList[j]);", "description": "vector eventList 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 178, "evidence": "int OhHiSysEventAddRustWatcher(HiSysEventRustWatcherC* watcher, const HiSysEventWatchRule watchRules[],", "description": "vector watchRules 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_manager.cpp", "line": 189, "evidence": "int OhHiSysEventRustQuery(HiSysEventQueryArg* queryArg, const HiSysEventQueryRule queryRules[],", "description": "vector queryRules 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_listener.cpp", "line": 48, "evidence": "HiSysEventRecordConvertor::ConvertRecord(*sysEvent, record);", "description": "可能对指针 sysEvent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_listener.cpp", "line": 49, "evidence": "watcher_->onEventWrapperCb(watcher_->onEventRustCb, record);", "description": "可能对指针 watcher_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_listener.cpp", "line": 59, "evidence": "watcher_->onServiceDiedWrapperCb(watcher_->onServiceDiedRustCb);", "description": "可能对指针 watcher_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_listener.cpp", "line": 65, "evidence": "if ((watcher == nullptr) || (watcher->status == STATUS_MEM_FREED)) {", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_listener.cpp", "line": 68, "evidence": "if (watcher->status == STATUS_MEM_NEED_RECYCLE) {", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_listener.cpp", "line": 69, "evidence": "watcher->status = STATUS_MEM_FREED;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_rust_listener.cpp", "line": 73, "evidence": "watcher->status = STATUS_MEM_NEED_RECYCLE;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 144, "evidence": "HiSysEventRustWatcherC* watcher = new(std::nothrow) HiSysEventRustWatcherC;", "description": "内存/对象分配给 watcher 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 169, "evidence": "HiSysEventRustQuerierC* querier = new(std::nothrow) HiSysEventRustQuerierC;", "description": "内存/对象分配给 querier 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 148, "evidence": "watcher->onEventRustCb = onEventRustCb;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 149, "evidence": "watcher->onEventWrapperCb = onEventWrapperCb;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 150, "evidence": "watcher->onServiceDiedRustCb = onServiceDiedRustCb;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 151, "evidence": "watcher->onServiceDiedWrapperCb = onServiceDiedWrapperCb;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 152, "evidence": "watcher->status = STATUS_NORMAL;", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 173, "evidence": "querier->onQueryRustCb = onQueryRustCb;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 174, "evidence": "querier->onQueryWrapperCb = onQueryWrapperCb;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 175, "evidence": "querier->onCompleteRustCb = onCompleteRustCb;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 176, "evidence": "querier->onCompleteWrapperCb = onCompleteWrapperCb;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/native/c_wrapper/source/hisysevent_c_wrapper.cpp", "line": 177, "evidence": "querier->status = STATUS_NORMAL;", "description": "可能对指针 querier 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 66, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_ARRAY, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 70, "evidence": "if (ANI_OK != env->Class_FindStaticMethod(cls, \"       \", nullptr, &static_method)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 73, "evidence": "if (ANI_OK != env->Class_CallStaticMethod_Boolean(cls, static_method, &IsArray, object)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 82, "evidence": "env->Reference_IsUndefined(ref, &isUndefined);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 96, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_BIGINT, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 101, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, FUNC_NAME_GETLONG, \"  \", &getLongMethod)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 105, "evidence": "if (ANI_OK != env->Object_CallMethod_Long(static_cast<ani_object>(elementRef), getLongMethod, &longNum)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 116, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_BOOLEAN, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 121, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, FUNC_NAME_UNBOXED, \"  \", &unboxedMethod)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 125, "evidence": "if (ANI_OK != env->Object_CallMethod_Boolean(static_cast<ani_object>(elementRef), unboxedMethod, &booleanVal)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 136, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_INT, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 141, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, FUNC_NAME_UNBOXED, \"  \", &unboxedMethod)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 145, "evidence": "if (ANI_OK != env->Object_CallMethod_Int(static_cast<ani_object>(elementRef), unboxedMethod, &intVal)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 156, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_DOUBLE, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 161, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, FUNC_NAME_UNBOXED, \"  \", &unboxedMethod)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 165, "evidence": "if (ANI_OK != env->Object_CallMethod_Double(static_cast<ani_object>(elementRef), unboxedMethod, &doubleVal)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 176, "evidence": "if (ANI_OK != env->Object_CallMethodByName_Ref(static_cast<ani_object>(recordRef), \"    \",", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 184, "evidence": "if (ANI_OK != env->Object_CallMethodByName_Ref(static_cast<ani_object>(keys), \"    \", nullptr, &next)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 188, "evidence": "if (ANI_OK != env->Object_GetFieldByName_Boolean(static_cast<ani_object>(next), \"    \", &done)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 196, "evidence": "if (ANI_OK != env->Object_GetFieldByName_Ref(static_cast<ani_object>(next), \"     \", &keyRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 201, "evidence": "if (ANI_OK != env->Object_CallMethodByName_Ref(static_cast<ani_object>(recordRef),", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 219, "evidence": "if (ANI_OK != env->String_GetUTF8Size(static_cast<ani_string>(aniStrRef), &strSize)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 226, "evidence": "if (ANI_OK != env->String_GetUTF8(static_cast<ani_string>(aniStrRef), utf8Buffer, strSize + 1, &bytesWritten)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 301, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_RESULTINNER, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 306, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, \"      \", nullptr, &ctor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 310, "evidence": "if (ANI_OK != env->Object_New(cls, ctor, &resultObj)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 315, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, \"         \", nullptr, &codeSetter)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 318, "evidence": "if (ANI_OK != env->Object_CallMethod_Void(resultObj, codeSetter, static_cast<ani_double>(result.first))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 323, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, \"            \", nullptr, &messageSetter)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 328, "evidence": "env->String_NewUTF8(message.c_str(), message.size(), &message_string);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 329, "evidence": "if (ANI_OK != env->Object_CallMethod_Void(resultObj, messageSetter, message_string)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 340, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_DOUBLE, &personCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 345, "evidence": "if (ANI_OK != env->Class_FindMethod(personCls, \"      \", \"   \", &personInfoCtor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 349, "evidence": "if (ANI_OK != env->Object_New(personCls, personInfoCtor, &personInfoObj, static_cast<ani_double>(number))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 360, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_DOUBLE, &personCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 365, "evidence": "if (ANI_OK != env->Class_FindMethod(personCls, \"      \", \"   \", &personInfoCtor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 369, "evidence": "if (ANI_OK != env->Object_New(personCls, personInfoCtor, &personInfoObj, static_cast<ani_double>(number))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 380, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_BOOLEAN, &personCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 385, "evidence": "if (ANI_OK != env->Class_FindMethod(personCls, \"      \", \"   \", &personInfoCtor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 389, "evidence": "if (ANI_OK != env->Object_New(personCls, personInfoCtor, &personInfoObj, static_cast<ani_boolean>(boolValue))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 400, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_DOUBLE, &personCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 405, "evidence": "if (ANI_OK != env->Class_FindMethod(personCls, \"      \", \"   \", &personInfoCtor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 409, "evidence": "if (ANI_OK != env->Object_New(personCls, personInfoCtor, &personInfoObj, static_cast<ani_double>(number))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 420, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_DOUBLE, &personCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 425, "evidence": "if (ANI_OK != env->Class_FindMethod(personCls, \"      \", \"   \", &personInfoCtor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 429, "evidence": "if (ANI_OK != env->Object_New(personCls, personInfoCtor, &personInfoObj, static_cast<ani_double>(number))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 444, "evidence": "ani_int enumIndex = static_cast<ani_int>(it->second);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 446, "evidence": "if (ANI_OK != env->FindEnum(ENUM_NAME_EVENT_TYPE, &aniEnum)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 450, "evidence": "if (env->Enum_GetEnumItemByIndex(aniEnum, enumIndex, &aniEnumItem)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 461, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_DOUBLE, &personCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 466, "evidence": "if (ANI_OK != env->Class_FindMethod(personCls, \"      \", \"   \", &personInfoCtor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 470, "evidence": "if (ANI_OK != env->Object_New(personCls, personInfoCtor, &personInfoObj, static_cast<ani_double>(number))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 480, "evidence": "if (ANI_OK != env->String_NewUTF8(value.c_str(), value.size(), &valueStr)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 490, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_BUSINESSERROR, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 495, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, \"      \", \"  \", &ctor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 500, "evidence": "if (ANI_OK != env->Object_New(cls, ctor, &error)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 504, "evidence": "if (ANI_OK != env->Object_SetPropertyByName_Double(error, \"    \", static_cast<ani_double>(code))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 509, "evidence": "if (ANI_OK != env->String_NewUTF8(message.c_str(), message.size(), &messageRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 513, "evidence": "if (ANI_OK != env->Object_SetPropertyByName_Ref(error, \"       \", static_cast<ani_ref>(messageRef))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 517, "evidence": "if (ANI_OK != env->ThrowError(static_cast<ani_error>(error))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 546, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_SYSEVENTINFOANI, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 551, "evidence": "if (ANI_OK != env->Object_SetPropertyByName_Ref(sysEventInfo, \"         \", static_cast<ani_ref>(eventType_ctor))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 560, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_SYSEVENTINFOANI, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 567, "evidence": "if (ANI_OK != env->Object_SetPropertyByName_Ref(sysEventInfo, \"      \", static_cast<ani_ref>(domain_ctor))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 572, "evidence": "if (ANI_OK != env->Object_SetPropertyByName_Ref(sysEventInfo, \"    \", static_cast<ani_ref>(name_ctor))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 630, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_SYSEVENTINFOANI, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 635, "evidence": "if (ANI_OK != env->Array_New_Ref(cls, len, initial_array, &array)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 644, "evidence": "if (ANI_OK != env->Array_Set_Ref(array, i, static_cast<ani_ref>(item))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 649, "evidence": "if (ANI_OK != env->Object_SetPropertyByName_Ref(sysEventInfo, \"      \", static_cast<ani_ref>(array))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 664, "evidence": "if (ANI_OK != env->Object_SetPropertyByName_Ref(sysEventInfo, \"      \", static_cast<ani_ref>(property))) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 679, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_SYSEVENTINFOANI, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 685, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, \"      \", nullptr, &ctor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 690, "evidence": "if (ANI_OK != env->Object_New(cls, ctor, &sysEventInfo)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 695, "evidence": "ani_status ret = env->Array_Set_Ref(sysEventInfoJsArray, i, static_cast<ani_ref>(sysEventInfo));", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 710, "evidence": "if (!reader->parse(jsonStr.data(), jsonStr.data() + jsonStr.size(), &eventJson, &errs)) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 729, "evidence": "auto propertyName = *it;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 741, "evidence": "env->String_GetUTF8Size(aniStr, &strSize);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 745, "evidence": "env->String_GetUTF8(aniStr, utf8Buffer, strSize + 1, &bytesWritten);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 754, "evidence": "if (ANI_OK != env->GetVM(&vm)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 764, "evidence": "if (ANI_OK != vm->GetEnv(ANI_VERSION_1, &env)) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 775, "evidence": "if (ANI_OK != vm->AttachCurrentThread(&aniArgs, ANI_VERSION_1, &workerEnv)) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 784, "evidence": "if (ANI_OK != vm->DetachCurrentThread()) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 792, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(arrayRef), &len)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 798, "evidence": "if (ANI_OK != env->Array_Get_Ref(static_cast<ani_array_ref>(arrayRef), i, &element)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 810, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(arrayRef), &len)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 816, "evidence": "if (ANI_OK != env->Array_Get_Ref(static_cast<ani_array_ref>(arrayRef), i, &element)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 828, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(arrayRef), &len)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 834, "evidence": "if (ANI_OK != env->Array_Get_Ref(static_cast<ani_array_ref>(arrayRef), i, &element)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 846, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(arrayRef), &len)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 852, "evidence": "if (ANI_OK != env->Array_Get_Ref(static_cast<ani_array_ref>(arrayRef), i, &element)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 864, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(arrayRef), &len)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 870, "evidence": "if (ANI_OK != env->Array_Get_Ref(static_cast<ani_array_ref>(arrayRef), i, &element)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani_util.cpp", "line": 35, "evidence": "const std::string INVALID_KEY_TYPE_ARR[] = {", "description": "string INVALID_KEY_TYPE_ARR 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 41, "evidence": "aniCallbackManager->Release();", "description": "可能对指针 aniCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 45, "evidence": "if (ANI_OK == callbackContextAni->vm->GetEnv(ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 45, "evidence": "if (ANI_OK == callbackContextAni->vm->GetEnv(ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 46, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 46, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 47, "evidence": "} else if (ANI_OK == callbackContextAni->vm->AttachCurrentThread(&aniArgs, ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 47, "evidence": "} else if (ANI_OK == callbackContextAni->vm->AttachCurrentThread(&aniArgs, ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 48, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 48, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 49, "evidence": "callbackContextAni->vm->DetachCurrentThread();", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 49, "evidence": "callbackContextAni->vm->DetachCurrentThread();", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 59, "evidence": "aniCallbackManager->Add(callbackContextAni,", "description": "可能对指针 aniCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 64, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_SYSEVENTINFOANI, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 69, "evidence": "if (ANI_OK != env->Class_FindMethod(cls, \"      \", nullptr, &ctor)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 73, "evidence": "if (ANI_OK != env->Object_New(cls, ctor, &sysEventInfo)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 80, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_WATCHERANI, &watcherCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 85, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(static_cast<ani_object>(ref), \"       \", &onEvent)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 90, "evidence": "if (ANI_OK != env->FunctionalObject_Call(static_cast<ani_fn_object>(onEvent), ON_EVENT_PARAM_COUNT,", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 101, "evidence": "aniCallbackManager->Add(callbackContextAni,", "description": "可能对指针 aniCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 105, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_WATCHERANI, &watcherCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 109, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(static_cast<ani_object>(ref), \"             \",", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_listener.cpp", "line": 115, "evidence": "if (ANI_OK != env->FunctionalObject_Call(static_cast<ani_fn_object>(onServiceDied), 1, argv, &result)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 35, "evidence": "context->callback = std::get<CALLBACK_FUNC_INDEX>(current);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 36, "evidence": "context->release = std::get<RELEASE_FUNC_INDEX>(current);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 37, "evidence": "if (context->callback != nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 38, "evidence": "context->callback(vm, context->ref, context->threadId);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 40, "evidence": "if (context->release != nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 41, "evidence": "context->release(vm, context->threadId);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 55, "evidence": "this->ImmediateRun(context->vm, true);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 59, "evidence": "release(context->vm, threadId);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_callback_manager.cpp", "line": 66, "evidence": "ImmediateRun(context->vm);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 42, "evidence": "aniCallbackManager->Release();", "description": "可能对指针 aniCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 46, "evidence": "if (ANI_OK == callbackContextAni->vm->GetEnv(ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 46, "evidence": "if (ANI_OK == callbackContextAni->vm->GetEnv(ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 47, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 47, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 48, "evidence": "} else if (ANI_OK == callbackContextAni->vm->AttachCurrentThread(&aniArgs, ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 48, "evidence": "} else if (ANI_OK == callbackContextAni->vm->AttachCurrentThread(&aniArgs, ANI_VERSION_1, &env) && env != nullptr) {", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 49, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 49, "evidence": "env->GlobalReference_Delete(callbackContextAni->ref);", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 50, "evidence": "callbackContextAni->vm->DetachCurrentThread();", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 50, "evidence": "callbackContextAni->vm->DetachCurrentThread();", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 60, "evidence": "aniCallbackManager->Add(callbackContextAni,", "description": "可能对指针 aniCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 65, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_SYSEVENTINFOANI, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 69, "evidence": "if (ANI_OK != env->Array_New_Ref(cls, sysEvents.size(), nullptr, &sysEventInfoJsArray)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 76, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_QUERIERANI, &querierCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 80, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(static_cast<ani_object>(ref), \"       \", &onQuery)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 85, "evidence": "if (ANI_OK != env->FunctionalObject_Call(static_cast<ani_fn_object>(onQuery), ON_QUERY_PARAM_COUNT,", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 96, "evidence": "aniCallbackManager->Add(callbackContextAni,", "description": "可能对指针 aniCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 107, "evidence": "if (ANI_OK != env->FindClass(CLASS_NAME_QUERIERANI, &querierCls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 111, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(static_cast<ani_object>(ref), \"          \", &onComplete)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 116, "evidence": "if (ANI_OK != env->FunctionalObject_Call(static_cast<ani_fn_object>(onComplete), ON_QUERY_COMPLTE_COUNT,", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/ani_hisysevent_querier.cpp", "line": 124, "evidence": "this->onCompleteHandler(vm, this->callbackContextAni->ref);", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 598, "evidence": "CallbackContextAni *callbackContextAni = new CallbackContextAni();", "description": "内存/对象分配给 callbackContextAni 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 655, "evidence": "CallbackContextAni *callbackContextAni = new CallbackContextAni();", "description": "内存/对象分配给 callbackContextAni 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 75, "evidence": "if (ANI_OK != env->FindClass(objType.first, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 79, "evidence": "if (ANI_OK != env->Object_InstanceOf(elementObj, cls, &isInstance)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 100, "evidence": "if (ANI_OK != env->Array_Get_Ref(static_cast<ani_array_ref>(arrayRef), index, &valueRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 225, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(value, \"      \", &domainRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 231, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(value, \"    \", &nameRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 237, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(value, \"   \", &tagRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 246, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(value, \"        \", &ruleTypeRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 252, "evidence": "if (ANI_OK != env->EnumItem_GetValue_Int(ruleTypeItem, &ruleTypeValue)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 263, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(watcher, \"     \", &rulesRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 268, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(rulesRef), &size)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 274, "evidence": "auto status = env->Array_Get_Ref(static_cast<ani_array_ref>(rulesRef), i, &value);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 287, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(value, \"     \", &namesRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 292, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(namesRef), &size)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 298, "evidence": "auto status = env->Array_Get_Ref(static_cast<ani_array_ref>(namesRef), i, &value);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 306, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(value, \"      \", &domainRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 312, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(value, \"         \", &conditionRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 342, "evidence": "if (ANI_OK != env->Array_GetLength(static_cast<ani_array_ref>(rulesAni), &size)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 348, "evidence": "auto status = env->Array_Get_Ref(static_cast<ani_array_ref>(rulesAni), i, &value);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 366, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Double(queryArgAni, \"         \", &beginTimeRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 371, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Double(queryArgAni, \"       \", &endTimeRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 376, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Double(queryArgAni, \"         \", &maxEventsRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 381, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(queryArgAni, \"       \", &fromSeqRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 388, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(queryArgAni, \"     \", &toSeqRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 399, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(info, \"      \", &domainRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 405, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(info, \"    \", &nameRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 411, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(info, \"         \", &eventTypeRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 417, "evidence": "if (ANI_OK != env->EnumItem_GetValue_Int(eventTypeItem, &eventTypeValue)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 423, "evidence": "if (ANI_OK != env->Object_GetPropertyByName_Ref(info, \"      \", &paramsRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 511, "evidence": "ani_status status = env->FindClass(CLASS_NAME_STACKTRACE, &stackTraceCls);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 516, "evidence": "status = env->Class_CallStaticMethodByName_Ref(stackTraceCls, \"                   \", nullptr,", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 522, "evidence": "status = env->Array_GetLength(static_cast<ani_array>(stackTraceElementArray), &length);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 528, "evidence": "status = env->Array_Get_Ref(static_cast<ani_array_ref>(stackTraceElementArray), i, &stackTraceElementRef);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 533, "evidence": "status = env->Object_CallMethodByName_Ref(static_cast<ani_object>(stackTraceElementRef), \"        \", nullptr,", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 599, "evidence": "callbackContextAni->vm = vm;", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 600, "evidence": "callbackContextAni->threadId = getproctid();", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 602, "evidence": "env->GlobalReference_Create(static_cast<ani_ref>(watcher), &listenerRef);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 603, "evidence": "callbackContextAni->ref = listenerRef;", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 613, "evidence": "listeners[callbackContextAni->ref] = std::make_pair(callbackContextAni->threadId, listener);", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 629, "evidence": "if (auto ret = HiSysEventBaseManager::RemoveListener(iter->second.second);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 656, "evidence": "callbackContextAni->vm = vm;", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 657, "evidence": "callbackContextAni->threadId = getproctid();", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 659, "evidence": "env->GlobalReference_Create(static_cast<ani_ref>(querierAni), &querierRef);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 660, "evidence": "callbackContextAni->ref = querierRef;", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 679, "evidence": "queriers[callbackContextAni->ref] = std::make_pair(callbackContextAni->threadId, querier);", "description": "可能对指针 callbackContextAni 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 748, "evidence": "if (ANI_OK != vm->GetEnv(ANI_VERSION_1, &env)) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 752, "evidence": "if (ANI_OK != env->FindNamespace(CLASS_NAME_HISYSEVENTANI, &ns)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 764, "evidence": "if (ANI_OK != env->Namespace_BindNativeFunctions(ns, methods.data(), methods.size())) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 767, "evidence": "*result = ANI_VERSION_1;", "description": "可能对指针 result 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 756, "evidence": "ani_native_function {\"         \", nullptr, reinterpret_cast<void *>(HiSysEventAni::WriteSync) },", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 757, "evidence": "ani_native_function {\"          \", nullptr, reinterpret_cast<void *>(HiSysEventAni::AddWatcher) },", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 758, "evidence": "ani_native_function {\"             \", nullptr, reinterpret_cast<void *>(HiSysEventAni::RemoveWatcher) },", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 759, "evidence": "ani_native_function {\"     \", nullptr, reinterpret_cast<void *>(HiSysEventAni::Query) },", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 760, "evidence": "ani_native_function {\"               \", nullptr, reinterpret_cast<void *>(HiSysEventAni::ExportSysEvents) },", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 761, "evidence": "ani_native_function {\"         \", nullptr, reinterpret_cast<void *>(HiSysEventAni::Subscribe) },", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 762, "evidence": "ani_native_function {\"           \", nullptr, reinterpret_cast<void *>(HiSysEventAni::Unsubscribe) },", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 486, "evidence": "std::string callInfo = callInfos[LINE_INFO_INDEX];", "description": "vector callInfos 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 494, "evidence": "auto fileName = lineInfos[LINE_INDEX - 1];", "description": "vector lineInfos 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 498, "evidence": "auto lineInfo = lineInfos[LINE_INDEX];", "description": "vector lineInfos 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hisysevent/src/hisysevent_ani.cpp", "line": 505, "evidence": "callerInfo.second = static_cast<int64_t>(std::stoll(lineInfos[LINE_INDEX]));", "description": "vector lineInfos 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/include/hisysevent_ani.h", "line": 98, "evidence": "Param param = iter->second;", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/include/hisysevent_ani.h", "line": 105, "evidence": "paramHandler(iter->first, param);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/include/hisysevent_ani_util.h", "line": 121, "evidence": "if (iter->second.first != getproctid()) {", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/include/hisysevent_ani_util.h", "line": 124, "evidence": "ani_ref val = iter->first;", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hisysevent/include/hisysevent_ani_util.h", "line": 126, "evidence": "ani_status ret = env->Reference_StrictEquals(standard, static_cast<ani_object>(val), &isEquals);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 116, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 83, "evidence": "*pid = INVALID_PID;", "description": "可能对指针 pid 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 125, "evidence": "if ((MemoryCopy((uint8_t*)(header->domain), DOMAIN_ARRAY_LEN, (uint8_t*)domain, strlen(domain)) != SUCCESS) ||", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 126, "evidence": "(MemoryCopy((uint8_t*)(header->name), NAME_ARRAY_LEN, (uint8_t*)name, strlen(name)) != SUCCESS)) {", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 129, "evidence": "header->type = eventType - 1;", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 130, "evidence": "header->timestamp = (uint64_t)GetTimestamp();", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 131, "evidence": "header->timeZone = ParseTimeZone(timezone);", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 134, "evidence": "header->pid = (uint32_t)((gPid != INVALID_PID) ? gPid : getpid());", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 136, "evidence": "header->pid = (uint32_t)gPid;", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 138, "evidence": "header->tid = (uint32_t)gettid();", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 139, "evidence": "header->uid = (uint32_t)getuid();", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/hisysevent_easy.c", "line": 140, "evidence": "header->isTraceOpened = 0;", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_util.c", "line": 31, "evidence": "*tmpData = 0;", "description": "可能对指针 tmpData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_util.c", "line": 45, "evidence": "*destTmpData = *srcTmpData;", "description": "可能对指针 srcTmpData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_util.c", "line": 45, "evidence": "*destTmpData = *srcTmpData;", "description": "可能对指针 destTmpData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent_easy/easy_socket_writer.c", "line": 69, "evidence": "close(socketId);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent_easy/easy_socket_writer.c", "line": 74, "evidence": "close(socketId);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent_easy/easy_socket_writer.c", "line": 80, "evidence": "close(socketId);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent_easy/easy_socket_writer.c", "line": 92, "evidence": "close(socketId);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent_easy/easy_socket_writer.c", "line": 95, "evidence": "close(socketId);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_socket_writer.c", "line": 53, "evidence": "ret = MemoryCopy((uint8_t*)(socketAddr->sun_path), sizeof(socketAddr->sun_path), (uint8_t*)SOCKET_PATH,", "description": "可能对指针 socketAddr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_socket_writer.c", "line": 58, "evidence": "socketAddr->sun_family = AF_UNIX;", "description": "可能对指针 socketAddr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_event_encoder.c", "line": 51, "evidence": "*offset += sizeof(uint8_t);", "description": "可能对指针 offset 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_event_encoder.c", "line": 59, "evidence": "*offset += sizeof(uint8_t);", "description": "可能对指针 offset 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_easy/easy_event_encoder.c", "line": 96, "evidence": "*offset += contentLen;", "description": "可能对指针 offset 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 63, "evidence": "T* data = new(std::nothrow) T[len];", "description": "内存/对象分配给 data 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 70, "evidence": "*value = data;", "description": "可能对指针 value 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 151, "evidence": "GetParamNames(*record, names, *len);", "description": "可能对指针 len 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 151, "evidence": "GetParamNames(*record, names, *len);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 156, "evidence": "return GetParamInt64Value(*record, name, *value);", "description": "可能对指针 value 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 156, "evidence": "return GetParamInt64Value(*record, name, *value);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 161, "evidence": "return GetParamUint64Value(*record, name, *value);", "description": "可能对指针 value 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 161, "evidence": "return GetParamUint64Value(*record, name, *value);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 166, "evidence": "return GetParamDoubleValue(*record, name, *value);", "description": "可能对指针 value 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 166, "evidence": "return GetParamDoubleValue(*record, name, *value);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 171, "evidence": "return GetParamStringValue(*record, name, value);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 176, "evidence": "return GetParamInt64Values(*record, name, value, *len);", "description": "可能对指针 len 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 176, "evidence": "return GetParamInt64Values(*record, name, value, *len);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 181, "evidence": "return GetParamUint64Values(*record, name, value, *len);", "description": "可能对指针 len 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 181, "evidence": "return GetParamUint64Values(*record, name, value, *len);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 186, "evidence": "return GetParamDoubleValues(*record, name, value, *len);", "description": "可能对指针 len 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 186, "evidence": "return GetParamDoubleValues(*record, name, value, *len);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 191, "evidence": "return GetParamStringValues(*record, name, value, *len);", "description": "可能对指针 len 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 191, "evidence": "return GetParamStringValues(*record, name, value, *len);", "description": "可能对指针 record 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_c.cpp", "line": 68, "evidence": "data[i] = dataVec[i];", "description": "vector dataVec 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_listener_c.cpp", "line": 38, "evidence": "HiSysEventRecordConvertor::ConvertRecord(*sysEvent, record);", "description": "可能对指针 sysEvent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record_convertor.cpp", "line": 82, "evidence": "auto realRs = *records;", "description": "可能对指针 records 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 87, "evidence": "auto ret = HiSysEventBaseManager::RemoveListener(watcherIter->second);", "description": "可能对指针 watcherIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 90, "evidence": "watchers.erase(watcherIter->first);", "description": "可能对指针 watcherIter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 106, "evidence": "if (callback == nullptr || callback->OnQuery == nullptr || callback->OnComplete == nullptr) {", "description": "可能对指针 callback 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 109, "evidence": "return HiSysEventQuery(*arg, rules, ruleSize, *callback);", "description": "可能对指针 callback 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 109, "evidence": "return HiSysEventQuery(*arg, rules, ruleSize, *callback);", "description": "可能对指针 arg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 114, "evidence": "if (watcher == nullptr || watcher->OnEvent == nullptr || watcher->OnServiceDied == nullptr) {", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 117, "evidence": "return HiSysEventAddWatcher(*watcher, rules, ruleSize);", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 122, "evidence": "if (watcher == nullptr || watcher->OnEvent == nullptr || watcher->OnServiceDied == nullptr) {", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 125, "evidence": "return HiSysEventRemoveWatcher(*watcher);", "description": "可能对指针 watcher 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_manager_c.cpp", "line": 53, "evidence": "eventList.emplace_back(rules[i].eventList[j]);", "description": "vector eventList 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 141, "evidence": "jsonVal_->GetParamNames(params);", "description": "可能对指针 jsonVal_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 182, "evidence": "value = src->AsInt64();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 193, "evidence": "value = src->AsUInt64();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 204, "evidence": "value = src->AsDouble();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 215, "evidence": "value = src->AsString();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 228, "evidence": "int arraySize = src->Size();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 230, "evidence": "value.emplace_back(src->Index(i).asInt64());", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 244, "evidence": "int arraySize = src->Size();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 246, "evidence": "value.emplace_back(src->Index(i).asUInt64());", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 260, "evidence": "int arraySize = src->Size();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 262, "evidence": "value.emplace_back(src->Index(i).asDouble());", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 276, "evidence": "int arraySize = src->Size();", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 278, "evidence": "value.emplace_back(src->Index(i).asString());", "description": "可能对指针 src 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 292, "evidence": "if (!jsonVal_->HasInitialized()) {", "description": "可能对指针 jsonVal_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 296, "evidence": "if (!jsonVal_->IsMember(param)) {", "description": "可能对指针 jsonVal_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 301, "evidence": "auto parsedVal = std::make_shared<HiSysEventValue>(jsonVal_->GetParamValue(param));", "description": "可能对指针 jsonVal_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 304, "evidence": "param.c_str(), parsedVal->Type());", "description": "可能对指针 parsedVal 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 313, "evidence": "return val->IsInt64() || val->IsNull() || val->IsBool();", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 318, "evidence": "return val->IsUInt64() || val->IsNull() || val->IsBool();", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 323, "evidence": "return val->IsDouble() || val->IsNull() || val->IsBool();", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 328, "evidence": "return val->IsNull() || val->IsBool() || val->IsNumeric() || val->IsString();", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 333, "evidence": "if (!val->IsArray()) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 336, "evidence": "if (val->Size() > 0) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 337, "evidence": "return filterFunc(std::make_shared<HiSysEventValue>(val->Index(0)));", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 339, "evidence": "return (val->Size() == 0);", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_record.cpp", "line": 349, "evidence": "if (!reader->parse(jsonStr.data(), jsonStr.data() + jsonStr.size(), &jsonVal_, &errs)) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_query_callback_c.cpp", "line": 43, "evidence": "auto records = new(std::nothrow) HiSysEventRecordC[size];", "description": "内存/对象分配给 records 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_query_callback_c.cpp", "line": 38, "evidence": "if (sysEvents == nullptr || sysEvents->empty()) {", "description": "可能对指针 sysEvents 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_query_callback_c.cpp", "line": 42, "evidence": "size_t size = sysEvents->size();", "description": "可能对指针 sysEvents 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_query_callback_c.cpp", "line": 49, "evidence": "if (HiSysEventRecordConvertor::ConvertRecord(sysEvents->at(i), records[i]) != 0) {", "description": "可能对指针 sysEvents 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 38, "evidence": "listener->listenerProxy = new HiSysEventDelegate();", "description": "内存/对象分配给 listenerProxy 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 37, "evidence": "if (listener->listenerProxy == nullptr) {", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 38, "evidence": "listener->listenerProxy = new HiSysEventDelegate();", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 40, "evidence": "return listener->listenerProxy->AddListener(listener, rules);", "description": "可能对指针 listenerProxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 40, "evidence": "return listener->listenerProxy->AddListener(listener, rules);", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 45, "evidence": "if (listener == nullptr || listener->listenerProxy == nullptr) {", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 49, "evidence": "auto ret = listener->listenerProxy->RemoveListener(listener);", "description": "可能对指针 listenerProxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 49, "evidence": "auto ret = listener->listenerProxy->RemoveListener(listener);", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 50, "evidence": "delete listener->listenerProxy;", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 51, "evidence": "listener->listenerProxy = nullptr;", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 60, "evidence": "return proxy->Query(arg, rules, callback);", "description": "可能对指针 proxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 69, "evidence": "return proxy->Export(arg, rules);", "description": "可能对指针 proxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 78, "evidence": "return proxy->Subscribe(rules);", "description": "可能对指针 proxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/hisysevent_base_manager.cpp", "line": 87, "evidence": "return proxy->Unsubscribe();", "description": "可能对指针 proxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent/transport.cpp", "line": 105, "evidence": "close(socketId);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent/transport.cpp", "line": 108, "evidence": "close(socketId);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/transport.cpp", "line": 99, "evidence": "reinterpret_cast<sockaddr*>(&serverAddr), sizeof(serverAddr));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/raw_data_base_def.cpp", "line": 40, "evidence": "if (*iter == tz) {", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 84, "evidence": "param->SetRawData(rawData_);", "description": "可能对指针 param 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 85, "evidence": "if (param->Encode()) {", "description": "可能对指针 param 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 114, "evidence": "if (!rawData_->Append(reinterpret_cast<uint8_t*>(&blockSize), sizeof(int32_t))) {", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 119, "evidence": "if (!rawData_->Append(reinterpret_cast<uint8_t*>(&header_), sizeof(struct HiSysEventHeader))) {", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 125, "evidence": "!rawData_->Append(reinterpret_cast<uint8_t*>(&traceInfo_), sizeof(struct TraceInfo))) {", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 129, "evidence": "paramCntWroteOffset_ = rawData_->GetDataLength();", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 131, "evidence": "if (!rawData_->Append(reinterpret_cast<uint8_t*>(&paramCnt_), sizeof(int32_t))) {", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 145, "evidence": "auto blockSize = static_cast<int32_t>(rawData_->GetDataLength());", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 146, "evidence": "(void)rawData_->Update(reinterpret_cast<uint8_t*>(&blockSize), sizeof(int32_t), 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 148, "evidence": "(void)rawData_->Update(reinterpret_cast<uint8_t*>(&paramCnt), sizeof(int32_t), paramCntWroteOffset_);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 504, "evidence": "if (auto temp = array + i; *temp == nullptr) {", "description": "可能对指针 temp 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 114, "evidence": "if (!rawData_->Append(reinterpret_cast<uint8_t*>(&blockSize), sizeof(int32_t))) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 119, "evidence": "if (!rawData_->Append(reinterpret_cast<uint8_t*>(&header_), sizeof(struct HiSysEventHeader))) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 125, "evidence": "!rawData_->Append(reinterpret_cast<uint8_t*>(&traceInfo_), sizeof(struct TraceInfo))) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 131, "evidence": "if (!rawData_->Append(reinterpret_cast<uint8_t*>(&paramCnt_), sizeof(int32_t))) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 146, "evidence": "(void)rawData_->Update(reinterpret_cast<uint8_t*>(&blockSize), sizeof(int32_t), 0);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 148, "evidence": "(void)rawData_->Update(reinterpret_cast<uint8_t*>(&paramCnt), sizeof(int32_t), paramCntWroteOffset_);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 355, "evidence": "bool* array = reinterpret_cast<bool*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 368, "evidence": "int8_t* array = reinterpret_cast<int8_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 381, "evidence": "uint8_t* array = reinterpret_cast<uint8_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 394, "evidence": "int16_t* array = reinterpret_cast<int16_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 407, "evidence": "uint16_t* array = reinterpret_cast<uint16_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 420, "evidence": "int32_t* array = reinterpret_cast<int32_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 433, "evidence": "uint32_t* array = reinterpret_cast<uint32_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 446, "evidence": "int64_t* array = reinterpret_cast<int64_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 459, "evidence": "uint64_t* array = reinterpret_cast<uint64_t*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 472, "evidence": "float* array = reinterpret_cast<float*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 485, "evidence": "double* array = reinterpret_cast<double*>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/hisysevent.cpp", "line": 498, "evidence": "auto array = reinterpret_cast<char**>(param.v.array);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/encoded_param.cpp", "line": 69, "evidence": "if (!RawDataEncoder::StringValueEncoded(*rawData_, key_)) {", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent/raw_data.cpp", "line": 38, "evidence": "data_ = new(std::nothrow) uint8_t[EXPAND_BUF_SIZE];", "description": "内存/对象分配给 data_ 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent/raw_data.cpp", "line": 51, "evidence": "data_ = new(std::nothrow) uint8_t[EXPAND_BUF_SIZE];", "description": "内存/对象分配给 data_ 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent/raw_data.cpp", "line": 59, "evidence": "data_ = new(std::nothrow) uint8_t[dataLen];", "description": "内存/对象分配给 data_ 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent/raw_data.cpp", "line": 82, "evidence": "uint8_t* tmpData = new(std::nothrow) uint8_t[dataLen];", "description": "内存/对象分配给 tmpData 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/native/innerkits/hisysevent/raw_data.cpp", "line": 137, "evidence": "uint8_t* resizedData = new(std::nothrow) uint8_t[expandedCapacity];", "description": "内存/对象分配给 resizedData 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/event_socket_factory.cpp", "line": 106, "evidence": "struct HiSysEventHeader header = *(reinterpret_cast<struct HiSysEventHeader*>(originalData + sizeof(int32_t)));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent/hisysevent_c.cpp", "line": 36, "evidence": "return HiSysEvent::Write(func, line, domain, name, HiSysEvent::EventType(type), params, size);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/raw_data_encoder.cpp", "line": 41, "evidence": "if (!data.Append(reinterpret_cast<uint8_t*>(const_cast<char*>(val.c_str())),", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/raw_data_encoder.cpp", "line": 56, "evidence": "if (!data.Append(reinterpret_cast<uint8_t*>(&kvType), sizeof(struct ParamValueType))) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "const_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/raw_data_encoder.cpp", "line": 41, "evidence": "if (!data.Append(reinterpret_cast<uint8_t*>(const_cast<char*>(val.c_str())),", "description": "使用 const_cast 移除 const 修饰符，可能导致未定义行为（如修改常量对象）。", "suggestion": "避免使用 const_cast；若必须使用，确保仅用于移除非底层 const 且对象本身可变。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent_easy/include/easy_socket_writer.h", "line": 33, "evidence": "int Write(const uint8_t* data, const size_t dataLen);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_record_c.h", "line": 57, "evidence": "const HiSysEventRecordC* record, const char* name, char** value);", "description": "指针 value 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_record_c.h", "line": 57, "evidence": "const HiSysEventRecordC* record, const char* name, char** value);", "description": "指针 value 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_record_c.h", "line": 57, "evidence": "const HiSysEventRecordC* record, const char* name, char** value);", "description": "指针 value 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_record_c.h", "line": 59, "evidence": "const HiSysEventRecordC* record, const char* name, int64_t** value, size_t* len);", "description": "指针 value 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_record_c.h", "line": 61, "evidence": "const HiSysEventRecordC* record, const char* name, uint64_t** value, size_t* len);", "description": "指针 value 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_record_c.h", "line": 63, "evidence": "const HiSysEventRecordC* record, const char* name, double** value, size_t* len);", "description": "指针 value 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_record_c.h", "line": 65, "evidence": "const HiSysEventRecordC* record, const char* name, char*** value, size_t* len);", "description": "指针 value 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_base_query_callback.h", "line": 40, "evidence": "records->emplace_back(HiSysEventRecord(content));", "description": "可能对指针 records 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_base_query_callback.h", "line": 42, "evidence": "callback->OnQuery(records);", "description": "可能对指针 callback 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_base_query_callback.h", "line": 49, "evidence": "callback->OnComplete(reason, total);", "description": "可能对指针 callback 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_base_listener.h", "line": 40, "evidence": "listener->OnEvent(sysEvent);", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent_manager/include/hisysevent_base_listener.h", "line": 47, "evidence": "listener->OnServiceDied();", "description": "可能对指针 listener 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 70, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, false, ValueType::UINT64, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 78, "evidence": "return RawDataEncoder::UnsignedVarintEncoded(*rawData_, EncodeType::VARINT, val_);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 98, "evidence": "vals_.emplace_back(*item);", "description": "可能对指针 item 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 107, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, true, ValueType::UINT64, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 115, "evidence": "bool ret = RawDataEncoder::UnsignedVarintEncoded(*rawData_, EncodeType::LENGTH_DELIMITED, vals_.size());", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 117, "evidence": "ret = ret && RawDataEncoder::UnsignedVarintEncoded(*rawData_, EncodeType::VARINT, item);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 142, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, false, ValueType::INT64, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 150, "evidence": "return RawDataEncoder::SignedVarintEncoded(*rawData_, EncodeType::VARINT, val_);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 171, "evidence": "vals_.emplace_back(*item);", "description": "可能对指针 item 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 180, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, true, ValueType::INT64, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 188, "evidence": "bool ret = RawDataEncoder::UnsignedVarintEncoded(*rawData_, EncodeType::LENGTH_DELIMITED, vals_.size());", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 190, "evidence": "ret = ret && RawDataEncoder::SignedVarintEncoded(*rawData_, EncodeType::VARINT, item);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 220, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, false, valueType, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 228, "evidence": "return RawDataEncoder::FloatingNumberEncoded(*rawData_, val_);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 247, "evidence": "vals_.emplace_back(*item);", "description": "可能对指针 item 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 263, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, true, valueType, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 271, "evidence": "bool ret = RawDataEncoder::UnsignedVarintEncoded(*rawData_, EncodeType::LENGTH_DELIMITED, vals_.size());", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 273, "evidence": "ret = ret && RawDataEncoder::FloatingNumberEncoded(*rawData_, item);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 294, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, false, ValueType::STRING, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 302, "evidence": "return RawDataEncoder::StringValueEncoded(*rawData_, val_);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 319, "evidence": "vals_.emplace_back(*item);", "description": "可能对指针 item 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 328, "evidence": "return RawDataEncoder::ValueTypeEncoded(*rawData_, true, ValueType::STRING, 0);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 336, "evidence": "bool ret = RawDataEncoder::UnsignedVarintEncoded(*rawData_, EncodeType::LENGTH_DELIMITED, vals_.size());", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 338, "evidence": "ret = ret && RawDataEncoder::StringValueEncoded(*rawData_, item);", "description": "可能对指针 rawData_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 58, "evidence": "class UnsignedVarintEncodedParam : public EncodedParam {", "description": "类 UnsignedVarintEncodedParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 88, "evidence": "class UnsignedVarintEncodedArrayParam : public EncodedParam {", "description": "类 UnsignedVarintEncodedArrayParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 130, "evidence": "class SignedVarintEncodedParam : public EncodedParam {", "description": "类 SignedVarintEncodedParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 161, "evidence": "class SignedVarintEncodedArrayParam : public EncodedParam {", "description": "类 SignedVarintEncodedArrayParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 201, "evidence": "class FloatingNumberEncodedParam : public EncodedParam {", "description": "类 FloatingNumberEncodedParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 237, "evidence": "class FloatingNumberEncodedArrayParam : public EncodedParam {", "description": "类 FloatingNumberEncodedArrayParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 282, "evidence": "class StringEncodedParam : public EncodedParam {", "description": "类 StringEncodedParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "missing_virtual_dtor", "file": "interfaces/native/innerkits/hisysevent/include/encoded_param.h", "line": 309, "evidence": "class StringEncodedArrayParam : public EncodedParam {", "description": "类 StringEncodedArrayParam 包含虚函数但析构函数非虚，通过基类指针删除派生类对象可能导致未定义行为。", "suggestion": "为基类添加虚析构函数，确保通过基类指针删除派生类对象时正确调用派生类析构函数。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "vla_usage", "file": "interfaces/native/innerkits/hisysevent/include/raw_data_base_def.h", "line": 46, "evidence": "char domain[MAX_DOMAIN_LENGTH + 1];", "description": "检测到可变长度数组（VLA），在栈上进行不定大小分配，可能导致栈溢出/不可控内存使用。", "suggestion": "避免 VLA；改用堆分配并进行上界校验，或使用固定上界的静态分配。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "vla_usage", "file": "interfaces/native/innerkits/hisysevent/include/raw_data_base_def.h", "line": 49, "evidence": "char name[MAX_EVENT_NAME_LENGTH + 1];", "description": "检测到可变长度数组（VLA），在栈上进行不定大小分配，可能导致栈溢出/不可控内存使用。", "suggestion": "避免 VLA；改用堆分配并进行上界校验，或使用固定上界的静态分配。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/include/raw_data_encoder.h", "line": 55, "evidence": "if (!data.Append(reinterpret_cast<uint8_t*>(&cpyVal), 1)) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/include/raw_data_encoder.h", "line": 62, "evidence": "if (!data.Append(reinterpret_cast<uint8_t*>(&cpyVal), 1)) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/native/innerkits/hisysevent/include/raw_data_encoder.h", "line": 88, "evidence": "if (!data.Append(reinterpret_cast<uint8_t*>(&valFdl), sizeof(T))) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent/include/hisysevent.h", "line": 254, "evidence": "static int Write(const char* func, int64_t line, const std::string &domain,", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent/include/hisysevent.h", "line": 278, "evidence": "static int Write(const char* func, int64_t line, const std::string& eventName,", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/native/innerkits/hisysevent/include/hisysevent.h", "line": 302, "evidence": "inline static constexpr int Write(const char*, int64_t, const std::string&, EventType, Types...)", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_querier.cpp", "line": 46, "evidence": "jsCallbackManager->Release();", "description": "可能对指针 jsCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_querier.cpp", "line": 48, "evidence": "if (callbackContext->threadId == getproctid()) {", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_querier.cpp", "line": 49, "evidence": "napi_delete_reference(callbackContext->env, callbackContext->ref);", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_querier.cpp", "line": 57, "evidence": "jsCallbackManager->Add(callbackContext,", "description": "可能对指针 jsCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_querier.cpp", "line": 80, "evidence": "jsCallbackManager->Add(callbackContext,", "description": "可能对指针 jsCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_querier.cpp", "line": 106, "evidence": "this->onCompleteHandler(this->callbackContext->env, this->callbackContext->ref);", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 50, "evidence": "uv_work_t* work = new(std::nothrow) uv_work_t();", "description": "内存/对象分配给 work 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 43, "evidence": "napi_get_uv_event_loop(context->env, &loop);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 48, "evidence": "context->callback = std::get<CALLBACK_FUNC_INDEX>(current);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 49, "evidence": "context->release = std::get<RELEASE_FUNC_INDEX>(current);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 55, "evidence": "work->data = reinterpret_cast<void*>(context);", "description": "可能对指针 work 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 63, "evidence": "if (work == nullptr || work->data == nullptr) {", "description": "可能对指针 work 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 67, "evidence": "CallbackContext* context = reinterpret_cast<CallbackContext*>(work->data);", "description": "可能对指针 work 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 68, "evidence": "if (context == nullptr || context->env == nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 73, "evidence": "napi_open_handle_scope(context->env, &scope);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 79, "evidence": "if (context->callback != nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 80, "evidence": "context->callback(context->env, context->ref, context->threadId);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 82, "evidence": "napi_close_handle_scope(context->env, scope);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 84, "evidence": "if (context->release != nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 85, "evidence": "context->release(context->threadId);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 55, "evidence": "work->data = reinterpret_cast<void*>(context);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/js/kits/napi/src/js_callback_manager.cpp", "line": 67, "evidence": "CallbackContext* context = reinterpret_cast<CallbackContext*>(work->data);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_listener.cpp", "line": 45, "evidence": "jsCallbackManager->Release();", "description": "可能对指针 jsCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_listener.cpp", "line": 47, "evidence": "if (callbackContext->threadId == getproctid()) {", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_listener.cpp", "line": 48, "evidence": "napi_delete_reference(callbackContext->env, callbackContext->ref);", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_listener.cpp", "line": 56, "evidence": "jsCallbackManager->Add(callbackContext,", "description": "可能对指针 jsCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_listener.cpp", "line": 80, "evidence": "jsCallbackManager->Add(callbackContext,", "description": "可能对指针 jsCallbackManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_init.cpp", "line": 93, "evidence": "nullptr, sizeof(descriptors) / sizeof(*descriptors), descriptors, &result);", "description": "可能对指针 descriptors 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_util.cpp", "line": 797, "evidence": "if (!reader->parse(jsonStr.data(), jsonStr.data() + jsonStr.size(), &eventJson, &errs)) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_util.cpp", "line": 815, "evidence": "auto propertyName = *it;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_util.cpp", "line": 90, "evidence": "const std::string INVALID_KEY_TYPE_ARR[] = {", "description": "string INVALID_KEY_TYPE_ARR 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_util.cpp", "line": 719, "evidence": "if (!CreateParamItemTypeValue(env, value[static_cast<int>(i)], item)) {", "description": "string value 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 147, "evidence": "void NapiHiSysEventAdapter::Write(const napi_env env, HiSysEventAsyncContext* eventAsyncContext)", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 124, "evidence": "if (eventAsyncContext->eventWroteResult != SUCCESS) {", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 127, "evidence": "auto eventInfo = eventAsyncContext->eventInfo;", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 128, "evidence": "auto jsCallerInfo = eventAsyncContext->jsCallerInfo;", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 136, "evidence": ".timeStamp = eventAsyncContext->timeStamp,", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 141, "evidence": "eventAsyncContext->eventWroteResult = ERR_WRITE_IN_HIGH_FREQ;", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 144, "evidence": "eventAsyncContext->eventWroteResult = Write(eventInfo, timeStamp);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 151, "evidence": "eventAsyncContext->timeStamp = WriteController::GetCurrentTimeMills();", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 161, "evidence": "auto isNormalWrote = eventAsyncContext->eventWroteResult == SUCCESS &&", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 162, "evidence": "!NapiHiSysEventUtil::HasStrParamLenOverLimit(eventAsyncContext->eventInfo);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 165, "evidence": "NapiHiSysEventUtil::CreateInt32Value(env, eventAsyncContext->eventWroteResult, results[VAL_INDEX]);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 168, "evidence": "auto errorCode = eventAsyncContext->eventWroteResult == SUCCESS ? ERR_VALUE_LENGTH_TOO_LONG :", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 169, "evidence": "eventAsyncContext->eventWroteResult;", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 172, "evidence": "if (eventAsyncContext->deferred != nullptr) {", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 173, "evidence": "isNormalWrote ? napi_resolve_deferred(env, eventAsyncContext->deferred, results[VAL_INDEX]) :", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 174, "evidence": "napi_reject_deferred(env, eventAsyncContext->deferred, results[ERR_INDEX]);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 177, "evidence": "napi_get_reference_value(env, eventAsyncContext->callback, &callback);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 180, "evidence": "napi_delete_reference(env, eventAsyncContext->callback);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 182, "evidence": "napi_delete_async_work(env, eventAsyncContext->asyncWork);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 184, "evidence": "}, reinterpret_cast<void*>(eventAsyncContext), &eventAsyncContext->asyncWork);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 185, "evidence": "napi_queue_async_work_with_qos(env, eventAsyncContext->asyncWork, napi_qos_default);", "description": "可能对指针 eventAsyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 155, "evidence": "HiSysEventAsyncContext* eventAsyncContext = reinterpret_cast<HiSysEventAsyncContext*>(data);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 159, "evidence": "HiSysEventAsyncContext* eventAsyncContext = reinterpret_cast<HiSysEventAsyncContext*>(data);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 184, "evidence": "}, reinterpret_cast<void*>(eventAsyncContext), &eventAsyncContext->asyncWork);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 84, "evidence": "std::string callInfo = callInfos[LINE_INFO_INDEX];", "description": "vector callInfos 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 92, "evidence": "auto fileName = lineInfos[LINE_INDEX - 1];", "description": "vector lineInfos 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_adapter.cpp", "line": 96, "evidence": "auto lineNumInfo = lineInfos[LINE_INDEX];", "description": "vector lineInfos 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 88, "evidence": "HiSysEventAsyncContext* asyncContext = new(std::nothrow) HiSysEventAsyncContext {", "description": "内存/对象分配给 asyncContext 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 144, "evidence": "CallbackContext* callbackContext = new CallbackContext();", "description": "内存/对象分配给 callbackContext 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 232, "evidence": "CallbackContext* callbackContext = new CallbackContext();", "description": "内存/对象分配给 callbackContext 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 116, "evidence": "NapiHiSysEventAdapter::Write(env, asyncContext);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 97, "evidence": "NapiHiSysEventUtil::ParseHiSysEventInfo(env, params, paramNum, asyncContext->eventInfo);", "description": "可能对指针 asyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 98, "evidence": "NapiHiSysEventAdapter::ParseJsCallerInfo(env, asyncContext->jsCallerInfo);", "description": "可能对指针 asyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 99, "evidence": "asyncContext->eventWroteResult = SUCCESS;", "description": "可能对指针 asyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 105, "evidence": "napi_create_reference(env, params[paramNum - 1], 1, &asyncContext->callback);", "description": "可能对指针 asyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 113, "evidence": "if (asyncContext->callback == nullptr) {", "description": "可能对指针 asyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 114, "evidence": "napi_create_promise(env, &asyncContext->deferred, &promise);", "description": "可能对指针 asyncContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 145, "evidence": "callbackContext->env = env;", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 146, "evidence": "callbackContext->threadId = getproctid();", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 147, "evidence": "napi_create_reference(env, params[ADD_LISTENER_LISTENER_PARAM_INDEX], 1, &callbackContext->ref);", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 156, "evidence": "listeners[callbackContext->ref] = std::make_pair(callbackContext->threadId, listener);", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 183, "evidence": "if (auto ret = HiSysEventBaseManager::RemoveListener(iter->second.second);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 190, "evidence": "listeners.erase(iter->first);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 233, "evidence": "callbackContext->env = env;", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 234, "evidence": "callbackContext->threadId = getproctid();", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 235, "evidence": "napi_create_reference(env, params[QUERY_QUERIER_PARAM_INDEX], 1, &callbackContext->ref);", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 243, "evidence": "queriers.erase(iter->first);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/napi_hisysevent_js.cpp", "line": 252, "evidence": "queriers[callbackContext->ref] = std::make_pair(callbackContext->threadId, querier);", "description": "可能对指针 callbackContext 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/include/napi_hisysevent_util.h", "line": 85, "evidence": "if (iter->second.first != getproctid()) {", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/include/napi_hisysevent_util.h", "line": 89, "evidence": "status = napi_get_reference_value(env, iter->first, &val);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/js/kits/napi/include/napi_hisysevent_adapter.h", "line": 60, "evidence": "static void Write(const napi_env env, HiSysEventAsyncContext* eventAsyncContext);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "interfaces/js/kits/napi/include/napi_hisysevent_adapter.h", "line": 66, "evidence": "static int Write(const HiSysEventInfo& eventInfo, uint64_t timeStamp);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/include/napi_hisysevent_adapter.h", "line": 105, "evidence": "Param param = iter->second;", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/include/napi_hisysevent_adapter.h", "line": 112, "evidence": "paramHandler(iter->first, param);", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event.rs", "line": 59, "evidence": "pub char_ptr_: *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "interfaces/rust/innerkits/src/sys_event.rs", "line": 16, "evidence": "use std::ffi::{CString, c_char, c_int, c_uint, c_ulonglong};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 212, "evidence": "let level_arr = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 221, "evidence": "let tag_arr = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 231, "evidence": "let json_str_arr = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 241, "evidence": "pub type OnQuery = unsafe extern \" \" fn (", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 248, "evidence": "pub type OnComplete = unsafe extern \" \" fn (", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 285, "evidence": "let native = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 307, "evidence": "unsafe extern \" \" fn on_query_callback<F>(callback: *mut c_void, records: *const HiSysEventRecord,", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 341, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 354, "evidence": "unsafe impl AsRawPtr<HiSysEventRustQuerierC> for Querier {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 394, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 404, "evidence": "pub type OnEvent = unsafe extern \" \" fn (", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 410, "evidence": "pub type OnServiceDied = unsafe extern \" \" fn (", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 445, "evidence": "let native = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 467, "evidence": "unsafe extern \" \" fn on_event<F>(callback: *mut c_void, record: HiSysEventRecord)", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 492, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 505, "evidence": "unsafe impl AsRawPtr<HiSysEventRustWatcherC> for Watcher {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 533, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 543, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 561, "evidence": "unsafe trait AsRawPtr<T> {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 86, "evidence": "pub condition: *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 130, "evidence": "level: *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 133, "evidence": "tag: *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 136, "evidence": "json_str: *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 213, "evidence": "std::ffi::CString::from_raw(self.level as *mut std::ffi::c_char)", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 222, "evidence": "std::ffi::CString::from_raw(self.tag as *mut std::ffi::c_char)", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 232, "evidence": "std::ffi::CString::from_raw(self.json_str as *mut std::ffi::c_char)", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 242, "evidence": "callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 243, "evidence": "records: *const HiSysEventRecord,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 249, "evidence": "callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 257, "evidence": "pub on_query_cb: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 259, "evidence": "pub on_complete_cb: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 267, "evidence": "native: *mut HiSysEventRustQuerierC,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 270, "evidence": "on_query_callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 273, "evidence": "on_complete_callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 286, "evidence": "CreateRustEventQuerier(on_query_callback as *mut c_void, Self::on_query_callback::<F1>,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 287, "evidence": "on_complete_callback as *mut c_void, Self::on_complete_callback::<F2>)", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 294, "evidence": "on_query_callback: on_query_callback as *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 295, "evidence": "on_complete_callback: on_complete_callback as *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 307, "evidence": "unsafe extern \" \" fn on_query_callback<F>(callback: *mut c_void, records: *const HiSysEventRecord,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 335, "evidence": "let callback = (callback as *const F).as_ref().unwrap();", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 355, "evidence": "fn as_raw(&self) -> *const HiSysEventRustQuerierC {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 359, "evidence": "fn as_mut_raw(&mut self) -> *mut HiSysEventRustQuerierC {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 378, "evidence": "condition: condition_wrapper.as_ptr() as *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 395, "evidence": "HiSysEventQueryWrapper(&query_arg_wrapper as *const HiSysEventQueryArg,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 405, "evidence": "callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 411, "evidence": "callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 417, "evidence": "pub on_event_cb: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 419, "evidence": "pub on_service_died_cb: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 427, "evidence": "native: *mut HiSysEventRustWatcherC,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 430, "evidence": "on_event_callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 433, "evidence": "on_service_died_callback: *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 446, "evidence": "CreateRustEventWatcher(on_event_callback as *mut c_void, Self::on_event::<F1>,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 447, "evidence": "on_service_died_callback as *mut c_void, Self::on_service_died::<F2>)", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 454, "evidence": "on_event_callback: on_event_callback as *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 455, "evidence": "on_service_died_callback: on_service_died_callback as *mut c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 467, "evidence": "unsafe extern \" \" fn on_event<F>(callback: *mut c_void, record: HiSysEventRecord)", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 486, "evidence": "let callback = (callback as *const F).as_ref().unwrap();", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 506, "evidence": "fn as_raw(&self) -> *const HiSysEventRustWatcherC {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 510, "evidence": "fn as_mut_raw(&mut self) -> *mut HiSysEventRustWatcherC {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 563, "evidence": "fn as_raw(&self) -> *const T;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 566, "evidence": "fn as_mut_raw(&mut self) -> *mut T;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 571, "evidence": "fn HiSysEventAddWatcherWrapper(watcher: *const HiSysEventRustWatcherC, rules: *const HiSysEventWatchRule,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 575, "evidence": "fn HiSysEventRemoveWatcherWrapper(watcher: *const HiSysEventRustWatcherC) -> c_int;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 578, "evidence": "fn HiSysEventQueryWrapper(query_arg: *const HiSysEventQueryArg, rules: *const HiSysEventQueryRuleWrapper,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 579, "evidence": "rule_size: c_uint, querier: *const HiSysEventRustQuerierC) -> c_int;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 582, "evidence": "fn GetHiSysEventRecordByIndexWrapper(records: *const HiSysEventRecord, total: c_uint,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 586, "evidence": "fn CreateRustEventWatcher(on_event_callback: *const c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 588, "evidence": "on_service_died_callback: *const c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 589, "evidence": "on_service_died_wrapper_callback: OnServiceDied) -> *mut HiSysEventRustWatcherC;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 592, "evidence": "fn RecycleRustEventWatcher(watcher: *const HiSysEventRustWatcherC);", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 595, "evidence": "fn CreateRustEventQuerier(on_query_callback: *const c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 597, "evidence": "on_complete_callback: *const c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 598, "evidence": "on_complete_wrapper_callback: OnComplete) -> *mut HiSysEventRustQuerierC;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 601, "evidence": "fn RecycleRustEventQuerier(querier: *const HiSysEventRustQuerierC);", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 143, "evidence": "std::str::from_utf8(&self.domain).expect(\"                       \")", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 149, "evidence": "std::str::from_utf8(&self.event_name).expect(\"                           \")", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 171, "evidence": "std::str::from_utf8(&self.tz).expect(\"                          \")", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 215, "evidence": "std::str::from_utf8(level_arr.to_bytes()).expect(\"                        \")", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 224, "evidence": "let tag = std::str::from_utf8(tag_arr.to_bytes()).expect(\"                      \")", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 234, "evidence": "let json_str = std::str::from_utf8(json_str_arr.to_bytes()).expect(\"                           \")", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 335, "evidence": "let callback = (callback as *const F).as_ref().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 373, "evidence": "let condition_wrapper = CString::new(query_rules[i].condition).expect(\"                           \");", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 486, "evidence": "let callback = (callback as *const F).as_ref().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 16, "evidence": "use std::ffi::{CString, c_char, c_int, c_uint, c_longlong, c_ulonglong, c_void};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 213, "evidence": "std::ffi::CString::from_raw(self.level as *mut std::ffi::c_char)", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 222, "evidence": "std::ffi::CString::from_raw(self.tag as *mut std::ffi::c_char)", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 232, "evidence": "std::ffi::CString::from_raw(self.json_str as *mut std::ffi::c_char)", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 213, "evidence": "std::ffi::CString::from_raw(self.level as *mut std::ffi::c_char)", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 222, "evidence": "std::ffi::CString::from_raw(self.tag as *mut std::ffi::c_char)", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "interfaces/rust/innerkits/src/sys_event_manager.rs", "line": 232, "evidence": "std::ffi::CString::from_raw(self.json_str as *mut std::ffi::c_char)", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/innerkits/src/utils.rs", "line": 42, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/innerkits/src/utils.rs", "line": 38, "evidence": "pub fn free_allocated_str(ptr: *mut c_char) {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/rust/innerkits/src/utils.rs", "line": 20, "evidence": "let name = CString::new(src).unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "interfaces/rust/innerkits/src/utils.rs", "line": 43, "evidence": "let _ = CString::from_raw(ptr);", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "interfaces/rust/innerkits/src/utils.rs", "line": 16, "evidence": "use std::ffi::{CString, c_char};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "interfaces/rust/innerkits/src/utils.rs", "line": 20, "evidence": "let name = CString::new(src).unwrap();", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "interfaces/rust/innerkits/src/utils.rs", "line": 43, "evidence": "let _ = CString::from_raw(ptr);", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
