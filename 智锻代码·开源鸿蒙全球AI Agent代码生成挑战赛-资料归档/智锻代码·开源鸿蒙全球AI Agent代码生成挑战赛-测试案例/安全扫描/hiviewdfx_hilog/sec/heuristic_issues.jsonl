{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "platform/hilog.cpp", "line": 34, "evidence": "int HiLog::Debug(const HiLogLabel &label, const char *fmt, ...)", "description": "指针 fmt 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "vla_usage", "file": "frameworks/hilog_ndk/hilog_ndk.c", "line": 49, "evidence": "char newTag[copyTagLen + 1];", "description": "检测到可变长度数组（VLA），在栈上进行不定大小分配，可能导致栈溢出/不可控内存使用。", "suggestion": "避免 VLA；改用堆分配并进行上界校验，或使用固定上界的静态分配。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "vla_usage", "file": "frameworks/hilog_ndk/hilog_ndk.c", "line": 50, "evidence": "char newMessage[copyMsgLen + 1];", "description": "检测到可变长度数组（VLA），在栈上进行不定大小分配，可能导致栈溢出/不可控内存使用。", "suggestion": "避免 VLA；改用堆分配并进行上界校验，或使用固定上界的静态分配。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/hilog_printf.cpp", "line": 230, "evidence": "return TEMP_FAILURE_RETRY(write(fd, logInfo, strlen(logInfo)));", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/hilog_printf.cpp", "line": 232, "evidence": "return write(fd, logInfo, strlen(logInfo));", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "frameworks/include/hilog_inner.h", "line": 28, "evidence": "const unsigned int, const unsigned int, const char *fmt, ...);", "description": "指针 fmt 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "frameworks/include/hilog_inner.h", "line": 30, "evidence": "const unsigned int, const unsigned int, const char *fmt, ...);", "description": "指针 fmt 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/vsnprintf/vsnprintf_s_p.c", "line": 169, "evidence": "if (SECUREC_PUTC(*str, f) == EOF) {", "description": "可能对指针 str 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/vsnprintf/vsnprintf_s_p.c", "line": 170, "evidence": "*pnumwritten = -1;", "description": "可能对指针 pnumwritten 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/vsnprintf/vsnprintf_s_p.c", "line": 173, "evidence": "++(*pnumwritten);", "description": "可能对指针 pnumwritten 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/vsnprintf/vsnprintf_s_p.c", "line": 184, "evidence": "*pnumwritten = -1;", "description": "可能对指针 pnumwritten 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/vsnprintf/vsnprintf_s_p.c", "line": 187, "evidence": "++(*pnumwritten);", "description": "可能对指针 pnumwritten 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/base/hilog_base.c", "line": 55, "evidence": "close(socketFd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/base/hilog_base.c", "line": 111, "evidence": "close(socketFd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/base/hilog_base.c", "line": 120, "evidence": "close(socketFd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/base/hilog_base.c", "line": 96, "evidence": "header->tv_sec = (uint32_t)(ts.tv_sec);", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/base/hilog_base.c", "line": 97, "evidence": "header->tv_nsec = (uint32_t)(ts.tv_nsec);", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/base/hilog_base.c", "line": 98, "evidence": "header->mono_sec = (uint32_t)(ts_mono.tv_sec);", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/base/hilog_base.c", "line": 99, "evidence": "header->len = sizeof(HilogMsg) + tagLen + fmtLen;", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/base/hilog_base.c", "line": 100, "evidence": "header->tagLen = tagLen;", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 83, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 113, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 143, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 176, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 207, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 237, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 321, "evidence": "ret = handle(*rsp);", "description": "可能对指针 rsp 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 47, "evidence": "int ret = socket.WriteAll(reinterpret_cast<char*>(&header), sizeof(MsgHeader));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 57, "evidence": "int ret = socket.RecvMsg(reinterpret_cast<char *>(&hdr), sizeof(hdr));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 99, "evidence": "pStats.tStats = reinterpret_cast<TagStatsRsp*>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 129, "evidence": "pStats.lStats = reinterpret_cast<LogTypeStatsRsp*>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 159, "evidence": "rsp.pStats = reinterpret_cast<ProcStatsRsp*>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 192, "evidence": "dStats.tStats = reinterpret_cast<TagStatsRsp*>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 223, "evidence": "ldStats.dStats = reinterpret_cast<DomainStatsRsp*>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 253, "evidence": "rsp.ldStats = reinterpret_cast<LogTypeDomainStatsRsp*>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 315, "evidence": "OutputRsp *rsp = reinterpret_cast<OutputRsp *>(buffer.data());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 317, "evidence": "int ret = GetRsp(reinterpret_cast<char*>(rsp), DEFAULT_RECV_BUF_LEN);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/log_ioctl.cpp", "line": 345, "evidence": "ret = GetRsp(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/utils/log_print.cpp", "line": 166, "evidence": "if (*pScan != '\\ ' && *pScan != '\\ ') {", "description": "可能对指针 pScan 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/utils/log_print.cpp", "line": 170, "evidence": "while (*pScan != '\\ ') {", "description": "可能对指针 pScan 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/utils/log_print.cpp", "line": 171, "evidence": "if (*pScan == '\\ ') {", "description": "可能对指针 pScan 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/utils/log_utils.cpp", "line": 448, "evidence": "(void)fclose(fp);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "frameworks/libhilog/utils/log_utils.cpp", "line": 43, "evidence": "const std::string SH_NAMES[] = { \"  \", \"       \", \"              \", \"        \", \"               \"};", "description": "string SH_NAMES 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/dgram_socket_client.cpp", "line": 38, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/socket/seq_packet_socket_server.cpp", "line": 68, "evidence": "handler->SetHandler(acceptResult);", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/socket/seq_packet_socket_server.cpp", "line": 69, "evidence": "handler->SetCredential(cred);", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/socket/hilog_input_socket_client.cpp", "line": 39, "evidence": "header->len = sizeof(HilogMsg) + tagLen + fmtLen;", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/socket/hilog_input_socket_client.cpp", "line": 40, "evidence": "header->tagLen = tagLen;", "description": "可能对指针 header 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/socket/hilog_input_socket_client.cpp", "line": 45, "evidence": "vec[1].iov_base = reinterpret_cast<void*>(const_cast<char*>(tag));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/socket/hilog_input_socket_client.cpp", "line": 47, "evidence": "vec[2].iov_base = reinterpret_cast<void*>(const_cast<char*>(fmt));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "const_cast_unsafe", "file": "frameworks/libhilog/socket/hilog_input_socket_client.cpp", "line": 45, "evidence": "vec[1].iov_base = reinterpret_cast<void*>(const_cast<char*>(tag));", "description": "使用 const_cast 移除 const 修饰符，可能导致未定义行为（如修改常量对象）。", "suggestion": "避免使用 const_cast；若必须使用，确保仅用于移除非底层 const 且对象本身可变。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "const_cast_unsafe", "file": "frameworks/libhilog/socket/hilog_input_socket_client.cpp", "line": 47, "evidence": "vec[2].iov_base = reinterpret_cast<void*>(const_cast<char*>(fmt));", "description": "使用 const_cast 移除 const 修饰符，可能导致未定义行为（如修改常量对象）。", "suggestion": "避免使用 const_cast；若必须使用，确保仅用于移除非底层 const 且对象本身可变。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/socket/socket_client.cpp", "line": 43, "evidence": "return TEMP_FAILURE_RETRY(connect(socketHandler, reinterpret_cast<sockaddr*>(&serverAddr), sizeof(serverAddr)));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/socket.cpp", "line": 54, "evidence": "close(tmpFd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/socket.cpp", "line": 88, "evidence": "return TEMP_FAILURE_RETRY(write(socketHandler, data, len));", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/socket.cpp", "line": 119, "evidence": "int Socket::Read(char *buffer, unsigned int len)", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/socket.cpp", "line": 121, "evidence": "return TEMP_FAILURE_RETRY(read(socketHandler, buffer, len));", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/socket.cpp", "line": 141, "evidence": "close(socketHandler);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/socket.cpp", "line": 150, "evidence": "close(socketHandler);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/socket_server.cpp", "line": 104, "evidence": "close(socketHandler);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/socket/dgram_socket_server.cpp", "line": 64, "evidence": "*cred = *receivedUcred;", "description": "可能对指针 receivedUcred 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/socket/dgram_socket_server.cpp", "line": 64, "evidence": "*cred = *receivedUcred;", "description": "可能对指针 cred 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 97, "evidence": "g_propResources = new PropRes[static_cast<int>(PropType::PROP_MAX)]{", "description": "内存/对象分配给 g_propResources 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 304, "evidence": "static auto *switchCache = new SwitchCache(TextToBool, true, PropType::PROP_PRIVATE);", "description": "内存/对象分配给 switchCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 313, "evidence": "static auto *switchCache = new SwitchCache(TextToBool, false, PropType::PROP_ONCE_DEBUG);", "description": "内存/对象分配给 switchCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 322, "evidence": "static auto *switchCache = new SwitchCache(TextToBool, false, PropType::PROP_PERSIST_DEBUG);", "description": "内存/对象分配给 switchCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 359, "evidence": "static auto *logLevelCache = new LogLevelCache(TextToLogLevel, LOG_LEVEL_MIN, PropType::PROP_GLOBAL_LOG_LEVEL);", "description": "内存/对象分配给 logLevelCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 372, "evidence": "static shared_timed_mutex* levelMtx = new shared_timed_mutex;", "description": "内存/对象分配给 levelMtx 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 385, "evidence": "LogLevelCache* levelCache = new LogLevelCache(TextToLogLevel, LOG_LEVEL_MIN, propType, Uint2HexStr(key));", "description": "内存/对象分配给 levelCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 399, "evidence": "static shared_timed_mutex* levelMtx = new shared_timed_mutex;", "description": "内存/对象分配给 levelMtx 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 412, "evidence": "LogLevelCache* levelCache = new LogLevelCache(TextToLogLevel, LOG_LEVEL_MIN, propType, key);", "description": "内存/对象分配给 levelCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 426, "evidence": "static auto *domainMap = new std::unordered_map<uint32_t, LogLevelCache*>();", "description": "内存/对象分配给 domainMap 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 432, "evidence": "static auto *persistDomainMap = new std::unordered_map<uint32_t, LogLevelCache*>();", "description": "内存/对象分配给 persistDomainMap 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 438, "evidence": "static auto *tagMap = new std::unordered_map<std::string, LogLevelCache*>();", "description": "内存/对象分配给 tagMap 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 444, "evidence": "static auto *persistTagMap = new std::unordered_map<std::string, LogLevelCache*>();", "description": "内存/对象分配给 persistTagMap 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 451, "evidence": "static auto *switchCache = new SwitchCache(TextToBool, false, PropType::PROP_PROCESS_FLOWCTRL);", "description": "内存/对象分配给 switchCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/libhilog/param/properties.cpp", "line": 460, "evidence": "static auto *switchCache = new SwitchCache(TextToBool, false, PropType::PROP_DOMAIN_FLOWCTRL);", "description": "内存/对象分配给 switchCache 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 308, "evidence": "return switchCache->getValue();", "description": "可能对指针 switchCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 317, "evidence": "return switchCache->getValue();", "description": "可能对指针 switchCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 326, "evidence": "return switchCache->getValue();", "description": "可能对指针 switchCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 360, "evidence": "return logLevelCache->getValue();", "description": "可能对指针 logLevelCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 367, "evidence": "return logLevelCache->getValue();", "description": "可能对指针 logLevelCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 373, "evidence": "std::decay<decltype(*map)>::type::iterator it;", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 375, "evidence": "ReadLock lock(*levelMtx);", "description": "可能对指针 levelMtx 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 376, "evidence": "it = map->find(key);", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 377, "evidence": "if (it != map->end()) {", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 378, "evidence": "LogLevelCache* levelCache = it->second;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 379, "evidence": "return levelCache->getValue();", "description": "可能对指针 levelCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 382, "evidence": "InsertLock lock(*levelMtx);", "description": "可能对指针 levelMtx 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 383, "evidence": "it = map->find(key);", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 384, "evidence": "if (it == map->end()) {", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 386, "evidence": "auto result = map->insert({ key, levelCache });", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 393, "evidence": "LogLevelCache* levelCache = it->second;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 394, "evidence": "return levelCache->getValue();", "description": "可能对指针 levelCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 400, "evidence": "std::decay<decltype(*map)>::type::iterator it;", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 402, "evidence": "ReadLock lock(*levelMtx);", "description": "可能对指针 levelMtx 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 403, "evidence": "it = map->find(key);", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 404, "evidence": "if (it != map->end()) {", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 405, "evidence": "LogLevelCache* levelCache = it->second;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 406, "evidence": "return levelCache->getValue();", "description": "可能对指针 levelCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 409, "evidence": "InsertLock lock(*levelMtx);", "description": "可能对指针 levelMtx 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 410, "evidence": "it = map->find(key);", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 411, "evidence": "if (it == map->end()) {", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 413, "evidence": "auto result = map->insert({ key, levelCache });", "description": "可能对指针 map 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 420, "evidence": "LogLevelCache* levelCache = it->second;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 421, "evidence": "return levelCache->getValue();", "description": "可能对指针 levelCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 455, "evidence": "return switchCache->getValue();", "description": "可能对指针 switchCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/param/properties.cpp", "line": 464, "evidence": "return switchCache->getValue();", "description": "可能对指针 switchCache 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/include/log_ioctl.h", "line": 74, "evidence": "ret = socket.WriteAll(reinterpret_cast<const char*>(&rqst), sizeof(T1));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/libhilog/ioctl/include/log_ioctl.h", "line": 109, "evidence": "ret = GetRsp(reinterpret_cast<char*>(&rsp), sizeof(T2));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/libhilog/utils/include/log_utils.h", "line": 37, "evidence": "return it == str_map.end() ? def_value : it->second;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/include/socket.h", "line": 38, "evidence": "int Write(const char *data, unsigned int len);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "frameworks/libhilog/socket/include/socket.h", "line": 41, "evidence": "int Read(char *buffer, unsigned int len);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/hilogd/service_controller.cpp", "line": 225, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/hilogd/service_controller.cpp", "line": 259, "evidence": "char *tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/hilogd/service_controller.cpp", "line": 309, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/hilogd/service_controller.cpp", "line": 364, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/hilogd/service_controller.cpp", "line": 406, "evidence": "char* tmp = new (std::nothrow) char[msgSize];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/service_controller.cpp", "line": 998, "evidence": "fread(&info, sizeof(PersistRecoveryInfo), 1, infile);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 102, "evidence": "int ret = m_communicationSocket->Read(reinterpret_cast<char *>(&hdr), sizeof(MsgHeader));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 116, "evidence": "int ret = m_communicationSocket->Read(rqst, hdr.len);", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 127, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&header), sizeof(MsgHeader));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 134, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&header), sizeof(MsgHeader));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 143, "evidence": "return m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 145, "evidence": "const HilogData& data = pData->get();", "description": "可能对指针 pData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 163, "evidence": "return m_communicationSocket->WriteV(vec, vec_num);", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 208, "evidence": "m_communicationSocket->Write(reinterpret_cast<char *>(&rsp), sizeof(StatsQueryRsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 246, "evidence": "m_communicationSocket->Write(tmp, msgSize);", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 283, "evidence": "m_communicationSocket->Write(tmp, msgSize);", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 344, "evidence": "m_communicationSocket->Write(tmp, msgSize);", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 386, "evidence": "m_communicationSocket->Write(tmp, msgSize);", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 425, "evidence": "m_communicationSocket->Write(tmp, msgSize);", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 445, "evidence": "uid_t uid = m_communicationSocket->GetUid();", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 487, "evidence": "uid_t uid = m_communicationSocket->GetUid();", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 488, "evidence": "uint32_t pid = static_cast<uint32_t>(m_communicationSocket->GetPid());", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 594, "evidence": "int ret = persister->Init(info, restore);", "description": "可能对指针 persister 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 598, "evidence": "persister->Start();", "description": "可能对指针 persister 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 637, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 650, "evidence": "uint32_t jobId = it->jobId;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 662, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 676, "evidence": "task.jobId = it->jobId;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 677, "evidence": "task.fileNum = it->fileNum;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 678, "evidence": "task.fileSize = it->fileSize;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 679, "evidence": "task.outputFilter.types = it->logType;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 680, "evidence": "if (strncpy_s(task.fileName, MAX_FILE_NAME_LEN, it->filePath, MAX_FILE_NAME_LEN - 1) != EOK) {", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 684, "evidence": "LogCompress::CompressType2Str(it->compressAlg).c_str(), MAX_STREAM_NAME_LEN - 1) != EOK) {", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 690, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 703, "evidence": "uint32_t jobId = it->jobId;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 715, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 723, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 747, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 777, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 808, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 818, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 842, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 858, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "可能对指针 m_communicationSocket 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 985, "evidence": "size_t length = strlen(ent->d_name);", "description": "可能对指针 ent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/service_controller.cpp", "line": 986, "evidence": "std::string pPath(ent->d_name, length);", "description": "可能对指针 ent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 102, "evidence": "int ret = m_communicationSocket->Read(reinterpret_cast<char *>(&hdr), sizeof(MsgHeader));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 127, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&header), sizeof(MsgHeader));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 134, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&header), sizeof(MsgHeader));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 143, "evidence": "return m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 208, "evidence": "m_communicationSocket->Write(reinterpret_cast<char *>(&rsp), sizeof(StatsQueryRsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 234, "evidence": "LogTypeDomainStatsRsp *ldStats = reinterpret_cast<LogTypeDomainStatsRsp *>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 268, "evidence": "DomainStatsRsp *dStats = reinterpret_cast<DomainStatsRsp *>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 318, "evidence": "ProcStatsRsp *pStats = reinterpret_cast<ProcStatsRsp *>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 373, "evidence": "LogTypeStatsRsp *lStats = reinterpret_cast<LogTypeStatsRsp *>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 415, "evidence": "TagStatsRsp *tStats = reinterpret_cast<TagStatsRsp *>(tmp);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 637, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 662, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 690, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 715, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 723, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 747, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 777, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 808, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 818, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 842, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 858, "evidence": "(void)m_communicationSocket->Write(reinterpret_cast<char*>(&rsp), sizeof(rsp));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/service_controller.cpp", "line": 1002, "evidence": "uint64_t hash = GenerateHash(reinterpret_cast<char *>(&info), sizeof(PersistRecoveryInfo));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogd/service_controller.cpp", "line": 558, "evidence": "if (rqst.fileName[0] && IsValidFileName(rqst.fileName) == false) {", "description": "string fileName 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 79, "evidence": "if (GenerateHilogMsgInside(*headMsg, tmpStr, i) == RET_SUCCESS) {", "description": "可能对指针 headMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 81, "evidence": "Insert(*headMsg, isFull);", "description": "可能对指针 headMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 107, "evidence": "if (ConvertBufType((*it).type) != bufferType) {", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 118, "evidence": "size_t cLen = it->len - it->tagLen;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 119, "evidence": "sizeByType[ConvertBufType((*it).type)] -= cLen;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 233, "evidence": "if (reader->m_msgList != &hilogDataList) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 234, "evidence": "reader->m_msgList = &hilogDataList;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 236, "evidence": "reader->m_pos = hilogDataList.begin();", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 238, "evidence": "reader->m_pos = hilogDataList.end();", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 239, "evidence": "reader->m_pos--;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 241, "evidence": "for (int i = 0; (i < tailCount) && (reader->m_pos != hilogDataList.begin());) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 242, "evidence": "if (LogMatchFilter(filter, (*reader->m_pos))) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 245, "evidence": "reader->m_pos--;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 249, "evidence": "if (reader->skipped) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 251, "evidence": "const string tmpStr = msg + to_string(reader->skipped);", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 254, "evidence": "if (GenerateHilogMsgInside(*headMsg, tmpStr, LOG_CORE) == RET_SUCCESS) {", "description": "可能对指针 headMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 255, "evidence": "const HilogData logData(*headMsg);", "description": "可能对指针 headMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 256, "evidence": "reader->skipped = 0;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 261, "evidence": "while (reader->m_pos != hilogDataList.end()) {", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 262, "evidence": "const HilogData& logData = *reader->m_pos;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 263, "evidence": "reader->m_pos++;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 283, "evidence": "if ((*it).type != logType) {", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 290, "evidence": "size_t cLen = it->len - it->tagLen;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 292, "evidence": "sizeByType[(*it).type] -= cLen;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 303, "evidence": "reader->skipped = 0;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 304, "evidence": "reader->m_onNewDataCallback = onNewDataCallback;", "description": "可能对指针 reader 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 327, "evidence": "if (readerPtr->m_pos == itemPos) {", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 338, "evidence": "if (readerPtr->m_pos == itemPos) {", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 339, "evidence": "readerPtr->m_pos = std::next(itemPos);", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 341, "evidence": "readerPtr->skipped++;", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 351, "evidence": "if (readerPtr->m_pos == msgList.end()) {", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 352, "evidence": "readerPtr->m_pos = std::prev(msgList.end());", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 361, "evidence": "if (readerPtr->m_msgList == &msgList && readerPtr->m_onNewDataCallback) {", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 362, "evidence": "readerPtr->m_onNewDataCallback();", "description": "可能对指针 readerPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_buffer.cpp", "line": 372, "evidence": "return it->second;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_buffer.cpp", "line": 71, "evidence": "HilogMsg *headMsg = reinterpret_cast<HilogMsg *>(buf.data());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_buffer.cpp", "line": 253, "evidence": "HilogMsg *headMsg = reinterpret_cast<HilogMsg *>(buf.data());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_buffer.cpp", "line": 306, "evidence": "ReaderId id = reinterpret_cast<ReaderId>(reader.get());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogd/log_buffer.cpp", "line": 146, "evidence": "const static std::string REPLACEMENT_S[] = {\"  \", \" \", \"\\  \", \"\\  \", \"\\  \", \"\\  \", \"\\  \", \"\\  \"};", "description": "string REPLACEMENT_S 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogd/log_buffer.cpp", "line": 153, "evidence": "result += REPLACEMENT_S[index];", "description": "string REPLACEMENT_S 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_compress.cpp", "line": 89, "evidence": "cStream.next_in = reinterpret_cast<Bytef*>(buffIn);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_compress.cpp", "line": 94, "evidence": "cStream.next_out = reinterpret_cast<Bytef*>(buffOut);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_compress.cpp", "line": 163, "evidence": "if (memmove_s(zdata + dst_pos, zdlen - dst_pos, reinterpret_cast<Bytef*>(buffOut), output.pos) != 0) {", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/log_persister_rotator.cpp", "line": 61, "evidence": "m_infoFile.close();", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/log_persister_rotator.cpp", "line": 90, "evidence": "m_infoFile.open(m_infoFilePath, std::ios::binary | std::ios::out | std::ios::trunc);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/log_persister_rotator.cpp", "line": 105, "evidence": "m_currentLogOutput.write(buf, length);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/log_persister_rotator.cpp", "line": 154, "evidence": "m_currentLogOutput.close();", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/log_persister_rotator.cpp", "line": 156, "evidence": "m_currentLogOutput.open(newFile.str(), std::ios::out | std::ios::trunc);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/log_persister_rotator.cpp", "line": 169, "evidence": "m_currentLogOutput.close();", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "thread_safety", "pattern": "time_api_not_threadsafe", "file": "services/hilogd/log_persister_rotator.cpp", "line": 144, "evidence": "struct tm *tmNow = localtime(&tnow);", "description": "使用 asctime/ctime/localtime/gmtime 等非重入接口，线程安全性不足。", "suggestion": "改用 *_r 线程安全版本（如 localtime_r/gmtime_r/ctime_r）。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister_rotator.cpp", "line": 116, "evidence": "size_t length = strlen(ent->d_name);", "description": "可能对指针 ent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister_rotator.cpp", "line": 117, "evidence": "std::string pPath(ent->d_name, length);", "description": "可能对指针 ent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_persister_rotator.cpp", "line": 190, "evidence": "uint64_t hash = GenerateHash(reinterpret_cast<char *>(&m_info), sizeof(PersistRecoveryInfo));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_persister_rotator.cpp", "line": 193, "evidence": "m_infoFile.write(reinterpret_cast<const char*>(&m_info), sizeof(m_info));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_persister_rotator.cpp", "line": 194, "evidence": "m_infoFile.write(reinterpret_cast<const char*>(&hash), sizeof(hash));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/log_kmsg.cpp", "line": 153, "evidence": "close(kmsgCtl);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_kmsg.cpp", "line": 60, "evidence": "hilogBuffer.Insert(msgWrap->GetHilogMsg(), isFull);", "description": "可能对指针 msgWrap 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_kmsg.cpp", "line": 63, "evidence": "hilogBuffer.Insert(msgWrap->GetHilogMsg(), isFull);", "description": "可能对指针 msgWrap 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/main.cpp", "line": 57, "evidence": "close(g_fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/main.cpp", "line": 86, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "services/hilogd/main.cpp", "line": 103, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 39, "evidence": "client->m_stopThread.store(true);", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 42, "evidence": "if (client->m_clientThread.joinable()) {", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 43, "evidence": "client->m_clientThread.join();", "description": "可能对指针 client 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 72, "evidence": "newVal->m_stopThread.store(false);", "description": "可能对指针 newVal 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 73, "evidence": "newVal->m_clientThread = std::thread([this](std::unique_ptr<Socket> handler) {", "description": "可能对指针 newVal 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 87, "evidence": "return ct->m_clientThread.get_id() == std::this_thread::get_id();", "description": "可能对指针 ct 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 97, "evidence": "serviceCtrl.CommunicationLoop((*clientInfoIt)->m_stopThread, m_cmdList);", "description": "可能对指针 clientInfoIt 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 112, "evidence": "return ct->m_clientThread.get_id() == threadId;", "description": "可能对指针 ct 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/cmd_executor.cpp", "line": 115, "evidence": "threadsToJoin.push_back(std::move((*clientInfoIt)->m_clientThread));", "description": "可能对指针 clientInfoIt 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_stats.cpp", "line": 125, "evidence": "UpdateStats(itt->second, info);", "description": "可能对指针 itt 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_stats.cpp", "line": 138, "evidence": "UpdateStats(it->second.stats, info);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_stats.cpp", "line": 149, "evidence": "UpdateTagTable(it->second.tagStats, info);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_stats.cpp", "line": 157, "evidence": "UpdateStats(it->second.statsAll, info);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_stats.cpp", "line": 158, "evidence": "UpdateStats(it->second.stats[info.type], info);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_stats.cpp", "line": 174, "evidence": "UpdateTagTable(it->second.tagStats, info);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 124, "evidence": "return m_fileRotator->Init(info, restore);", "description": "可能对指针 m_fileRotator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 224, "evidence": "std::cout << \"                             \" << m_mappedPlainLogFile->offset << \"\\ \";", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 227, "evidence": "auto compressionResult = m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_compressor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 227, "evidence": "auto compressionResult = m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_compressBuffer 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 227, "evidence": "auto compressionResult = m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 234, "evidence": "m_mappedPlainLogFile->offset = 0;", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 247, "evidence": "uint32_t remainingSpace = MAX_PERSISTER_BUFFER_SIZE - m_mappedPlainLogFile->offset;", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 251, "evidence": "char* currentContentPos = m_mappedPlainLogFile->content + m_mappedPlainLogFile->offset;", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 257, "evidence": "m_mappedPlainLogFile->offset += logLine.length();", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 289, "evidence": "auto compressionResult = m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_compressor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 289, "evidence": "auto compressionResult = m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_compressBuffer 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 289, "evidence": "auto compressionResult = m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 303, "evidence": "if (m_mappedPlainLogFile->offset == 0)", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 305, "evidence": "m_fileRotator->Input(m_compressBuffer->content, m_compressBuffer->offset);", "description": "可能对指针 m_fileRotator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 305, "evidence": "m_fileRotator->Input(m_compressBuffer->content, m_compressBuffer->offset);", "description": "可能对指针 m_compressBuffer 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 306, "evidence": "m_plainLogSize += m_mappedPlainLogFile->offset;", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 309, "evidence": "m_fileRotator->FinishInput();", "description": "可能对指针 m_fileRotator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 311, "evidence": "m_compressBuffer->offset = 0;", "description": "可能对指针 m_compressBuffer 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 312, "evidence": "m_mappedPlainLogFile->offset = 0;", "description": "可能对指针 m_mappedPlainLogFile 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 327, "evidence": "shared->ReceiveLogLoop();", "description": "可能对指针 shared 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 352, "evidence": "(void)m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_compressor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 358, "evidence": "(void)m_compressor->Compress(*m_mappedPlainLogFile, *m_compressBuffer);", "description": "可能对指针 m_compressor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 360, "evidence": "m_fileRotator->FinishInput();", "description": "可能对指针 m_fileRotator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 369, "evidence": "response.logType = logPersister->m_startMsg.filter.types;", "description": "可能对指针 logPersister 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 370, "evidence": "logPersister->FillInfo(response);", "description": "可能对指针 logPersister 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 420, "evidence": "if (logPersisterPtr->WriteLogData(data.value())) {", "description": "可能对指针 logPersisterPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 424, "evidence": "std::unique_lock<decltype(logPersisterPtr->m_receiveLogCvMtx)> lk(logPersisterPtr->m_receiveLogCvMtx);", "description": "可能对指针 logPersisterPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 426, "evidence": "if (cv_status::timeout == logPersisterPtr->m_receiveLogCv.wait_for(lk, waitTime)) {", "description": "可能对指针 logPersisterPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 428, "evidence": "(void)logPersisterPtr->m_compressor->Compress(*(logPersisterPtr->m_mappedPlainLogFile),", "description": "可能对指针 m_compressor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 428, "evidence": "(void)logPersisterPtr->m_compressor->Compress(*(logPersisterPtr->m_mappedPlainLogFile),", "description": "可能对指针 logPersisterPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 429, "evidence": "*(logPersisterPtr->m_compressBuffer));", "description": "可能对指针 logPersisterPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 430, "evidence": "logPersisterPtr->WriteCompressedLogs();", "description": "可能对指针 logPersisterPtr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 446, "evidence": "size_t length = strlen(ent->d_name);", "description": "可能对指针 ent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 447, "evidence": "std::string dName(ent->d_name, length);", "description": "可能对指针 ent 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 463, "evidence": "if (logPersister->m_startMsg.jobId == id || logPersister->m_startMsg.filePath == logPath) {", "description": "可能对指针 logPersister 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 477, "evidence": "if (logPersister->m_startMsg.jobId == id) {", "description": "可能对指针 logPersister 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 503, "evidence": "if (logPersister->m_startMsg.jobId == obj->m_startMsg.jobId) {", "description": "可能对指针 obj 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_persister.cpp", "line": 503, "evidence": "if (logPersister->m_startMsg.jobId == obj->m_startMsg.jobId) {", "description": "可能对指针 logPersister 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_persister.cpp", "line": 211, "evidence": "m_mappedPlainLogFile = reinterpret_cast<LogPersisterBuffer*>(mmap(nullptr, sizeof(LogPersisterBuffer),", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 55, "evidence": "LogTimeStamp start = it->second.startTime;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 59, "evidence": "it->second.startTime = tsNow;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 60, "evidence": "it->second.sumLen = logLen;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 61, "evidence": "ret = static_cast<int>(it->second.dropped);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 62, "evidence": "it->second.dropped = 0;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 64, "evidence": "if (it->second.sumLen <= it->second.quota) {", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 65, "evidence": "it->second.sumLen += logLen;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/flow_control.cpp", "line": 68, "evidence": "it->second.dropped++;", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 40, "evidence": "dropMsg->len     = buffer.size();", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 41, "evidence": "dropMsg->version = msg.version;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 42, "evidence": "dropMsg->type    = msg.type;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 43, "evidence": "dropMsg->level   = msg.level;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 44, "evidence": "dropMsg->tagLen = tag.size();", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 45, "evidence": "dropMsg->tv_sec  = msg.tv_sec;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 46, "evidence": "dropMsg->tv_nsec = msg.tv_nsec;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 47, "evidence": "dropMsg->mono_sec = msg.mono_sec;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 48, "evidence": "dropMsg->pid     = msg.pid;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 49, "evidence": "dropMsg->tid     = msg.tid;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 50, "evidence": "dropMsg->domain  = msg.domain;", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 53, "evidence": "if (memcpy_s(dropMsg->tag, remainSize, tag.data(), tag.size())) {", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 58, "evidence": "auto logTextPtr = dropMsg->tag + tag.size();", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/log_collector.cpp", "line": 63, "evidence": "InsertLogToBuffer(*dropMsg);", "description": "可能对指针 dropMsg 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_collector.cpp", "line": 38, "evidence": "HilogMsg *dropMsg = reinterpret_cast<HilogMsg *>(buffer.data());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/log_collector.cpp", "line": 75, "evidence": "HilogMsg& msg = *(reinterpret_cast<HilogMsg *>(data.data()));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/log_display.cpp", "line": 184, "evidence": "DomainStatsRsp &dStats = vd[j];", "description": "vector vd 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/log_display.cpp", "line": 197, "evidence": "TagStatsRsp &tStats = vt[k];", "description": "vector vt 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/log_display.cpp", "line": 242, "evidence": "ProcStatsRsp &pStats = vp[i];", "description": "vector vp 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/log_display.cpp", "line": 266, "evidence": "TagStatsRsp &tStats = vt[j];", "description": "vector vt 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogtool/main.cpp", "line": 898, "evidence": "if (handler == handlers.end() || handler->second == nullptr) {", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogtool/main.cpp", "line": 901, "evidence": "return handler->second(context, 0);", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogtool/main.cpp", "line": 1145, "evidence": "if (entry->count == 0) {", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogtool/main.cpp", "line": 1149, "evidence": "entry->count--;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogtool/main.cpp", "line": 1150, "evidence": "if (entry->cmd == ControlCmd::NOT_CMD) {", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogtool/main.cpp", "line": 1151, "evidence": "int ret = entry->handler(context, optarg);", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogtool/main.cpp", "line": 1170, "evidence": "int ret = cmdEntry->handler(context, cmdArgs.c_str());", "description": "可能对指针 cmdEntry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 312, "evidence": "uint32_t domains[MAX_DOMAINS] = {0};", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 324, "evidence": "uint32_t pids[MAX_PIDS] = {0};", "description": "vector pids 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 328, "evidence": "string tags[MAX_TAGS] = {\"\"};", "description": "vector tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 328, "evidence": "string tags[MAX_TAGS] = {\"\"};", "description": "string tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 347, "evidence": "rqst.domains[i] = domains[i];", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 352, "evidence": "if (strncpy_s(rqst.tags[i], MAX_TAG_LEN, tags[i].c_str(), tags[i].length()) != EOK) {", "description": "vector tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 352, "evidence": "if (strncpy_s(rqst.tags[i], MAX_TAG_LEN, tags[i].c_str(), tags[i].length()) != EOK) {", "description": "string tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 359, "evidence": "rqst.pids[i] = pids[i];", "description": "vector pids 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 404, "evidence": "rqst.domains[i] = domains[i];", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 488, "evidence": "ret = SetDomainLevel(context.domains[i], context.baseLevel);", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 489, "evidence": "PrintResult(ret, (string(\"             \") + Uint2HexStr(context.domains[i]) +  \"              \" + arg));", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 491, "evidence": "ret = SetPersistDomainLevel(context.domains[i], context.baseLevel);", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 493, "evidence": "Uint2HexStr(context.domains[i]) +  \"              \" + arg));", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 499, "evidence": "ret = SetTagLevel(context.tags[i], context.baseLevel);", "description": "vector tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 499, "evidence": "ret = SetTagLevel(context.tags[i], context.baseLevel);", "description": "string tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 500, "evidence": "PrintResult(ret, (string(\"        \") + context.tags[i] +  \"              \" + arg));", "description": "vector tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 500, "evidence": "PrintResult(ret, (string(\"        \") + context.tags[i] +  \"              \" + arg));", "description": "string tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 502, "evidence": "ret = SetPersistTagLevel(context.tags[i], context.baseLevel);", "description": "vector tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 502, "evidence": "ret = SetPersistTagLevel(context.tags[i], context.baseLevel);", "description": "string tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 503, "evidence": "PrintResult(ret, (string(\"                \") + context.tags[i] +  \"              \" + arg));", "description": "vector tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 503, "evidence": "PrintResult(ret, (string(\"                \") + context.tags[i] +  \"              \" + arg));", "description": "string tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 513, "evidence": "context.blackDomain = (arg[0] == BLACK_PREFIX);", "description": "string arg 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 531, "evidence": "context.domains[index++] = domain;", "description": "vector domains 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 706, "evidence": "context.blackPid = (arg[0] == BLACK_PREFIX);", "description": "string arg 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 722, "evidence": "context.pids[index++] = static_cast<uint32_t>(pid);", "description": "vector pids 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 818, "evidence": "context.blackTag = (arg[0] == BLACK_PREFIX);", "description": "string arg 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "services/hilogtool/main.cpp", "line": 829, "evidence": "context.tags[index++] = t;", "description": "vector tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "services/hilogtool/main.cpp", "line": 829, "evidence": "context.tags[index++] = t;", "description": "string tags 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/include/log_msg_wrapper.h", "line": 38, "evidence": "return *reinterpret_cast<HilogMsg*>(msgBuffer.data());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/hilogd/include/log_data.h", "line": 50, "evidence": "char* tmp = new (std::nothrow) char[len];", "description": "内存/对象分配给 tmp 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/hilogd/include/log_data.h", "line": 78, "evidence": "tag = new (std::nothrow) char[len];", "description": "内存/对象分配给 tag 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "concurrency", "pattern": "data_race_suspect", "file": "services/hilogd/include/log_persister.h", "line": 55, "evidence": "static int Kill(uint32_t id);", "description": "共享变量 Kill 在多线程环境下访问但未见明确的锁保护，可能存在数据竞争风险。", "suggestion": "使用互斥锁保护共享变量访问；或使用原子操作（std::atomic）进行无锁编程；注意 volatile 不能保证线程安全。", "confidence": 0.5, "severity": "medium"}
{"language": "c/cpp", "category": "concurrency", "pattern": "data_race_suspect", "file": "services/hilogd/include/log_persister.h", "line": 56, "evidence": "static int Query(std::list<LogPersistQueryResult> &results);", "description": "共享变量 Query 在多线程环境下访问但未见明确的锁保护，可能存在数据竞争风险。", "suggestion": "使用互斥锁保护共享变量访问；或使用原子操作（std::atomic）进行无锁编程；注意 volatile 不能保证线程安全。", "confidence": 0.5, "severity": "medium"}
{"language": "c/cpp", "category": "concurrency", "pattern": "data_race_suspect", "file": "services/hilogd/include/log_persister.h", "line": 57, "evidence": "static int Refresh(uint32_t id);", "description": "共享变量 Refresh 在多线程环境下访问但未见明确的锁保护，可能存在数据竞争风险。", "suggestion": "使用互斥锁保护共享变量访问；或使用原子操作（std::atomic）进行无锁编程；注意 volatile 不能保证线程安全。", "confidence": 0.5, "severity": "medium"}
{"language": "c/cpp", "category": "concurrency", "pattern": "data_race_suspect", "file": "services/hilogd/include/log_persister.h", "line": 58, "evidence": "static void Clear();", "description": "共享变量 Clear 在多线程环境下访问但未见明确的锁保护，可能存在数据竞争风险。", "suggestion": "使用互斥锁保护共享变量访问；或使用原子操作（std::atomic）进行无锁编程；注意 volatile 不能保证线程安全。", "confidence": 0.5, "severity": "medium"}
{"language": "c/cpp", "category": "concurrency", "pattern": "volatile_not_threadsafe", "file": "services/hilogd/include/log_persister.h", "line": 96, "evidence": "volatile bool m_stopThread = false;", "description": "volatile 变量 m_stopThread 在多线程环境下使用，但 volatile 不能保证线程安全，可能存在数据竞争。", "suggestion": "volatile 仅防止编译器优化，不能保证原子性或内存可见性；使用 std::atomic 或互斥锁保护共享变量。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "concurrency", "pattern": "volatile_not_threadsafe", "file": "services/hilogd/include/log_persister.h", "line": 104, "evidence": "volatile bool m_inited = false;", "description": "volatile 变量 m_inited 在多线程环境下使用，但 volatile 不能保证线程安全，可能存在数据竞争。", "suggestion": "volatile 仅防止编译器优化，不能保证原子性或内存可见性；使用 std::atomic 或互斥锁保护共享变量。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/hilogd/include/service_controller.h", "line": 114, "evidence": "handle(*rqst);", "description": "可能对指针 rqst 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/hilogd/include/service_controller.h", "line": 113, "evidence": "T *rqst = reinterpret_cast<T *>(data);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 51, "evidence": "env->Reference_IsUndefined(ref, &isUndefined);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 58, "evidence": "env->Reference_IsNull(ref, &isNull);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 74, "evidence": "if (ANI_OK != env->FindClass(objType.first, &cls)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 78, "evidence": "if (ANI_OK != env->Object_InstanceOf(element, cls, &isInstance)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 91, "evidence": "if (ANI_OK != env->EnumItem_GetValue_Int(enumItem, &aniInt)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 102, "evidence": "env->String_GetUTF8Size(aniStr, &strSize);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 106, "evidence": "env->String_GetUTF8(aniStr, utf8Buffer, strSize + 1, &bytesWritten);", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/ani_util.cpp", "line": 113, "evidence": "if (ANI_OK != env->Object_CallMethodByName_Ref(arg, FUNCTION_TOSTRING, MANGLING_TOSTRING, &argStrRef)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 131, "evidence": "if (ANI_OK != env->Array_GetLength(args, &length)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 143, "evidence": "if (ANI_OK != env->Array_Get_Ref(static_cast<ani_array_ref>(args), i, &element)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 60, "evidence": "if (params[contentPos.count].type == AniArgsType::ANI_INT ||", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 61, "evidence": "params[contentPos.count].type == AniArgsType::ANI_NUMBER ||", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 62, "evidence": "params[contentPos.count].type == AniArgsType::ANI_BIGINT) {", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 63, "evidence": "ret += isPriv ? PRIV_STR : params[contentPos.count].val;", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 69, "evidence": "if (params[contentPos.count].type == AniArgsType::ANI_STRING ||", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 70, "evidence": "params[contentPos.count].type == AniArgsType::ANI_UNDEFINED ||", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 71, "evidence": "params[contentPos.count].type == AniArgsType::ANI_BOOLEAN ||", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 72, "evidence": "params[contentPos.count].type == AniArgsType::ANI_NULL) {", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 73, "evidence": "ret += isPriv ? PRIV_STR : params[contentPos.count].val;", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 80, "evidence": "if (params[contentPos.count].type == AniArgsType::ANI_OBJECT) {", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/ets/ani/hilog/src/hilog_ani_base.cpp", "line": 81, "evidence": "ret += isPriv ? PRIV_STR : params[contentPos.count].val;", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 26, "evidence": "if (ANI_OK != vm->GetEnv(ANI_VERSION_1, &env)) {", "description": "可能对指针 vm 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 31, "evidence": "if (ANI_OK != env->FindNamespace(NAMESPACE_NAME_HILOG.c_str(), &ns)) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 46, "evidence": "if (ANI_OK != env->Namespace_BindNativeFunctions(ns, methods.data(), methods.size())) {", "description": "可能对指针 env 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 50, "evidence": "*result = ANI_VERSION_1;", "description": "可能对指针 result 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 36, "evidence": "ani_native_function {\"     \", nullptr, reinterpret_cast<void *>(HilogAniBase::Debug)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 37, "evidence": "ani_native_function {\"    \", nullptr, reinterpret_cast<void *>(HilogAniBase::Info)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 38, "evidence": "ani_native_function {\"    \", nullptr, reinterpret_cast<void *>(HilogAniBase::Warn)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 39, "evidence": "ani_native_function {\"     \", nullptr, reinterpret_cast<void *>(HilogAniBase::Error)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 40, "evidence": "ani_native_function {\"     \", nullptr, reinterpret_cast<void *>(HilogAniBase::Fatal)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 41, "evidence": "ani_native_function {\"          \", nullptr, reinterpret_cast<void *>(HilogAniBase::IsLoggable)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 42, "evidence": "ani_native_function {\"              \", nullptr, reinterpret_cast<void *>(HilogAniBase::SetMinLogLevel)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/ets/ani/hilog/src/hilog_ani.cpp", "line": 43, "evidence": "ani_native_function {\"           \", nullptr, reinterpret_cast<void *>(HilogAniBase::SetLogLevel)},", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/hilog/module.cpp", "line": 30, "evidence": "if (!product->Export(env, exports)) {", "description": "可能对指针 product 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/js/kits/napi/src/common/napi/n_val.cpp", "line": 88, "evidence": "strLen = reinterpret_cast<char *>(str.get() + strLen) - reinterpret_cast<char *>(str.get());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "interfaces/js/kits/napi/src/common/napi/n_val.cpp", "line": 89, "evidence": "auto strRet = unique_ptr<char[]>(reinterpret_cast<char *>(str.release()));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "interfaces/js/kits/napi/src/common/napi/n_val.cpp", "line": 69, "evidence": "status = napi_get_value_string_utf8(env_, val_, str.get(), bufLen, &strLen);", "description": "智能指针 str 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "interfaces/js/kits/napi/src/common/napi/n_val.cpp", "line": 83, "evidence": "status = napi_get_value_string_utf16(env_, val_, str.get(), strLen, nullptr);", "description": "智能指针 str 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "interfaces/js/kits/napi/src/common/napi/n_val.cpp", "line": 88, "evidence": "strLen = reinterpret_cast<char *>(str.get() + strLen) - reinterpret_cast<char *>(str.get());", "description": "智能指针 str 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/common/napi/n_class.cpp", "line": 47, "evidence": "napi_status status = napi_get_reference_value(env, it->second, &cons);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi.cpp", "line": 66, "evidence": "sizeof(descriptors) / sizeof(*descriptors), descriptors, &result);", "description": "可能对指针 descriptors 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi.cpp", "line": 88, "evidence": "sizeof(descriptors) / sizeof(*descriptors), descriptors, &result);", "description": "可能对指针 descriptors 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 80, "evidence": "if (params[count].type == napi_number || params[count].type == napi_bigint) {", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 81, "evidence": "logContent += (isPrivateEnable && showPriv) ? PRIV_STR : params[count].val;", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 87, "evidence": "if (params[count].type == napi_string || params[count].type == napi_undefined ||", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 88, "evidence": "params[count].type == napi_boolean || params[count].type == napi_null) {", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 89, "evidence": "logContent += (isPrivateEnable && showPriv) ? PRIV_STR : params[count].val;", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 96, "evidence": "if (params[count].type == napi_object || params[count].type == napi_function ||", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 97, "evidence": "params[count].type == napi_undefined || params[count].type == napi_null) {", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 98, "evidence": "logContent += (isPrivateEnable && showPriv) ? PRIV_STR : params[count].val;", "description": "vector params 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 143, "evidence": "bool res = HiLogIsLoggable(domain, tag.get(), static_cast<LogLevel>(level));", "description": "智能指针 tag 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 269, "evidence": "res.val = name.get();", "description": "智能指针 name 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 298, "evidence": "string fmtString = fmt.get();", "description": "智能指针 fmt 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "interfaces/js/kits/napi/src/hilog/src/hilog_napi_base.cpp", "line": 332, "evidence": "static_cast<LogLevel>(level), domain, tag.get(), \"          \", logContent.c_str());", "description": "智能指针 tag 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.75, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/src/macros.rs", "line": 32, "evidence": "let res = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/rust/src/macros.rs", "line": 82, "evidence": "let priv_flag = unsafe{ $crate::IsPrivateSwitchOn() && !$crate::IsDebugOn() };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/src/macros.rs", "line": 34, "evidence": "buf.as_ptr() as *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/rust/src/macros.rs", "line": 35, "evidence": "log_str.as_ptr() as *const c_char)", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "interfaces/rust/src/macros.rs", "line": 23, "evidence": "let _ = Option::<CString>::None;", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
