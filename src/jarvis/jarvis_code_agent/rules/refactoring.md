# 重构规则

## 重构原则

1. **小步快跑**：
   - 每次重构只做小的改动
   - 频繁运行测试，确保重构不破坏功能
   - 使用版本控制，便于回滚

2. **保持功能不变**：
   - 重构不应该改变代码的外部行为
   - 重构前后，所有测试应该都能通过
   - 如果有功能变更，应该单独提交

3. **识别代码异味**：
   - 重复代码（DRY 原则）
   - 过长的方法或类
   - 过深的嵌套
   - 魔法数字和字符串
   - 过度的参数列表

## 常见重构技巧

1. **提取方法**：将长方法拆分为多个小方法
2. **提取变量**：用有意义的变量名替换复杂表达式
3. **重命名**：使用更清晰的名称
4. **消除重复**：合并重复的代码逻辑
5. **简化条件**：使用更清晰的条件表达式
6. **移动代码**：将代码移到更合适的位置

## 重构时机

- 添加新功能时，先重构现有代码，使其更容易扩展
- 修复 bug 时，如果发现代码结构有问题，先重构再修复
- 代码审查时，如果发现可以改进的地方，建议重构
- 定期进行技术债务清理

## 重构检查清单

- [ ] 所有测试都能通过
- [ ] 代码更清晰、更易读
- [ ] 没有引入新的 bug
- [ ] 性能没有明显下降
- [ ] 代码更易于扩展和维护
