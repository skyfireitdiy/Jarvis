# 安全编码规则

## 核心原则

1. **输入验证**：
   - 永远不要信任用户输入
   - 验证所有输入数据的格式和范围
   - 使用白名单而非黑名单

2. **最小权限**：
   - 使用最小必要的权限
   - 避免使用管理员权限运行应用
   - 限制文件系统访问范围

3. **敏感数据保护**：
   - 不要在代码中硬编码密码、密钥
   - 使用环境变量或密钥管理服务
   - 加密存储敏感数据

## 常见安全问题

1. **SQL 注入**：
   - 使用参数化查询，不要拼接 SQL
   - 使用 ORM 框架的查询方法

2. **XSS (跨站脚本攻击)**：
   - 对用户输入进行转义
   - 使用内容安全策略 (CSP)

3. **CSRF (跨站请求伪造)**：
   - 使用 CSRF token
   - 验证请求来源

4. **敏感信息泄露**：
   - 不要在日志中记录敏感信息
   - 不要在错误消息中暴露系统细节

## 安全编码检查清单

- [ ] 所有用户输入都经过验证
- [ ] 没有硬编码的密码或密钥
- [ ] 使用参数化查询（防止 SQL 注入）
- [ ] 敏感数据被加密存储
- [ ] 错误消息不泄露系统信息
- [ ] 使用 HTTPS 传输敏感数据
- [ ] 定期更新依赖库
- [ ] 使用安全的随机数生成器
- [ ] 实施适当的访问控制
