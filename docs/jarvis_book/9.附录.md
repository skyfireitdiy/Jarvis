# 9. 附录

## 9.1 完整配置项列表

以下是 `~/.jarvis/config.yaml` 中所有可配置的参数及其说明。

| 变量名称                          | 默认值                                    | 说明                                                         |
| --------------------------------- | ----------------------------------------- | ------------------------------------------------------------ |
| `ENV`                             | `{}`                                      | 环境变量配置，用于存放API Keys等敏感信息，如 `YUANBAO_COOKIES`。 |
| `JARVIS_LLM_GROUPS`             | `[]`                                      | 预定义的LLM配置组列表。每个组可以指定 `JARVIS_PLATFORM`, `JARVIS_MODEL`, `JARVIS_MAX_INPUT_TOKEN_COUNT`，以及一个可选的 `ENV` 字典用于覆盖当前会话的环境变量。 |
| `JARVIS_LLM_GROUP`              | `""`                                      | 选择要激活的LLM组名称。                                     |
| `JARVIS_MAX_INPUT_TOKEN_COUNT`    | `32000`                                   | 输入给模型的最大token数量 (可被模型组覆盖)。其他token限制基于此值动态计算：最大token总数=此值×100，最大大内容尺寸=此值×5。                   |
| `JARVIS_PLATFORM`                 | `yuanbao`                                 | 默认AI平台 (可被模型组覆盖)。                                |
| `JARVIS_MODEL`                    | `deep_seek_v3`                            | 默认模型 (可被模型组覆盖)。                                  |

以下是一个 `JARVIS_LLM_GROUPS` 的配置示例：
```yaml
JARVIS_LLM_GROUPS:
  - tongyi:
      JARVIS_PLATFORM: tongyi
      JARVIS_MODEL: "qwen-max"
      JARVIS_MAX_INPUT_TOKEN_COUNT: 8000
      ENV:
        TONGYI_API_KEY: "your_tongyi_api_key_here"
```
当设置 `JARVIS_LLM_GROUP: tongyi` 时, Jarvis将使用通义平台和相应的模型，并将 `TONGYI_API_KEY` 注入到环境变量中。

| 变量名称                          | 默认值                                    | 说明                                                         |
| --------------------------------- | ----------------------------------------- | ------------------------------------------------------------ |
| `JARVIS_WEB_SEARCH_PLATFORM`      | `""`                                      | Web搜索使用的平台名称。如未配置，使用默认模型选择流程。      |
| `JARVIS_WEB_SEARCH_MODEL`         | `""`                                      | Web搜索使用的模型名称。如未配置，使用默认模型选择流程。      |
| `JARVIS_EXECUTE_TOOL_CONFIRM`     | `false`                                   | 在执行任何工具前是否需要用户手动确认。                       |
| `JARVIS_TOOL_LOAD_DIRS`           | `[]`                                      | 额外的工具加载目录列表。                                     |
| `JARVIS_AFTER_TOOL_CALL_CB_DIRS` | `[]`                                      | 工具调用后回调函数实现目录列表（扫描 .py 文件并按约定动态注册回调；支持 ~ 与环境变量展开）。 |
| `JARVIS_METHODOLOGY_DIRS`        | `[]`                                      | 方法论加载目录列表（支持 ~ 与环境变量展开）。               |
| `JARVIS_AGENT_DEFINITION_DIRS`   | `[]`                                      | agent 定义加载目录列表（支持 ~ 与环境变量展开）。           |
| `JARVIS_MULTI_AGENT_DIRS`        | `[]`                                      | multi_agent 加载目录列表（支持 ~ 与环境变量展开）。         |
| `JARVIS_ROLES_DIRS`              | `[]`                                      | roles 加载目录列表（支持 ~ 与环境变量展开）。               |
| `JARVIS_CENTRAL_METHODOLOGY_REPO` | `""`                                      | 中心方法论仓库路径或Git仓库地址。支持本地目录（含git子路径）：若为本地目录将直接加入方法论加载路径；若为Git URL则会克隆到数据目录后加载。 |
| `JARVIS_CENTRAL_TOOL_REPO`        | `""`                                      | 中心工具仓库路径或Git仓库地址。支持本地目录（含git子路径）：若为本地目录将直接加载其中的工具；若为Git URL则会克隆到数据目录并加载。                 |
| `JARVIS_TOOL_GROUPS`              | `[]`                                      | 预定义的工具配置组列表，每个配置组可包含`use`和`dont_use`两个可选数组。 |
| `JARVIS_TOOL_GROUP`               | `""`                                      | 选择要激活的工具配置组名称。                                 |
| `JARVIS_TOOL_FILTER_THRESHOLD`    | `30`                                      | AI 工具筛选阈值：当可用工具数量超过此值时，首次运行会触发 AI 自动筛选，仅保留与当前任务最相关的工具，以降低干扰并提升效率。 |
| `JARVIS_PLAN_ENABLED`           | `false`                                   | 是否默认启用任务规划。当 Agent 初始化时 plan 参数未指定，将从此配置加载。默认 `false`。 |
| `JARVIS_PLAN_MAX_DEPTH`           | `2`                                       | 任务规划的最大层数；用于限制 plan 模式的递归拆分深度。启用/禁用规划通过 CLI 开关 --plan/--no-plan（支持 jvs 与 jca）控制。 |
| `JARVIS_SCRIPT_EXECUTION_TIMEOUT` | `300`                                     | 脚本执行的超时时间（秒），仅在非交互模式下生效。             |
| `JARVIS_AUTO_SUMMARY_ROUNDS`    | `50`                                      | 基于对话轮次的自动总结阈值：达到该轮次后自动总结并清理历史，摘要将作为附加提示继续上下文。 |
| `JARVIS_CONFIRM_BEFORE_APPLY_PATCH` | `false`                                   | 在应用文件修改（补丁）前是否需要用户手动确认。               |
| `JARVIS_PATCH_FORMAT`               | `all`                                     | 补丁格式处理模式：`all` 同时支持 SEARCH 与 SEARCH_START/SEARCH_END；`search` 仅允许精确片段匹配；`search_range` 仅允许范围匹配。根据模型能力与稳定性诉求选择。 |
| `JARVIS_PRETTY_OUTPUT`            | `true`                                    | 是否启用更美观的终端格式化输出（默认启用；Windows 下强制关闭；可能与某些终端不兼容）。 |
| `JARVIS_PRINT_ERROR_TRACEBACK`    | `false`                                   | 是否在错误输出时自动打印回溯调用链。默认关闭；如需全局启用，请设置为 `true`；也可在调用 PrettyOutput.print 时通过 `traceback=True` 临时开启。 |
| `JARVIS_GIT_COMMIT_PROMPT`        | `""`                                      | 用于 `jgc` 的自定义git提交信息生成提示模板。                |
| `JARVIS_GIT_CHECK_MODE`           | `strict`                                  | Git 仓库检查模式。`strict`: 检测到未提交的更改时中断操作；`warn`: 显示警告并继续。 |
| `JARVIS_PRINT_PROMPT`             | `false`                                   | 是否在终端打印发送给LLM的完整提示（Prompt），用于调试。      |
| `JARVIS_NON_INTERACTIVE`          | `CLI-only`                                | 非交互模式：通过命令行 `--non-interactive` 传入（支持 jvs、ja、jca、jma）；不在配置文件中设置。启用后：多行输入返回固定提示、user_confirm 返回默认值、execute_script 5分钟超时并提示因超时终止、自动完成默认开启。 |
| `JARVIS_USE_METHODOLOGY`          | `true`                                    | 是否启用方法论功能，让AI先思考策略再执行。                 |
| `JARVIS_USE_ANALYSIS`             | `true`                                    | 是否启用任务分析功能，让AI先分解任务再执行。               |
| `JARVIS_ENABLE_STATIC_ANALYSIS`   | `true`                                    | 是否在代码任务中启用静态代码分析。                         |
| `JARVIS_ENABLE_BUILD_VALIDATION`  | `true`                                    | 是否启用构建验证。在代码编辑后自动验证代码能否成功编译/构建，确保编辑不会破坏项目构建。支持多种构建系统（Python、Node.js、Rust、Java、Go、C/C++等）。 |
| `JARVIS_BUILD_VALIDATION_TIMEOUT` | `30`                                      | 构建验证的超时时间（秒）。当构建验证执行时间超过此值时，将终止验证并报告超时。 |
| `JARVIS_DATA_PATH`                | `~/.jarvis`                               | Jarvis数据存储目录路径。                                     |
| `SHELL`                           | `/bin/bash`                               | 系统Shell路径，用于获取当前使用的shell类型。                 |
| `JARVIS_RAG_GROUPS`             | `[{"text": {"embedding_model": "BAAI/bge-m3", "rerank_model": "BAAI/bge-reranker-v2-m3", "use_bm25": true, "use_rerank": true}}, {"code": {"embedding_model": "Qodo/Qodo-Embed-1-1.5B", "use_bm25": false, "use_rerank": false}}]` | 预定义的RAG配置组列表。                                     |
| `JARVIS_RAG_GROUP`              | `""`                                      | 选择要激活的RAG配置组名称。                                     |
| `JARVIS_RAG`                      | `{"embedding_model": "BAAI/bge-m3", "rerank_model": "BAAI/bge-reranker-v2-m3", "use_bm25": true, "use_rerank": true}` | RAG框架的顶层配置，会覆盖组配置。 |
| `JARVIS_REPLACE_MAP`              | `{}`                                      | 自定义快捷指令（命令替换）的映射。                           |
| `JARVIS_MCP`                      | `[]`                                      | MCP (Model Communication Protocol) 服务的配置列表。            |
| `JARVIS_FORCE_SAVE_MEMORY`        | `false`                                   | 在上下文历史被清理前或任务完成时，强制提示用户保存记忆。     |
| `JARVIS_ENABLE_GIT_JCA_SWITCH`    | `true`                                    | 在检测到当前目录为 Git 仓库时，是否提示并可自动切换到代码开发模式（jca）。 |
| `JARVIS_ENABLE_STARTUP_CONFIG_SELECTOR`  | `true`                                    | 在进入默认通用代理前，是否列出可用配置（agent/multi_agent/roles）供选择。 |
| `JARVIS_IMMEDIATE_ABORT`        | `false`                                   | 是否启用立即中断：当检测到用户中断信号（如 Ctrl+C）时，在对话输出流的每次迭代中立即返回当前已生成内容并停止继续输出；关闭时不中途打断输出。 |
| `JARVIS_SAVE_SESSION_HISTORY`   | `false`                                   | 是否保存会话记录。                                           |
| `JARVIS_SKIP_PREDEFINED_TASKS`  | `false`                                   | 是否跳过预定义任务加载（不读取 pre-command 列表）。启用后不展示预定义任务选择。 |
| `JARVIS_ADDON_PROMPT_THRESHOLD` | `1024`                                    | 附加提示的触发阈值（字符数）。当消息长度超过此值时，会自动添加默认的附加提示。 |

## 9.2 许可证信息

Jarvis 项目采用 **MIT 许可证**。

MIT 许可证是一种非常宽松的开源许可证，它授予您广泛的权利，包括：

- **商业使用**: 您可以将 Jarvis 用于商业目的。
- **分发**: 您可以分发 Jarvis 的原始或修改版本。
- **修改**: 您可以修改 Jarvis 的源代码。
- **私用**: 您可以将 Jarvis 用于个人项目。

唯一的限制是，您必须在您的软件副本中包含原始的版权和许可声明。该许可证不提供任何形式的担保。

完整的许可证文本可以在项目根目录的 `LICENSE` 文件中找到。
