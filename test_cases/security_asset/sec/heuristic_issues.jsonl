{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 70, "evidence": "if (result == NULL || result->attrs == NULL || result->count == 0) {", "description": "可能对指针 result 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 74, "evidence": "for (uint32_t i = 0; i < result->count; i++) {", "description": "可能对指针 result 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 75, "evidence": "if (result->attrs[i].tag == tag) {", "description": "可能对指针 result 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 76, "evidence": "return &result->attrs[i];", "description": "可能对指针 result 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 85, "evidence": "if (blob == NULL || blob->data == NULL || blob->size == 0) {", "description": "可能对指针 blob 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 88, "evidence": "(void)memset_s(blob->data, blob->size, 0, blob->size);", "description": "可能对指针 blob 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 89, "evidence": "AssetFree(blob->data);", "description": "可能对指针 blob 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 90, "evidence": "blob->data = NULL;", "description": "可能对指针 blob 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 91, "evidence": "blob->size = 0;", "description": "可能对指针 blob 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 96, "evidence": "if (resultSet == NULL || resultSet->results == NULL || resultSet->count == 0) {", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 100, "evidence": "for (uint32_t i = 0; i < resultSet->count; i++) {", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 101, "evidence": "AssetAttr *attrs = resultSet->results[i].attrs;", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 102, "evidence": "uint32_t attrCnt = resultSet->results[i].count;", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 111, "evidence": "AssetFree(resultSet->results[i].attrs);", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 112, "evidence": "resultSet->results[i].attrs = NULL;", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 113, "evidence": "resultSet->results[i].count = 0;", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 115, "evidence": "AssetFree(resultSet->results);", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 116, "evidence": "resultSet->results = NULL;", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/c/system_api/src/asset_system_api.c", "line": 117, "evidence": "resultSet->count = 0;", "description": "可能对指针 resultSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "frameworks/os_dependency/memory/src/asset_mem.c", "line": 30, "evidence": "void *addr = malloc(size);", "description": "内存/对象分配给 addr 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.55, "severity": "low"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 55, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[0], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 56, "evidence": "IF_ERR_RETURN(CheckPostQueryArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 65, "evidence": "IF_ERR_RETURN(ParseJsUserId(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 66, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 67, "evidence": "IF_ERR_RETURN(CheckPostQueryArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 77, "evidence": "context->parse = asUser ? ParseAttrMapAsUser : ParseAttrMap;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 78, "evidence": "context->execute = [](napi_env env, void *data) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 80, "evidence": "context->result = AssetPostQuery(&context->attrs[0], context->attrs.size());", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 83, "evidence": "context->resolve = [](napi_env env, BaseContext *context) -> napi_value {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "frameworks/js/napi/src/asset_napi_post_query.cpp", "line": 90, "evidence": "return CreateSyncWork(env, info, context.get());", "description": "智能指针 context 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 38, "evidence": "napi_value error = CheckAssetTagValidity(env, context->attrs, OPTIONAL_TAGS, SEC_ASSET_PARAM_VERIFICATION_FAILED);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 42, "evidence": "return CheckAssetValueValidity(env, context->attrs, SEC_ASSET_PARAM_VERIFICATION_FAILED);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 51, "evidence": "context->parse = [](napi_env env, napi_callback_info info, BaseContext *baseContext) -> napi_status {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 55, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[0], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 59, "evidence": "context->check = CheckQuerySyncResultArgs;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 61, "evidence": "context->execute = [](napi_env env, void *data) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 63, "evidence": "context->result = AssetQuerySyncResult(&context->attrs[0], context->attrs.size(), &context->syncResult);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 66, "evidence": "context->resolve = [](napi_env env, BaseContext *baseContext) -> napi_value {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 70, "evidence": "NAPI_CALL(env, NapiSetProperty(env, syncResult, \"          \", context->syncResult.resultCode));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 71, "evidence": "if (context->syncResult.resultCode != SEC_ASSET_SUCCESS && context->syncResult.totalCount == 0) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 75, "evidence": "NAPI_CALL(env, NapiSetProperty(env, syncResult, \"          \", context->syncResult.totalCount));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 76, "evidence": "NAPI_CALL(env, NapiSetProperty(env, syncResult, \"           \", context->syncResult.failedCount));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/js/napi/src/asset_napi_query_sync_result.cpp", "line": 52, "evidence": "QuerySyncResultContext *context = reinterpret_cast<QuerySyncResultContext *>(baseContext);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 59, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[0], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 60, "evidence": "IF_ERR_RETURN(CheckQueryArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 69, "evidence": "IF_ERR_RETURN(ParseJsUserId(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 70, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 71, "evidence": "IF_ERR_RETURN(CheckQueryArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 81, "evidence": "context->parse = asUser ? ParseAttrMapAsUser : ParseAttrMap;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 82, "evidence": "context->execute = [](napi_env env, void *data) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 84, "evidence": "context->result = AssetQuery(&context->attrs[0], context->attrs.size(), &context->resultSet);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 87, "evidence": "context->resolve = [](napi_env env, BaseContext *baseContext) -> napi_value {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 89, "evidence": "return CreateJsMapArray(env, context->resultSet);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "frameworks/js/napi/src/asset_napi_query.cpp", "line": 95, "evidence": "return CreateSyncWork(env, info, context.get());", "description": "智能指针 context 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 48, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[0], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 49, "evidence": "IF_ERR_RETURN(CheckRemoveArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 58, "evidence": "IF_ERR_RETURN(ParseJsUserId(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 59, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 60, "evidence": "IF_ERR_RETURN(CheckRemoveArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 70, "evidence": "context->parse = asUser ? ParseAttrMapAsUser : ParseAttrMap;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 71, "evidence": "context->execute = [](napi_env env, void *data) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 73, "evidence": "context->result = AssetRemove(&context->attrs[0], context->attrs.size());", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 76, "evidence": "context->resolve = [](napi_env env, BaseContext *context) -> napi_value {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "frameworks/js/napi/src/asset_napi_remove.cpp", "line": 83, "evidence": "return CreateSyncWork(env, info, context.get());", "description": "智能指针 context 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 58, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[0], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 59, "evidence": "IF_ERR_RETURN(CheckPreQueryArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 68, "evidence": "IF_ERR_RETURN(ParseJsUserId(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 69, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 70, "evidence": "IF_ERR_RETURN(CheckPreQueryArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 80, "evidence": "context->parse = asUser ? ParseAttrMapAsUser : ParseAttrMap;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 81, "evidence": "context->execute = [](napi_env env, void *data) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 83, "evidence": "context->result = AssetPreQuery(&context->attrs[0], context->attrs.size(), &context->challenge);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 86, "evidence": "context->resolve = [](napi_env env, BaseContext *baseContext) -> napi_value {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 88, "evidence": "return CreateJsUint8Array(env, context->challenge);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "frameworks/js/napi/src/asset_napi_pre_query.cpp", "line": 94, "evidence": "return CreateSyncWork(env, info, context.get());", "description": "智能指针 context 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 80, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 81, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->updateAttrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 82, "evidence": "IF_ERR_RETURN(CheckUpdateArgs(env, context->attrs, context->updateAttrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 92, "evidence": "IF_ERR_RETURN(ParseJsUserId(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 93, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 94, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->updateAttrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 95, "evidence": "IF_ERR_RETURN(CheckUpdateArgs(env, context->attrs, context->updateAttrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 105, "evidence": "context->parse = asUser ? ParseAttrMapAsUser : ParseAttrMap;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 106, "evidence": "context->execute = [](napi_env env, void *data) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 108, "evidence": "context->result = AssetUpdate(&context->attrs[0], context->attrs.size(),", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 109, "evidence": "&context->updateAttrs[0], context->updateAttrs.size());", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 112, "evidence": "context->resolve = [](napi_env env, BaseContext *context) -> napi_value {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 76, "evidence": "UpdateContext *context = reinterpret_cast<UpdateContext *>(baseContext);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 88, "evidence": "UpdateContext *context = reinterpret_cast<UpdateContext *>(baseContext);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "frameworks/js/napi/src/asset_napi_update.cpp", "line": 119, "evidence": "return CreateSyncWork(env, info, context.get());", "description": "智能指针 context 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 163, "evidence": "if (context->result == SEC_ASSET_SUCCESS) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 164, "evidence": "napi_value result = context->resolve(env, context);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 165, "evidence": "NAPI_CALL_RETURN_VOID(env, napi_resolve_deferred(env, context->deferred, result));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 167, "evidence": "napi_value result = CreateJsError(env, context->result);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 168, "evidence": "NAPI_CALL_RETURN_VOID(env, napi_reject_deferred(env, context->deferred, result));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 295, "evidence": "if (context->parse != nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 296, "evidence": "NAPI_CALL(env, context->parse(env, info, context.get()));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 300, "evidence": "NAPI_CALL(env, napi_create_promise(env, &context->deferred, &promise));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 301, "evidence": "if (context->check != nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 302, "evidence": "napi_value error = context->check(env, context.get());", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 304, "evidence": "NAPI_CALL(env, napi_reject_deferred(env, context->deferred, error));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 310, "evidence": "NAPI_CALL(env, napi_create_async_work(env, nullptr, resource, context->execute,", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 315, "evidence": "}, static_cast<void *>(context.get()), &context->work));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 316, "evidence": "context->env = env;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 317, "evidence": "NAPI_CALL(env, napi_queue_async_work(env, context->work));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 324, "evidence": "if (context->parse != nullptr) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 325, "evidence": "NAPI_CALL(env, context->parse(env, info, context));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 328, "evidence": "context->execute(env, context);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 329, "evidence": "if (context->result != SEC_ASSET_SUCCESS) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 330, "evidence": "napi_throw(env, CreateJsError(env, context->result));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_common.cpp", "line": 333, "evidence": "return context->resolve(env, context);", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 62, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[0], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 63, "evidence": "IF_ERR_RETURN(CheckAddArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 72, "evidence": "IF_ERR_RETURN(ParseJsUserId(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 73, "evidence": "IF_ERR_RETURN(ParseJsMap(env, argv[index++], context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 74, "evidence": "IF_ERR_RETURN(CheckAddArgs(env, context->attrs));", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 84, "evidence": "context->parse = asUser ? ParseAttrMapAsUser : ParseAttrMap;", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 85, "evidence": "context->execute = [](napi_env env, void *data) {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 87, "evidence": "context->result = AssetAdd(&context->attrs[0], context->attrs.size());", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 90, "evidence": "context->resolve = [](napi_env env, BaseContext *context) -> napi_value {", "description": "可能对指针 context 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "smart_ptr_get_unsafe", "file": "frameworks/js/napi/src/asset_napi_add.cpp", "line": 97, "evidence": "return CreateSyncWork(env, info, context.get());", "description": "智能指针 context 使用 .get() 方法获取原始指针，若智能指针生命周期结束，原始指针将悬空。", "suggestion": "避免存储 .get() 返回的原始指针；若必须使用，确保智能指针的生命周期覆盖原始指针的使用期。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 78, "evidence": "ret = HksAddParams(*paramSet, params, paramCount);", "description": "可能对指针 paramSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 86, "evidence": "ret = AddSpecificUserIdParams(*paramSet, userId);", "description": "可能对指针 paramSet 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 111, "evidence": "{ .tag = HKS_TAG_AUTH_STORAGE_LEVEL, .uint32Param = AccessibilityToHksAuthStorageLevel(keyId->accessibility) },", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 147, "evidence": "if (keyId->userId > ASSET_ROOT_USER_UPPERBOUND) {", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 148, "evidence": "ret = AddSpecificUserIdParams(paramSet, keyId->userId);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 178, "evidence": "ret = HksGenerateKey(&keyId->alias, paramSet, NULL);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 191, "evidence": "{ .tag = HKS_TAG_AUTH_STORAGE_LEVEL, .uint32Param = AccessibilityToHksAuthStorageLevel(keyId->accessibility) },", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 194, "evidence": "int32_t ret = BuildParamSet(&paramSet, params, ARRAY_SIZE(params), keyId->userId);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 199, "evidence": "ret = HksDeleteKey(&keyId->alias, paramSet);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 207, "evidence": "{ .tag = HKS_TAG_AUTH_STORAGE_LEVEL, .uint32Param = AccessibilityToHksAuthStorageLevel(keyId->accessibility) },", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 210, "evidence": "int32_t ret = BuildParamSet(&paramSet, params, ARRAY_SIZE(params), keyId->userId);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 215, "evidence": "ret = HksKeyExist(&keyId->alias, paramSet);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 229, "evidence": "{ .tag = HKS_TAG_ASSOCIATED_DATA, .blob = *aad },", "description": "可能对指针 aad 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 230, "evidence": "{ .tag = HKS_TAG_AUTH_STORAGE_LEVEL, .uint32Param = AccessibilityToHksAuthStorageLevel(keyId->accessibility) },", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 233, "evidence": "int32_t ret = BuildParamSet(&encryptParamSet, encryptParams, ARRAY_SIZE(encryptParams), keyId->userId);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 240, "evidence": "ret = HksInit(&keyId->alias, encryptParamSet, &handleBlob, NULL);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 258, "evidence": "struct HksBlob cipher = { inData->size - NONCE_SIZE - TAG_SIZE, inData->data };", "description": "可能对指针 inData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 259, "evidence": "struct HksBlob tag = { TAG_SIZE, inData->data + (inData->size - NONCE_SIZE - TAG_SIZE) };", "description": "可能对指针 inData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 260, "evidence": "struct HksBlob nonce = { NONCE_SIZE, inData->data + (inData->size - NONCE_SIZE) };", "description": "可能对指针 inData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 269, "evidence": "{ .tag = HKS_TAG_ASSOCIATED_DATA, .blob = *aad },", "description": "可能对指针 aad 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 272, "evidence": "{ .tag = HKS_TAG_AUTH_STORAGE_LEVEL, .uint32Param = AccessibilityToHksAuthStorageLevel(keyId->accessibility) },", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 275, "evidence": "int32_t ret = BuildParamSet(&decryptParamSet, decryptParams, ARRAY_SIZE(decryptParams), keyId->userId);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 282, "evidence": "ret = HksInit(&keyId->alias, decryptParamSet, &handleBlob, NULL);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 305, "evidence": "{ .tag = HKS_TAG_AUTH_STORAGE_LEVEL, .uint32Param = AccessibilityToHksAuthStorageLevel(keyId->accessibility) },", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 308, "evidence": "int32_t ret = BuildParamSet(&paramSet, initParams, ARRAY_SIZE(initParams), keyId->userId);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 313, "evidence": "ret = HksInit(&keyId->alias, paramSet, handle, challenge);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 324, "evidence": "struct HksBlob tag = { TAG_SIZE, inData->data + (inData->size - NONCE_SIZE - TAG_SIZE) };", "description": "可能对指针 inData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 325, "evidence": "struct HksBlob nonce = { NONCE_SIZE, inData->data + (inData->size - NONCE_SIZE) };", "description": "可能对指针 inData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 333, "evidence": "{ .tag = HKS_TAG_ASSOCIATED_DATA, .blob = { .size = aad->size, .data = aad->data } },", "description": "可能对指针 aad 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 336, "evidence": "{ .tag = HKS_TAG_AUTH_TOKEN, .blob = *authToken },", "description": "可能对指针 authToken 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 345, "evidence": "struct HksBlob cipher = { inData->size - NONCE_SIZE - TAG_SIZE, inData->data };", "description": "可能对指针 inData 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 376, "evidence": "{ .tag = HKS_TAG_AUTH_STORAGE_LEVEL, .uint32Param = AccessibilityToHksAuthStorageLevel(keyId->accessibility) },", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 380, "evidence": "int32_t ret = BuildParamSet(&paramSet, params, ARRAY_SIZE(params), keyId->userId);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/crypto_manager/src/huks_wrapper.c", "line": 385, "evidence": "ret = HksRenameKeyAlias(&keyId->alias, paramSet, newKeyAlias);", "description": "可能对指针 keyId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "services/crypto_manager/src/huks_wrapper.h", "line": 51, "evidence": "struct HksBlob *outData);", "description": "指针 outData 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "services/crypto_manager/src/huks_wrapper.h", "line": 54, "evidence": "const struct HksBlob *inData, struct HksBlob *outData);", "description": "指针 outData 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "services/os_dependency/inc/system_event_wrapper.h", "line": 33, "evidence": "const char *blob;", "description": "指针 blob 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "services/os_dependency/inc/system_event_wrapper.h", "line": 38, "evidence": "ModifyAssetBlob *blob;", "description": "指针 blob 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "services/os_dependency/src/system_ability_wrapper.cpp", "line": 87, "evidence": "abilityHandler = new (std::nothrow) SystemAbilityHandler(eventCallBack);", "description": "内存/对象分配给 abilityHandler 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/system_ability_wrapper.cpp", "line": 93, "evidence": "int32_t ret = samgrProxy->SubscribeSystemAbility(OHOS::COMMON_EVENT_SERVICE_ID, abilityHandler);", "description": "可能对指针 samgrProxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/system_ability_wrapper.cpp", "line": 108, "evidence": "if (samgrProxy->UnSubscribeSystemAbility(OHOS::COMMON_EVENT_SERVICE_ID, abilityHandler) != OHOS::ERR_OK ||", "description": "可能对指针 samgrProxy 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/os_account_wrapper.cpp", "line": 31, "evidence": "*userId = userIdTmp;", "description": "可能对指针 userId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/os_account_wrapper.cpp", "line": 43, "evidence": "*exist = isUserIdExist;", "description": "可能对指针 exist 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/os_account_wrapper.cpp", "line": 69, "evidence": "*userIdsSize = static_cast<uint32_t>(userIdsVec.size());", "description": "可能对指针 userIdsSize 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/os_account_wrapper.cpp", "line": 89, "evidence": "*userIdsSize = static_cast<uint32_t>(userIdsVec.size());", "description": "可能对指针 userIdsSize 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/os_account_wrapper.cpp", "line": 109, "evidence": "*userIdsSize = static_cast<uint32_t>(userIdsVec.size());", "description": "可能对指针 userIdsSize 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/system_event_wrapper.cpp", "line": 55, "evidence": ".data = reinterpret_cast<const uint8_t *>(groupIdStr.c_str()) });", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/system_event_wrapper.cpp", "line": 58, "evidence": ".blob = reinterpret_cast<const ConstAssetBlob *>(&groupIdBlobs[0]) };", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/system_event_wrapper.cpp", "line": 75, "evidence": "ConstAssetBlob ownerBlob = { .size = owner.size(), .data = reinterpret_cast<const uint8_t *>(owner.c_str()) };", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/system_event_wrapper.cpp", "line": 79, "evidence": ".data = reinterpret_cast<const uint8_t *>(bundleName.c_str()) };", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/system_event_wrapper.cpp", "line": 83, "evidence": ".size = developerId.size(), .data = reinterpret_cast<const uint8_t *>(developerId.c_str())", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/system_event_wrapper.cpp", "line": 110, "evidence": "onAppRestore(userId, reinterpret_cast<const uint8_t *>(bundleName.c_str()), appIndex);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/file_operator_wrapper.cpp", "line": 41, "evidence": "*partitionSize = (static_cast<double>(stat.f_bfree) / units) * (static_cast<double>(stat.f_bsize) / units);", "description": "可能对指针 partitionSize 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 57, "evidence": "auto bundleMgrRemoteObj = systemAbilityManager->GetSystemAbility(BUNDLE_MGR_SERVICE_SYS_ABILITY_ID);", "description": "可能对指针 systemAbilityManager 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 69, "evidence": "int32_t ret = bundleMgr->GetNameAndIndexForUid(uid, bundleName, appIndex);", "description": "可能对指针 bundleMgr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 75, "evidence": "processInfo->hapInfo.appIndex = appIndex;", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 76, "evidence": "if (memcpy_s(processInfo->processName.data, processInfo->processName.size, bundleName.c_str(), bundleName.size())", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 79, "evidence": "bundleName.size(), processInfo->processName.size);", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 82, "evidence": "processInfo->processName.size = bundleName.size();", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 90, "evidence": "std::string bundleName(reinterpret_cast<const char*>(processInfo->processName.data), processInfo->processName.size);", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 96, "evidence": "if (memcpy_s(processInfo->hapInfo.appId.data, processInfo->hapInfo.appId.size, bundleInfo.appId.c_str(),", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 99, "evidence": "bundleInfo.appId.size(), processInfo->hapInfo.appId.size);", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 102, "evidence": "processInfo->hapInfo.appId.size = bundleInfo.appId.size();", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 104, "evidence": "if (processInfo->hapInfo.groupId.data == nullptr || processInfo->hapInfo.groupId.size == 0) {", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 109, "evidence": "if (groupId.size() <= processInfo->hapInfo.groupId.size &&", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 110, "evidence": "memcmp(processInfo->hapInfo.groupId.data, groupId.data(), processInfo->hapInfo.groupId.size) == 0) {", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 121, "evidence": "if (processInfo->hapInfo.developerId.data == nullptr || processInfo->hapInfo.developerId.size == 0) {", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 126, "evidence": "std::string bundleName(reinterpret_cast<const char*>(processInfo->processName.data), processInfo->processName.size);", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 127, "evidence": "int32_t ret = bundleMgr->GetAppProvisionInfo(bundleName, userId, appProvisionInfo);", "description": "可能对指针 bundleMgr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 140, "evidence": "if (memcpy_s(processInfo->hapInfo.developerId.data, processInfo->hapInfo.developerId.size, mainDeveloperId.c_str(),", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 143, "evidence": "mainDeveloperId.size(), processInfo->hapInfo.developerId.size);", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 146, "evidence": "processInfo->hapInfo.developerId.size = mainDeveloperId.size();", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 182, "evidence": "if (memcpy_s(processInfo->processName.data, processInfo->processName.size, nativeTokenInfo.processName.c_str(),", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 185, "evidence": "nativeTokenInfo.processName.size(), processInfo->processName.size);", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 188, "evidence": "processInfo->processName.size = nativeTokenInfo.processName.size();", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 189, "evidence": "processInfo->nativeInfo.uid = uid;", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 196, "evidence": "for (uint32_t i = 0; i < groupIds->size; i++) {", "description": "可能对指针 groupIds 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 197, "evidence": "if (strcmp(groupId.c_str(), groupIds->blob[i].blob) == 0) {", "description": "可能对指针 groupIds 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 198, "evidence": "groupIds->blob[i].modify = true;", "description": "可能对指针 groupIds 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 208, "evidence": "for (uint32_t i = 0; i < groupIds->size; i++) {", "description": "可能对指针 groupIds 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 209, "evidence": "targetGroupIds.insert(groupIds->blob[i].blob);", "description": "可能对指针 groupIds 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 225, "evidence": "processInfo->userId = userId;", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 231, "evidence": "if (processInfo->hapInfo.groupId.data != nullptr) {", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 232, "evidence": "processInfo->ownerType = HAP_GROUP;", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 234, "evidence": "processInfo->ownerType = HAP;", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 240, "evidence": "processInfo->ownerType = NATIVE;", "description": "可能对指针 processInfo 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 258, "evidence": "int32_t ret = bundleMgr->GetCloneAppIndexes(appName, indexes, userId);", "description": "可能对指针 bundleMgr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 263, "evidence": "if (*indexSize < indexes.size()) {", "description": "可能对指针 indexSize 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 271, "evidence": "*indexSize = indexes.size();", "description": "可能对指针 indexSize 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 292, "evidence": "*is_in_list = true;", "description": "可能对指针 is_in_list 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 296, "evidence": "*is_in_list = false;", "description": "可能对指针 is_in_list 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 308, "evidence": "std::string useDeveloperId(reinterpret_cast<const char*>(developerId->data), developerId->size);", "description": "可能对指针 developerId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 310, "evidence": "int32_t ret = bundleMgr->GetAllBundleInfoByDeveloperId(useDeveloperId, bundleInfos, userId);", "description": "可能对指针 bundleMgr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 90, "evidence": "std::string bundleName(reinterpret_cast<const char*>(processInfo->processName.data), processInfo->processName.size);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 126, "evidence": "std::string bundleName(reinterpret_cast<const char*>(processInfo->processName.data), processInfo->processName.size);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "services/os_dependency/src/bms_wrapper.cpp", "line": 308, "evidence": "std::string useDeveloperId(reinterpret_cast<const char*>(developerId->data), developerId->size);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "frameworks/utils/src/hasher.rs", "line": 146, "evidence": "unsafe { Sha256(message.as_ptr(), message.len() as u32, res.as_mut_ptr()) }", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "frameworks/utils/src/hasher.rs", "line": 138, "evidence": "fn Sha256(input: *const u8, input_len: u32, output: *mut u8);", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "frameworks/utils/src/hasher.rs", "line": 98, "evidence": "expand_chunk(input_bytes[i * BYTES_PER_CHUNK..(i + 1) * BYTES_PER_CHUNK].try_into().unwrap());", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "frameworks/os_dependency/file/src/de_operator.rs", "line": 40, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o700));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "frameworks/os_dependency/file/src/de_operator.rs", "line": 44, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o700));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "frameworks/os_dependency/file/src/ce_operator.rs", "line": 41, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "frameworks/os_dependency/file/src/ce_operator.rs", "line": 58, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "frameworks/os_dependency/log/src/lib.rs", "line": 18, "evidence": "use std::ffi::{c_char, CString};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "panic/unreachable", "file": "frameworks/definition/src/extension.rs", "line": 38, "evidence": "panic!(\"                                                         \");", "description": "使用 panic!/unreachable! 可能导致程序崩溃，缺少优雅的错误处理。", "suggestion": "优先使用 Result 类型进行错误处理；仅在确实不可恢复的情况下使用 panic。", "confidence": 0.6, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 108, "evidence": "let app_index = split_owner_info.last().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 242, "evidence": "let _lock = get_split_db_lock_by_user_id(user_id).mtx.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 270, "evidence": "let index = entry_version.rfind(' ').unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 271, "evidence": "let index_last = entry_version.rfind(DB_SUFFIX).unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 311, "evidence": "let _lock = GLOBAL_FILE_LOCK.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 329, "evidence": "let _lock = GLOBAL_FILE_LOCK.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 337, "evidence": "let _lock = GLOBAL_FILE_LOCK.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 413, "evidence": "let _lock = GLOBAL_FILE_LOCK.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 169, "evidence": "let _ = get_db(user_id, file_name_stem, &db_key)?;", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 288, "evidence": "let _ = create_upgrade_file(user_id, OriginVersion::V3);", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 320, "evidence": "let _ = fs::set_permissions(file_path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 340, "evidence": "let _ = fs::set_permissions(file_path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/db_operator/src/database_file_upgrade.rs", "line": 417, "evidence": "let _ = fs::set_permissions(file_path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/table.rs", "line": 376, "evidence": "let count = unsafe { SqliteChanges(self.db.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/table.rs", "line": 430, "evidence": "let count = unsafe { SqliteChanges(self.db.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/table.rs", "line": 484, "evidence": "let count = unsafe { SqliteChanges(self.db.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/table.rs", "line": 508, "evidence": "let count = unsafe { SqliteChanges(self.db.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/table.rs", "line": 525, "evidence": "let count = unsafe { SqliteChanges(self.db.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/table.rs", "line": 584, "evidence": "let count = unsafe { SqliteChanges(self.db.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/table.rs", "line": 33, "evidence": "fn SqliteChanges(db: *mut c_void) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/table.rs", "line": 782, "evidence": "let old_row = rows.first().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/database.rs", "line": 41, "evidence": "fn SqliteOpen(file_name: *const u8, pp_db: *mut *mut c_void) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/database.rs", "line": 42, "evidence": "fn SqliteCloseV2(db: *mut c_void) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/database.rs", "line": 43, "evidence": "fn SqliteExec(db: *mut c_void, sql: *const u8, msg: *mut *mut u8) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/database.rs", "line": 44, "evidence": "fn SqliteFree(data: *mut c_void);", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/database.rs", "line": 45, "evidence": "fn SqliteErrMsg(db: *mut c_void) -> *const u8;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/database.rs", "line": 46, "evidence": "fn SqliteKey(db: *mut c_void, pKey: *const c_void, nKey: i32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database.rs", "line": 491, "evidence": "'_, i32> = self.db_lock.mtx.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database.rs", "line": 673, "evidence": "let _lock = self.db_lock.mtx.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/db_operator/src/database.rs", "line": 698, "evidence": "let _lock = self.db_lock.mtx.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "services/db_operator/src/database.rs", "line": 20, "evidence": "use std::{collections::HashMap, ffi::CStr, fs, ptr::null_mut, sync::{Arc, Mutex}};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 63, "evidence": "let ret = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 82, "evidence": "let ret = unsafe { SqliteStep(self.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 94, "evidence": "let ret = unsafe { SqliteReset(self.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 106, "evidence": "Value::Bytes(b) => unsafe { SqliteBindBlob(self.handle as _, index, b.as_ptr(), b.len() as _, None) },", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 107, "evidence": "Value::Number(i) => unsafe { SqliteBindInt64(self.handle as _, index, *i as _) },", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 108, "evidence": "Value::Bool(b) => unsafe { SqliteBindInt64(self.handle as _, index, *b as _) },", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 120, "evidence": "let s = unsafe { SqliteColumnName(self.handle as _, n) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 122, "evidence": "let name = unsafe { CStr::from_ptr(s as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 132, "evidence": "unsafe { SqliteDataCount(self.handle as _) }", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 157, "evidence": "let blob = unsafe { SqliteColumnBlob(self.handle as _, index) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 159, "evidence": "unsafe { core::slice::from_raw_parts(blob, len as _) }", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 165, "evidence": "unsafe { SqliteColumnInt64(self.handle as _, index) as u32 }", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 170, "evidence": "unsafe { SqliteColumnBytes(self.handle as _, index) }", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 175, "evidence": "unsafe { SqliteColumnType(self.handle as _, index) }", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/db_operator/src/statement.rs", "line": 182, "evidence": "let ret = unsafe { SqliteFinalize(self.handle as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 29, "evidence": "type BindCallback = extern \" \" fn(p: *mut c_void);", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 31, "evidence": "fn SqliteFinalize(stmt: *mut c_void) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 32, "evidence": "fn SqlitePrepareV2(db: *mut c_void, z_sql: *const u8, pp_stmt: *mut *mut c_void, pz_tail: *mut *mut u8) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 33, "evidence": "fn SqliteBindBlob(stmt: *mut c_void, index: i32, blob: *const u8, n: i32, callback: Option<BindCallback>) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 34, "evidence": "fn SqliteBindInt64(stmt: *mut c_void, index: i32, value: i64) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 35, "evidence": "fn SqliteStep(stmt: *mut c_void) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 36, "evidence": "fn SqliteColumnName(stmt: *mut c_void, n: i32) -> *const u8;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 37, "evidence": "fn SqliteDataCount(stmt: *mut c_void) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 38, "evidence": "fn SqliteColumnBlob(stmt: *mut c_void, i_col: i32) -> *const u8;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 39, "evidence": "fn SqliteColumnInt64(stmt: *mut c_void, i_col: i32) -> i64;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 40, "evidence": "fn SqliteColumnBytes(stmt: *mut c_void, i_col: i32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 41, "evidence": "fn SqliteColumnType(stmt: *mut c_void, i_col: i32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 42, "evidence": "fn SqliteReset(stmt: *mut c_void) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 67, "evidence": "&mut stmt.handle as *mut usize as _,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/db_operator/src/statement.rs", "line": 68, "evidence": "&mut tail as *mut usize as _,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "services/db_operator/src/statement.rs", "line": 19, "evidence": "use std::ffi::CStr;", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/db_operator/src/statement.rs", "line": 159, "evidence": "unsafe { core::slice::from_raw_parts(blob, len as _) }", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/db_key_operator.rs", "line": 121, "evidence": "if unsafe { GenerateRandom(db_key.as_mut_ptr(), db_key.len() as u32) } != SUCCESS {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/db_key_operator.rs", "line": 100, "evidence": "fn GenerateRandom(random: *mut u8, random_len: u32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/crypto_manager/src/db_key_operator.rs", "line": 85, "evidence": "let _lock = GEN_KEY_MUTEX.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/crypto_manager/src/db_key_operator.rs", "line": 149, "evidence": "let _lock = GET_DB_KEY_MUTEX.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/secret_key.rs", "line": 156, "evidence": "unsafe { RenameKeyAlias(&key_id as *const KeyId, &prefixed_new_alias_blob as *const HksBlob) }", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/secret_key.rs", "line": 227, "evidence": "let ret = unsafe { IsKeyExist(&key_id as *const KeyId) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/secret_key.rs", "line": 239, "evidence": "let ret = unsafe { GenerateKey(&key_id as *const KeyId, self.need_user_auth(), self.require_password_set) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/secret_key.rs", "line": 250, "evidence": "let ret = unsafe { DeleteKey(&key_id as *const KeyId) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 43, "evidence": "fn GenerateKey(keyId: *const KeyId, need_auth: bool, require_password_set: bool) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 44, "evidence": "fn DeleteKey(keyId: *const KeyId) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 45, "evidence": "fn IsKeyExist(keyId: *const KeyId) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 46, "evidence": "fn RenameKeyAlias(keyId: *const KeyId, newKeyAlias: *const HksBlob) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 156, "evidence": "unsafe { RenameKeyAlias(&key_id as *const KeyId, &prefixed_new_alias_blob as *const HksBlob) }", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 227, "evidence": "let ret = unsafe { IsKeyExist(&key_id as *const KeyId) };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 239, "evidence": "let ret = unsafe { GenerateKey(&key_id as *const KeyId, self.need_user_auth(), self.require_password_set) };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/secret_key.rs", "line": 250, "evidence": "let ret = unsafe { DeleteKey(&key_id as *const KeyId) };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/crypto.rs", "line": 74, "evidence": "let ret = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/crypto.rs", "line": 101, "evidence": "let ret = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/crypto.rs", "line": 125, "evidence": "let ret = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/crypto.rs", "line": 152, "evidence": "let ret = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/crypto_manager/src/crypto.rs", "line": 190, "evidence": "unsafe { Drop(&handle as *const HksBlob) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 26, "evidence": "fn EncryptData(keyId: *const KeyId, aad: *const HksBlob, in_data: *const HksBlob, out_data: *mut OutBlob) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 27, "evidence": "fn DecryptData(keyId: *const KeyId, aad: *const HksBlob, in_data: *const HksBlob, out_data: *mut OutBlob) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 28, "evidence": "fn InitKey(keyId: *const KeyId, valid_time: u32, challenge: *mut OutBlob, handle: *mut OutBlob) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 30, "evidence": "handle: *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 31, "evidence": "aad: *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 32, "evidence": "auth_token: *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 33, "evidence": "in_data: *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 34, "evidence": "out_data: *mut OutBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 36, "evidence": "fn Drop(handle: *const HksBlob) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 76, "evidence": "&key_id as *const KeyId,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 78, "evidence": "&mut challenge as *mut OutBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 79, "evidence": "&mut handle as *mut OutBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 103, "evidence": "&handle as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 104, "evidence": "&aad as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 105, "evidence": "&auth_token as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 106, "evidence": "&in_data as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 107, "evidence": "&mut out_data as *mut OutBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 127, "evidence": "&key_id as *const KeyId,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 128, "evidence": "&aad_data as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 129, "evidence": "&in_data as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 130, "evidence": "&mut out_data as *mut OutBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 154, "evidence": "&key_id as *const KeyId,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 155, "evidence": "&aad_data as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 156, "evidence": "&in_data as *const HksBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 157, "evidence": "&mut out_data as *mut OutBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/crypto.rs", "line": 190, "evidence": "unsafe { Drop(&handle as *const HksBlob) };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/crypto_manager/src/crypto_manager.rs", "line": 89, "evidence": "self.remove_expired_crypto().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/lib.rs", "line": 28, "evidence": "data: *const u8,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/crypto_manager/src/lib.rs", "line": 34, "evidence": "data: *mut u8,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/common/src/calling_info.rs", "line": 143, "evidence": "match owner_info_vec.last().unwrap().parse::<u32>() {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/common/src/process_info.rs", "line": 144, "evidence": "match unsafe { GetCallingProcessInfo(user_id, uid, &mut process_info_ffi) } {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/common/src/process_info.rs", "line": 76, "evidence": "fn GetCallingProcessInfo(userId: u32, uid: u64, ownerInfo: *mut ProcessInfoFfi) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/common/src/counter.rs", "line": 79, "evidence": "counter.lock().unwrap().increase_count();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/common/src/counter.rs", "line": 88, "evidence": "counter.lock().unwrap().decrease_count();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/common/src/lib.rs", "line": 125, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/common/src/lib.rs", "line": 137, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/common/src/lib.rs", "line": 44, "evidence": "pub data: *const u8,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/common/src/lib.rs", "line": 53, "evidence": "pub blobs: *const ConstAssetBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/common/src/lib.rs", "line": 62, "evidence": "pub data: *mut u8,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/common/src/lib.rs", "line": 71, "evidence": "pub blob: *const c_char,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/common/src/lib.rs", "line": 80, "evidence": "pub blobs: *mut ModifyAssetBlob,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/data_size_mod.rs", "line": 47, "evidence": "let ret_code: i32 = unsafe { GetRemainPartitionSize(partition_cstr.as_ptr(), &mut remain_size) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/data_size_mod.rs", "line": 60, "evidence": "let folder_size: u64 = unsafe { GetDirSize(path_cstr.as_ptr()) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/data_size_mod.rs", "line": 102, "evidence": "let ret: i32 = unsafe { GetUserIds(user_ids_ptr, user_ids_size_ptr) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/data_size_mod.rs", "line": 34, "evidence": "fn GetUserIds(userIdsPtr: *mut i32, userIdsSize: *mut u32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/data_size_mod.rs", "line": 35, "evidence": "fn GetRemainPartitionSize(partition_name: *const c_char, partition_size: *mut f64) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/data_size_mod.rs", "line": 36, "evidence": "fn GetDirSize(dir: *const c_char) -> u64;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/data_size_mod.rs", "line": 45, "evidence": "let partition_cstr = CString::new(partition).unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/data_size_mod.rs", "line": 59, "evidence": "let path_cstr = CString::new(folder_path.as_str()).unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/data_size_mod.rs", "line": 140, "evidence": "let _lock = RECORD_UNIX_FILE_MUTEX.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/data_size_mod.rs", "line": 69, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/data_size_mod.rs", "line": 85, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "services/core_service/src/data_size_mod.rs", "line": 24, "evidence": "use std::{ffi::CString, fs, os::{raw::c_char, unix::fs::PermissionsExt}, path::Path, sync::Mutex};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/stub.rs", "line": 47, "evidence": "if counter.lock().unwrap().is_stop() {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/upgrade_operator.rs", "line": 136, "evidence": "let ret = unsafe { GetCloneAppIndexes(user_id, indexes.as_mut_ptr(), &mut index_size, app_name_cstr.as_ptr())};", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/upgrade_operator.rs", "line": 164, "evidence": "let ret = unsafe { IsHapInAllowList(user_id, app_name.as_ptr(), &mut is_in_list) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/upgrade_operator.rs", "line": 42, "evidence": "fn GetCloneAppIndexes(userId: i32, appIndexes: *mut i32, indexSize: *mut u32, appName: *const c_char) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/upgrade_operator.rs", "line": 43, "evidence": "fn IsHapInAllowList(userId: i32, appName: *const c_char, isHapInList: &mut bool) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/upgrade_operator.rs", "line": 73, "evidence": "match parts.last().unwrap().parse::<i32>() {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/upgrade_operator.rs", "line": 162, "evidence": "let app_name = CString::new(info).unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/upgrade_operator.rs", "line": 180, "evidence": "let owner_info = datas.first().unwrap().get_bytes_attr(&column::OWNER)?;", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/upgrade_operator.rs", "line": 181, "evidence": "let owner_type = datas.first().unwrap().get_enum_attr::<OwnerType>(&column::OWNER_TYPE)?;", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/upgrade_operator.rs", "line": 114, "evidence": "let _ = upgrade_execute(user_id, version.clone(), &info);", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/upgrade_operator.rs", "line": 222, "evidence": "let _ = generate_secret_key_if_needed(&new_secret_key);", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/upgrade_operator.rs", "line": 223, "evidence": "let _ = generate_secret_key_if_needed(&secret_key);", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "services/core_service/src/upgrade_operator.rs", "line": 19, "evidence": "use std::{ffi::CString, collections::HashSet};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 95, "evidence": "let max_crypto_expire_duration = crypto_manager.lock().unwrap().max_crypto_expire_duration();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 100, "evidence": "if counter.lock().unwrap().count() > 0 {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 104, "evidence": "if !task_manager.lock().unwrap().is_empty() {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 141, "evidence": "let max_crypto_expire_duration = crypto_manager.lock().unwrap().max_crypto_expire_duration();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 148, "evidence": "if counter.lock().unwrap().count() > 0 {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 151, "evidence": "counter.lock().unwrap().count(),", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 163, "evidence": "counter.lock().unwrap().stop();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/lib.rs", "line": 215, "evidence": "task_manager.lock().unwrap().push_task(handle);", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/lib.rs", "line": 124, "evidence": "let _ = upload_system_event(start_service(handler), &calling_info, start, func_name, &AssetMap::new());", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 183, "evidence": "let group_ids_slice = unsafe { slice::from_raw_parts(group_ids.blobs, group_ids.size as usize) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 188, "evidence": "let data = unsafe { slice::from_raw_parts(group_id_slice.data, group_id_slice.size as usize) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 196, "evidence": "match unsafe { GetUninstallGroups(user_id, &developer_id, &mut the_group_ids) } {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 204, "evidence": "let the_group_ids_slice = unsafe { slice::from_raw_parts(the_group_ids.blobs, the_group_ids.size as usize) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 206, "evidence": "let developer_id = unsafe { slice::from_raw_parts(developer_id.data, developer_id.size as usize) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 216, "evidence": "let group_id = unsafe { CStr::from_ptr(group_id_slice.blob) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 237, "evidence": "let owner: Vec<u8> = unsafe { slice::from_raw_parts(owner.data, owner.size as usize).to_vec() };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 275, "evidence": "let bundle_name: Vec<u8> = unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 343, "evidence": "let c_str = unsafe { CStr::from_ptr(bundle_name as _) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 471, "evidence": "let ret: i32 = unsafe { GetFirstUnlockUserIds(user_ids_ptr, user_ids_size_ptr) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 543, "evidence": "ret = unsafe { GetUsersSize(user_ids_size_ptr) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 550, "evidence": "ret = unsafe { GetUserIds(user_ids_ptr, user_ids_size_ptr) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 555, "evidence": "let user_ids_slice = unsafe { slice::from_raw_parts_mut(user_ids_ptr, (*user_ids_size_ptr).try_into().unwrap()) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 587, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/common_event/listener.rs", "line": 612, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/common_event/listener.rs", "line": 72, "evidence": "fn GetUninstallGroups(userId: i32, developer_id: *const ConstAssetBlob, group_ids: *mut MutAssetBlobArray) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/common_event/listener.rs", "line": 342, "evidence": "pub(crate) extern \" \" fn on_app_restore(user_id: i32, bundle_name: *const u8, app_index: i32) {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/common_event/listener.rs", "line": 436, "evidence": "fn GetUserIds(userIdsPtr: *mut i32, userIdsSize: *mut u32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/common_event/listener.rs", "line": 437, "evidence": "fn GetFirstUnlockUserIds(userIdsPtr: *mut i32, userIdsSize: *mut u32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/common_event/listener.rs", "line": 438, "evidence": "fn GetUsersSize(userIdsSize: *mut u32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/common_event/listener.rs", "line": 573, "evidence": "on_app_restore: extern \" \" fn(i32, *const u8, i32),", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/common_event/listener.rs", "line": 172, "evidence": "crypto_manager.lock().unwrap().remove_by_calling_info(calling_info);", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/common_event/listener.rs", "line": 189, "evidence": "let data_str = CString::new(String::from_utf8_lossy(data).to_string()).unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/common_event/listener.rs", "line": 313, "evidence": "crypto_manager.lock().unwrap().remove_need_device_unlocked();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/common_event/listener.rs", "line": 325, "evidence": "let mut record_time = RECORD_TIME.lock().expect(\"                          \");", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/common_event/listener.rs", "line": 419, "evidence": "let _lock = LAST_TRIGGER_TIME_FILE_MUTEX.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/common_event/listener.rs", "line": 548, "evidence": "let mut user_ids: Vec<i32> = vec![0i32; (*user_ids_size_ptr + USER_ID_VEC_BUFFER).try_into().unwrap()];", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/common_event/listener.rs", "line": 555, "evidence": "let user_ids_slice = unsafe { slice::from_raw_parts_mut(user_ids_ptr, (*user_ids_size_ptr).try_into().unwrap()) };", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 104, "evidence": "let _ = db.delete_datas(&delete_condition, Some(reverse_condition), false)?;", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 113, "evidence": "let _ = db.delete_datas(&delete_condition, Some(reverse_condition), false)?;", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 130, "evidence": "let _ = db.delete_datas(&delete_condition, Some(reverse_condition), false)?;", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 139, "evidence": "let _ = db.delete_datas(&delete_condition, Some(reverse_condition), false)?;", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 286, "evidence": "let _ = update_upgrade_list(package_info.user_id, &String::from_utf8_lossy(&bundle_name).to_string());", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 306, "evidence": "let _ = delete_user_de_dir(user_id);", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 397, "evidence": "let _ = upgrade_clone_app_data(user_id);", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 443, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/common_event/listener.rs", "line": 462, "evidence": "let _ = fs::set_permissions(path, fs::Permissions::from_mode(0o640));", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "services/core_service/src/common_event/listener.rs", "line": 19, "evidence": "ffi::{CStr, CString},", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/core_service/src/common_event/listener.rs", "line": 183, "evidence": "let group_ids_slice = unsafe { slice::from_raw_parts(group_ids.blobs, group_ids.size as usize) };", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/core_service/src/common_event/listener.rs", "line": 188, "evidence": "let data = unsafe { slice::from_raw_parts(group_id_slice.data, group_id_slice.size as usize) };", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/core_service/src/common_event/listener.rs", "line": 204, "evidence": "let the_group_ids_slice = unsafe { slice::from_raw_parts(the_group_ids.blobs, the_group_ids.size as usize) };", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/core_service/src/common_event/listener.rs", "line": 206, "evidence": "let developer_id = unsafe { slice::from_raw_parts(developer_id.data, developer_id.size as usize) };", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/core_service/src/common_event/listener.rs", "line": 237, "evidence": "let owner: Vec<u8> = unsafe { slice::from_raw_parts(owner.data, owner.size as usize).to_vec() };", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/core_service/src/common_event/listener.rs", "line": 276, "evidence": "slice::from_raw_parts(package_info.bundle_name.data, package_info.bundle_name.size as usize).to_vec()", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/operations/operation_pre_query.rs", "line": 93, "evidence": "crypto_manager.lock().unwrap().add(crypto)?;", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "pointer_arithmetic", "file": "services/core_service/src/operations/operation_pre_query.rs", "line": 93, "evidence": "crypto_manager.lock().unwrap().add(crypto)?;", "description": "使用 offset/add 进行指针算术，若计算结果超出有效范围将导致未定义行为。", "suggestion": "确保指针算术结果在有效对象边界内；使用 slice 等安全抽象替代原始指针算术。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/operations/operation_post_query.rs", "line": 43, "evidence": "crypto_manager.lock().unwrap().remove(calling_info, challenge);", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/operations/operation_query.rs", "line": 77, "evidence": "let mut manager = arc_crypto_manager.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/operations/operation_query.rs", "line": 128, "evidence": "let tag = Tag::try_from(*order_by).expect(\"                                    \");", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/operations/operation_add.rs", "line": 134, "evidence": "if unsafe { !CheckPermission(permission.as_ptr()) } {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/operations/operation_add.rs", "line": 210, "evidence": "if unsafe { !CheckSystemHapPermission() } {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/operations/operation_add.rs", "line": 127, "evidence": "fn CheckPermission(permission: *const c_char) -> bool;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/operations/operation_add.rs", "line": 133, "evidence": "let permission = CString::new(\"                                     \").unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "ignored_result", "file": "services/core_service/src/operations/operation_add.rs", "line": 238, "evidence": "let _ = db.insert_datas(&db_data)?;", "description": "可能忽略了返回的错误结果，导致失败未被处理。", "suggestion": "显式处理 Result（? 传播或 match），确保错误路径涵盖资源回收与日志记录。", "confidence": 0.55, "severity": "low"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "services/core_service/src/operations/operation_add.rs", "line": 18, "evidence": "use std::{ffi::CString, os::raw::c_char};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/operations/operation_update.rs", "line": 127, "evidence": "let result = results.get_mut(0).unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/operations/common/permission_check.rs", "line": 32, "evidence": "if unsafe { !CheckSystemHapPermission() } {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/core_service/src/operations/common/permission_check.rs", "line": 37, "evidence": "if unsafe { !CheckPermission(permission.as_ptr()) } {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/core_service/src/operations/common/permission_check.rs", "line": 26, "evidence": "fn CheckPermission(permission: *const c_char) -> bool;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/core_service/src/operations/common/permission_check.rs", "line": 36, "evidence": "let permission = CString::new(\"                                              \").unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "services/core_service/src/operations/common/permission_check.rs", "line": 18, "evidence": "use std::{ffi::CString, os::raw::c_char};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/plugin/src/asset_plugin.rs", "line": 63, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "services/plugin/src/asset_plugin.rs", "line": 81, "evidence": ".get::<libloading::Symbol<unsafe extern \" \" fn() -> *mut dyn IAssetPlugin>>(b\"              \")", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "services/plugin/src/asset_plugin.rs", "line": 81, "evidence": ".get::<libloading::Symbol<unsafe extern \" \" fn() -> *mut dyn IAssetPlugin>>(b\"              \")", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/plugin/src/asset_plugin.rs", "line": 64, "evidence": "let _guard = ASSET_PLUGIN_LOCK.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/plugin/src/asset_plugin.rs", "line": 102, "evidence": "let _guard = ASSET_PLUGIN_LOCK.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/plugin/src/asset_plugin.rs", "line": 131, "evidence": "let developer_id: Vec<u8> = parts.next().unwrap().to_vec();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "services/plugin/src/asset_plugin.rs", "line": 132, "evidence": "let group_id: Vec<u8> = parts.next().unwrap().to_vec();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "concurrency", "pattern": "unsafe_impl_Send_or_Sync", "file": "services/plugin/src/asset_plugin.rs", "line": 45, "evidence": "unsafe impl Sync for AssetPlugin {}", "description": "手写 unsafe impl Send/Sync 可能破坏并发内存模型保证，带来数据竞争风险。", "suggestion": "避免手写 unsafe impl；必要时严格证明线程安全前置条件并最小化不安全区域。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "services/plugin/src/asset_plugin.rs", "line": 96, "evidence": "Ok(Box::from_raw(plugin_ptr))", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 50, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 157, "evidence": "pub unsafe extern \" \" fn pre_query_asset(query: *const AssetAttr, query_cnt: u32, challenge: *mut AssetBlob) -> i32 {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 193, "evidence": "pub unsafe extern \" \" fn query_asset(query: *const AssetAttr, query_cnt: u32, result_set: *mut AssetResultSet) -> i32 {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 250, "evidence": "pub unsafe extern \" \" fn query_sync_result(", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 309, "evidence": "blob.data = unsafe { AssetMalloc(blob.size) as *mut u8 };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 316, "evidence": "unsafe { copy_nonoverlapping(vec.as_ptr(), blob.data, blob.size as usize) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 355, "evidence": "unsafe { AssetMalloc(result.count.wrapping_mul(size_of::<AssetAttr>() as u32)) as *mut AssetAttr };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 364, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 387, "evidence": "unsafe { AssetMalloc(result_set.count.wrapping_mul(size_of::<AssetResult>() as u32)) as *mut AssetResult };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 395, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 35, "evidence": "fn AssetMalloc(size: u32) -> *mut c_void;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 38, "evidence": "fn into_map(attributes: *const AssetAttr, attr_cnt: u32) -> Option<AssetMap> {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 80, "evidence": "pub extern \" \" fn add_asset(attributes: *const AssetAttr, attr_cnt: u32) -> i32 {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 101, "evidence": "pub extern \" \" fn remove_asset(query: *const AssetAttr, query_cnt: u32) -> i32 {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 123, "evidence": "query: *const AssetAttr,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 125, "evidence": "attrs_to_update: *const AssetAttr,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 157, "evidence": "pub unsafe extern \" \" fn pre_query_asset(query: *const AssetAttr, query_cnt: u32, challenge: *mut AssetBlob) -> i32 {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 193, "evidence": "pub unsafe extern \" \" fn query_asset(query: *const AssetAttr, query_cnt: u32, result_set: *mut AssetResultSet) -> i32 {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 225, "evidence": "pub extern \" \" fn post_query_asset(handle: *const AssetAttr, handle_cnt: u32) -> i32 {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 251, "evidence": "query: *const AssetAttr,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 253, "evidence": "sync_result: *mut SyncResult,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 300, "evidence": "data: *mut u8,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 309, "evidence": "blob.data = unsafe { AssetMalloc(blob.size) as *mut u8 };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 345, "evidence": "attrs: *mut AssetAttr,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 355, "evidence": "unsafe { AssetMalloc(result.count.wrapping_mul(size_of::<AssetAttr>() as u32)) as *mut AssetAttr };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 378, "evidence": "results: *mut AssetResult,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 387, "evidence": "unsafe { AssetMalloc(result_set.count.wrapping_mul(size_of::<AssetResult>() as u32)) as *mut AssetResult };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 91, "evidence": "let ret = if let Err(e) = manager.lock().unwrap().add(&map) {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 112, "evidence": "let ret = if let Err(e) = manager.lock().unwrap().remove(&map) {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 143, "evidence": "let ret = if let Err(e) = manager.lock().unwrap().update(&query_map, &update_map) {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 173, "evidence": "let res = match manager.lock().unwrap().pre_query(&map) {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 209, "evidence": "let res = match manager.lock().unwrap().query(&map) {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 236, "evidence": "let ret = if let Err(e) = manager.lock().unwrap().post_query(&map) {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 270, "evidence": "let ret = match manager.lock().unwrap().query_sync_result(&map) {", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "pointer_arithmetic", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 51, "evidence": "let attr = attributes.add(i as usize);", "description": "使用 offset/add 进行指针算术，若计算结果超出有效范围将导致未定义行为。", "suggestion": "确保指针算术结果在有效对象边界内；使用 slice 等安全抽象替代原始指针算术。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "pointer_arithmetic", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 91, "evidence": "let ret = if let Err(e) = manager.lock().unwrap().add(&map) {", "description": "使用 offset/add 进行指针算术，若计算结果超出有效范围将导致未定义行为。", "suggestion": "确保指针算术结果在有效对象边界内；使用 slice 等安全抽象替代原始指针算术。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "pointer_arithmetic", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 365, "evidence": "let attr = result.attrs.add(i);", "description": "使用 offset/add 进行指针算术，若计算结果超出有效范围将导致未定义行为。", "suggestion": "确保指针算术结果在有效对象边界内；使用 slice 等安全抽象替代原始指针算术。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "pointer_arithmetic", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 396, "evidence": "let result = result_set.results.add(i);", "description": "使用 offset/add 进行指针算术，若计算结果超出有效范围将导致未定义行为。", "suggestion": "确保指针算术结果在有效对象边界内；使用 slice 等安全抽象替代原始指针算术。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe_mem_ops", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 316, "evidence": "unsafe { copy_nonoverlapping(vec.as_ptr(), blob.data, blob.size as usize) };", "description": "使用不安全的内存操作（copy/copy_nonoverlapping/write/read），需确保指针有效性、对齐与重叠检查。", "suggestion": "优先使用安全的复制方法；必须使用时，在 SAFETY 注释中证明指针有效性、对齐与边界条件。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "from_raw_parts/from_raw", "file": "interfaces/inner_kits/c/src/lib.rs", "line": 68, "evidence": "let blob_slice = slice::from_raw_parts((*attr).value.blob.data, (*attr).value.blob.size as usize);", "description": "使用 from_raw_parts/from_raw 从原始指针构造，需确保指针有效性、对齐与生命周期安全。", "suggestion": "优先使用安全的构造函数；必须使用时，在 SAFETY 注释中证明所有前置条件（有效性/对齐/生命周期）。", "confidence": 0.85, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "uninit/zeroed", "file": "interfaces/inner_kits/rs/src/plugin_interface.rs", "line": 263, "evidence": "fn uninit(&self);", "description": "使用 uninit/zeroed 创建未初始化内存，若在初始化前读取将导致未定义行为。", "suggestion": "确保在使用前完成初始化；优先使用 MaybeUninit 进行更安全的未初始化内存管理。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/rs/src/lib.rs", "line": 41, "evidence": "let ret = unsafe { GetTimeOut(&mut timeout as *mut i32) };", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "interfaces/inner_kits/rs/src/lib.rs", "line": 65, "evidence": "unsafe {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/rs/src/lib.rs", "line": 32, "evidence": "fn GetTimeOut(timeout: *mut i32) -> i32;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "interfaces/inner_kits/rs/src/lib.rs", "line": 41, "evidence": "let ret = unsafe { GetTimeOut(&mut timeout as *mut i32) };", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "interfaces/inner_kits/rs/src/lib.rs", "line": 63, "evidence": "let _guard = ASSET_PLUGIN_LOCK.lock().unwrap();", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
