{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 39, "evidence": "ErrCode res = backend_->SetUp();", "description": "可能对指针 backend_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 52, "evidence": "target->next_ = h->next_;", "description": "可能对指针 h 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 52, "evidence": "target->next_ = h->next_;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 53, "evidence": "target->prev_ = h;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 54, "evidence": "if (h->next_ != nullptr) {", "description": "可能对指针 h 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 55, "evidence": "h->next_->prev_ = target;", "description": "可能对指针 h 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 55, "evidence": "h->next_->prev_ = target;", "description": "可能对指针 next_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 57, "evidence": "h->next_ = target;", "description": "可能对指针 h 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 62, "evidence": "target->prev_->next_ = target->next_;", "description": "可能对指针 prev_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 62, "evidence": "target->prev_->next_ = target->next_;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 64, "evidence": "if (target->next_ != nullptr) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 65, "evidence": "target->next_->prev_ = target->prev_;", "description": "可能对指针 next_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 65, "evidence": "target->next_->prev_ = target->prev_;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 68, "evidence": "target->prev_ = nullptr;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 69, "evidence": "target->next_ = nullptr;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 80, "evidence": "if (target->fd_ < 0 || target->fd_ > MAX_FD) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 84, "evidence": "if (target->prev_!=nullptr) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 90, "evidence": "int fd = target->fd_;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 98, "evidence": "if ((ioHandlers_[fd].events & target->events_) != target->events_) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 99, "evidence": "if (backend_ == nullptr || !UpdateToDemultiplexer(target->fd_)) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 100, "evidence": "UTILS_LOGE(\"                                                    \", __FUNCTION__, target->fd_);", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 105, "evidence": "target->enabled_ = true;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 118, "evidence": "if (target->fd_ < 0 || target->fd_ > MAX_FD) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 123, "evidence": "if (target->prev_!=nullptr) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 128, "evidence": "if (backend_ == nullptr || !UpdateToDemultiplexer(target->fd_)) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 129, "evidence": "UTILS_LOGE(\"                                                    \", __FUNCTION__, target->fd_);", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 146, "evidence": "if (target->fd_ < 0 || target->fd_ > MAX_FD) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 151, "evidence": "target->enabled_ = false;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 156, "evidence": "target->enabled_=true;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 162, "evidence": "if (backend_ == nullptr || !UpdateToDemultiplexer(target->fd_)) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 163, "evidence": "UTILS_LOGE(\"                                                    \", __FUNCTION__, target->fd_);", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 164, "evidence": "target->enabled_=true;", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 174, "evidence": "if (target->fd_ < 0 || target->fd_ >= ioHandlers_.size()) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 178, "evidence": "for (IOEventHandler* cur = ioHandlers_[target->fd_].head.get(); cur != nullptr; cur = cur->next_) {", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 178, "evidence": "for (IOEventHandler* cur = ioHandlers_[target->fd_].head.get(); cur != nullptr; cur = cur->next_) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 195, "evidence": "if (target->fd_ < 0 || target->fd_ > MAX_FD) {", "description": "可能对指针 target 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 213, "evidence": "for (IOEventHandler* cur = ioHandlers_[fd].head.get(); cur != nullptr; cur = cur->next_) {", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 214, "evidence": "emask |= cur->events_;", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 222, "evidence": "ErrCode res = backend_->ModifyEvents(fd, emask);", "description": "可能对指针 backend_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 249, "evidence": "for (IOEventHandler* cur = ioHandlers_[fd].head.get()->next_; cur != nullptr; cur = cur->next_) {", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 250, "evidence": "if (cur->events_ != Events::EVENT_NONE && cur->enabled_ && (cur->events_ & event) && cur->cb_) {", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 251, "evidence": "taskQue.push_back(cur->cb_);", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 253, "evidence": "__FUNCTION__, event, fd, cur->events_, cur->enabled_);", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 256, "evidence": "__FUNCTION__, event, fd, cur->events_, cur->enabled_);", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 293, "evidence": "res = backend_->Polling(timeout, gotEvents);", "description": "可能对指针 backend_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 295, "evidence": "res = backend_->Polling(timeout, gotEvents);", "description": "可能对指针 backend_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 317, "evidence": "if (ioHandlers_[fd].head->next_ == nullptr) {", "description": "可能对指针 head 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 321, "evidence": "for (IOEventHandler* cur = ioHandlers_[fd].head->next_; cur != nullptr; cur = cur->next_) {", "description": "可能对指针 head 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 321, "evidence": "for (IOEventHandler* cur = ioHandlers_[fd].head->next_; cur != nullptr; cur = cur->next_) {", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 322, "evidence": "cur->prev_->next_ = nullptr;", "description": "可能对指针 prev_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 322, "evidence": "cur->prev_->next_ = nullptr;", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 323, "evidence": "cur->prev_ = nullptr;", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_reactor.cpp", "line": 324, "evidence": "cur->enabled_ = false;", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/mapped_file.cpp", "line": 217, "evidence": "data = mmap(reinterpret_cast<void*>(const_cast<char *>(hint_)),", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/mapped_file.cpp", "line": 237, "evidence": "rStart_ = reinterpret_cast<char*>(data);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/mapped_file.cpp", "line": 339, "evidence": "rStart_ = reinterpret_cast<char*>(newData);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "const_cast_unsafe", "file": "base/src/mapped_file.cpp", "line": 217, "evidence": "data = mmap(reinterpret_cast<void*>(const_cast<char *>(hint_)),", "description": "使用 const_cast 移除 const 修饰符，可能导致未定义行为（如修改常量对象）。", "suggestion": "避免使用 const_cast；若必须使用，确保仅用于移除非底层 const 且对象本身可变。", "confidence": 0.75, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "base/src/parcel.cpp", "line": 64, "evidence": "allocator_ = new DefaultAllocator();", "description": "内存/对象分配给 allocator_ 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/parcel.cpp", "line": 475, "evidence": "bool Parcel::Write(T value)", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/parcel.cpp", "line": 809, "evidence": "bool Parcel::Read(T &value)", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/parcel.cpp", "line": 831, "evidence": "T Parcel::Read()", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "use_after_free_suspect", "file": "base/src/parcel.cpp", "line": 1376, "evidence": "free(data);", "description": "变量 data 在 free 后的邻近窗口内出现了解引用使用（UAF 线索），且未检测到重新赋值/置空。", "suggestion": "free 后应将指针置为 NULL，并避免在重新赋值前进行任何解引用；建议引入生命周期管理与动态/静态检测。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 169, "evidence": "void *newData = allocator_->Realloc(data_, newCapacity);", "description": "可能对指针 allocator_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 187, "evidence": "if (currentObject->hdr.type == BINDER_TYPE_FD || currentObject->hdr.type == BINDER_TYPE_HANDLE) {", "description": "可能对指针 currentObject 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 272, "evidence": "void *newData = allocator->Alloc(dataSize_);", "description": "可能对指针 allocator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 279, "evidence": "allocator->Dealloc(newData);", "description": "可能对指针 allocator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 282, "evidence": "allocator_->Dealloc(data_);", "description": "可能对指针 allocator_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 345, "evidence": "allocator_->Dealloc(data_);", "description": "可能对指针 allocator_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 364, "evidence": "void *newData = allocator_->Realloc(data_, newCapacity);", "description": "可能对指针 allocator_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 404, "evidence": "*reinterpret_cast<uint32_t *>(dest + padSize - MAX_MASK_NUM) &= mask[padSize];", "description": "可能对指针 reinterpret_cast 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 480, "evidence": "*reinterpret_cast<T *>(data_ + writeCursor_) = value;", "description": "可能对指针 reinterpret_cast 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 740, "evidence": "if ((object == nullptr) || (!object->asRemote_)) {", "description": "可能对指针 object 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 748, "evidence": "if (!object->Marshalling(*this)) {", "description": "可能对指针 object 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 754, "evidence": "if (object->TestBehavior(Parcelable::BehaviorFlag::HOLD_OBJECT)) {", "description": "可能对指针 object 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 773, "evidence": "if (!object->asRemote_) {", "description": "可能对指针 object 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 779, "evidence": "return object->Marshalling(*this);", "description": "可能对指针 object 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 804, "evidence": "object->SetBehavior(Parcelable::BehaviorFlag::HOLD_OBJECT);", "description": "可能对指针 object 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 823, "evidence": "value = *reinterpret_cast<const T *>(data);", "description": "可能对指针 reinterpret_cast 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1386, "evidence": "bool Parcel::WriteVector(const std::vector<T1> &val, bool (Parcel::*Write)(T2))", "description": "可能对指针 Write 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1411, "evidence": "bool Parcel::WriteFixedAlignVector(const std::vector<T1> &originVal, bool (Parcel::*SpecialWrite)(T2))", "description": "可能对指针 SpecialWrite 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1502, "evidence": "bool Parcel::ReadVector(std::vector<T> *val, bool (Parcel::*Read)(T &))", "description": "可能对指针 Read 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1515, "evidence": "if ((size > readAbleSize) || (size > val->max_size())) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1519, "evidence": "val->resize(size);", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1520, "evidence": "if (val->size() < size) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1524, "evidence": "for (auto &v : *val) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1536, "evidence": "bool Parcel::ReadFixedAlignVector(std::vector<T1> *val, bool (Parcel::*SpecialRead)(T2 &))", "description": "可能对指针 SpecialRead 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1549, "evidence": "if ((size > readAbleSize) || (size > val->max_size())) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1554, "evidence": "val->resize(size);", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1555, "evidence": "if (val->size() < size) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1564, "evidence": "(*val)[i] = parcelVal;", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1640, "evidence": "if ((size > readAbleSize) || (val->max_size() < size)) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1644, "evidence": "val->resize(size);", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1645, "evidence": "if (val->size() < size) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1649, "evidence": "for (auto &v : *val) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1669, "evidence": "if ((size > readAbleSize) || (val->max_size() < size)) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1675, "evidence": "val->resize(size);", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1676, "evidence": "if (val->size() < size) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/parcel.cpp", "line": 1680, "evidence": "for (auto &v : *val) {", "description": "可能对指针 val 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 29, "evidence": "uintptr_t ptr = reinterpret_cast<uintptr_t>(p);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 171, "evidence": "data_ = reinterpret_cast<uint8_t *>(newData);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 186, "evidence": "auto currentObject = reinterpret_cast<parcel_flat_binder_object *>(data_ + offset);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 228, "evidence": "return reinterpret_cast<uintptr_t>(data_);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 233, "evidence": "return reinterpret_cast<binder_size_t>(objectOffsets_);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 283, "evidence": "data_ = reinterpret_cast<uint8_t *>(newData);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 320, "evidence": "auto *newObjectOffsets = reinterpret_cast<binder_size_t *>(offsets);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 366, "evidence": "data_ = reinterpret_cast<uint8_t *>(newData);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 404, "evidence": "*reinterpret_cast<uint32_t *>(dest + padSize - MAX_MASK_NUM) &= mask[padSize];", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 480, "evidence": "*reinterpret_cast<T *>(data_ + writeCursor_) = value;", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 647, "evidence": "std::u16string u16str(reinterpret_cast<const char16_t *>(value), len);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 697, "evidence": "objectOffsets_ = reinterpret_cast<binder_size_t *>(newOffsets);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 823, "evidence": "value = *reinterpret_cast<const T *>(data);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 850, "evidence": "data_ = reinterpret_cast<uint8_t *>(data);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 972, "evidence": "objectOffsets_ = reinterpret_cast<binder_size_t *>(newOffsets);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1160, "evidence": "const char* cstr = reinterpret_cast<const char*>(data_ + readCursor_);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1162, "evidence": "const char* eos = reinterpret_cast<const char*>(memchr(cstr, 0, avail));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1193, "evidence": "const auto *str = reinterpret_cast<const char *>(dest);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1223, "evidence": "const auto *str = reinterpret_cast<const char *>(dest);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1254, "evidence": "const auto *u16Str = reinterpret_cast<const char16_t *>(str);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1284, "evidence": "const auto *u16Str = reinterpret_cast<const char16_t *>(str);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1320, "evidence": "const auto *u16Str = reinterpret_cast<const char16_t *>(str);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/parcel.cpp", "line": 1355, "evidence": "const auto *u8Str = reinterpret_cast<const char *>(str);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "const_cast_unsafe", "file": "base/src/parcel.cpp", "line": 755, "evidence": "sptr<Parcelable> tmp(const_cast<Parcelable *>(object));", "description": "使用 const_cast 移除 const 修饰符，可能导致未定义行为（如修改常量对象）。", "suggestion": "避免使用 const_cast；若必须使用，确保仅用于移除非底层 const 且对象本身可变。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "const_cast_unsafe", "file": "base/src/parcel.cpp", "line": 787, "evidence": "if (WriteRemoteObject(const_cast<Parcelable*>(object))) {", "description": "使用 const_cast 移除 const 修饰符，可能导致未定义行为（如修改常量对象）。", "suggestion": "避免使用 const_cast；若必须使用，确保仅用于移除非底层 const 且对象本身可变。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_handler.cpp", "line": 33, "evidence": "prev_->next_ = next_;", "description": "可能对指针 prev_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_handler.cpp", "line": 37, "evidence": "next_->prev_ = prev_;", "description": "可能对指针 next_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_handler.cpp", "line": 46, "evidence": "ErrCode res = reactor->AddHandler(this);", "description": "可能对指针 reactor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_handler.cpp", "line": 57, "evidence": "ErrCode res = reactor->RemoveHandler(this);", "description": "可能对指针 reactor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/io_event_handler.cpp", "line": 68, "evidence": "ErrCode res = reactor->UpdateHandler(this);", "description": "可能对指针 reactor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "base/src/refbase.cpp", "line": 144, "evidence": "RefTracker* newTracker = new RefTracker(refTracker, objectId, atomicStrong_,", "description": "内存/对象分配给 newTracker 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "base/src/refbase.cpp", "line": 484, "evidence": "refs_ = new (std::nothrow) RefCounter();", "description": "内存/对象分配给 refs_ 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "base/src/refbase.cpp", "line": 519, "evidence": "refs_ = new (std::nothrow) RefCounter();", "description": "内存/对象分配给 refs_ 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 42, "evidence": "refCounter_->IncRefCount();", "description": "可能对指针 refCounter_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 49, "evidence": "refCounter_->DecRefCount();", "description": "可能对指针 refCounter_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 60, "evidence": "if ((cookie_ != nullptr) && (!refCounter_->IsRefPtrValid())) {", "description": "可能对指针 refCounter_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 69, "evidence": "refCounter_->IncWeakRefCount(objectId);", "description": "可能对指针 refCounter_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 76, "evidence": "refCounter_->DecWeakRefCount(objectId);", "description": "可能对指针 refCounter_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 84, "evidence": "return refCounter_->AttemptIncStrongRef(objectId, unuse);", "description": "可能对指针 refCounter_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 475, "evidence": "refs_->IncRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 476, "evidence": "refs_->SetCallback([this] { this->RefPtrCallback(); });", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 478, "evidence": "refs_->SetCanPromote([this] { return this->CanPromote(); });", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 486, "evidence": "refs_->IncRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 487, "evidence": "refs_->SetCallback([this] { this->RefPtrCallback(); });", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 489, "evidence": "refs_->SetCanPromote([this] { return this->CanPromote(); });", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 515, "evidence": "refs_->RemoveCallback();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 516, "evidence": "refs_->DecRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 521, "evidence": "refs_->IncRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 522, "evidence": "refs_->SetCallback([this] { this->RefPtrCallback(); });", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 524, "evidence": "refs_->SetCanPromote([this] { return this->CanPromote(); });", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 544, "evidence": "refs_->RemoveCallback();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 545, "evidence": "refs_->DecRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 556, "evidence": "refs_->RemoveCallback();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 557, "evidence": "if ((refs_->IsLifeTimeExtended() && refs_->GetWeakRefCount() == 0) ||", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 558, "evidence": "refs_->GetStrongRefCount() == INITIAL_PRIMARY_VALUE) {", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 559, "evidence": "refs_->DecRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 567, "evidence": "refs_->ExtendObjectLifetime();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 577, "evidence": "const int curCount = refs_->IncStrongRefCount(objectId);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 578, "evidence": "if (!refs_->IsLifeTimeExtended() && curCount == 0) {", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 588, "evidence": "if (refs_->IsAttemptAcquireSet()) {", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 589, "evidence": "refs_->ClearAttemptAcquire();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 590, "evidence": "const int attemptCount = refs_->GetAttemptAcquire();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 595, "evidence": "refs_->DecStrongRefCount(objectId);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 596, "evidence": "refs_->DecWeakRefCount(objectId);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 607, "evidence": "const int curCount = refs->DecStrongRefCount(objectId);", "description": "可能对指针 refs 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 614, "evidence": "if (!refs->IsLifeTimeExtended()) {", "description": "可能对指针 refs 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 615, "evidence": "if (refs->callback_) {", "description": "可能对指针 refs 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 616, "evidence": "refs->callback_();", "description": "可能对指针 refs 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 621, "evidence": "refs->DecWeakRefCount(objectId);", "description": "可能对指针 refs 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 629, "evidence": "return refs_->GetStrongRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 643, "evidence": "refs_->IncWeakRefCount(objectId);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 655, "evidence": "refs_->DecWeakRefCount(objectId);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 664, "evidence": "return refs_->GetWeakRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 674, "evidence": "if (refs_->AttemptIncStrongRef(objectId, count)) {", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 675, "evidence": "refs_->SetAttemptAcquire();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 689, "evidence": "bool ret = refs_->AttemptIncStrongRef(objectId, count);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 704, "evidence": "if (refs_->AttemptIncStrong(objectId)) {", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 705, "evidence": "refs_->SetAttemptAcquire();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 716, "evidence": "return refs_->IsAttemptAcquireSet();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 724, "evidence": "return refs_->IsLifeTimeExtended();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 744, "evidence": "refs_->EnableTracker();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/refbase.cpp", "line": 755, "evidence": "refs_->EnableTrackerWithDomainId(domainId);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 41, "evidence": "reactor_->SwitchOn();", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 55, "evidence": "reactor_->SwitchOff();", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 62, "evidence": "uint32_t ret = reactor_->ScheduleTimer([](int unused) {", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 100, "evidence": "entry->timerId = timerId++;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 101, "evidence": "entry->interval = interval;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 102, "evidence": "entry->callback = callback;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 103, "evidence": "entry->once = once;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 104, "evidence": "entry->timerFd = timerFd;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 107, "evidence": "timerToEntries_[entry->timerId] = entry;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 109, "evidence": "UTILS_LOGD(\"                                                      \", entry->timerId, entry->interval);", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 110, "evidence": "return entry->timerId;", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 122, "evidence": "UTILS_LOGD(\"                                                       \", timerId, entry->interval);", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 124, "evidence": "auto itor = intervalToTimers_[entry->interval].begin();", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 125, "evidence": "for (; itor != intervalToTimers_[entry->interval].end(); ++itor) {", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 126, "evidence": "if ((*itor)->timerId == timerId) {", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 128, "evidence": "if ((*itor)->once) {", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 129, "evidence": "reactor_->CancelTimer((*itor)->timerFd);", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 129, "evidence": "reactor_->CancelTimer((*itor)->timerFd);", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 130, "evidence": "timers_.erase((*itor)->timerFd);", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 132, "evidence": "intervalToTimers_[entry->interval].erase(itor);", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 137, "evidence": "if (intervalToTimers_[entry->interval].empty()) {", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 138, "evidence": "UTILS_LOGD(\"                                      \", entry->interval);", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 139, "evidence": "intervalToTimers_.erase(entry->interval);", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 140, "evidence": "DoUnregister(entry->interval);", "description": "可能对指针 entry 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 148, "evidence": "if (reactor_->SetUp() == TIMER_ERR_OK) {", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 149, "evidence": "reactor_->RunLoop(timeoutMs_);", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 151, "evidence": "reactor_->CleanUp();", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 157, "evidence": "uint32_t ret = reactor_->ScheduleTimer(cb, interval, timerFd, once);", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 170, "evidence": "reactor_->CancelTimer(itor.first);", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 187, "evidence": "if (ptr->timerFd != timerFd) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 191, "evidence": "if (reactor_->IsLoopReady() && reactor_->IsSwitchedOn()) {", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 192, "evidence": "ptr->callback();", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 195, "evidence": "if (!ptr->once) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 198, "evidence": "onceIdsUnused.push_back(ptr->timerId);", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 230, "evidence": "if (!ptr->once) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 231, "evidence": "return ptr->timerFd;", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 242, "evidence": "uint32_t id = (*itor)->timerId;", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 248, "evidence": "reactor_->CancelTimer((*itor)->timerFd);", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 248, "evidence": "reactor_->CancelTimer((*itor)->timerFd);", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/timer.cpp", "line": 249, "evidence": "timers_.erase((*itor)->timerFd);", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 36, "evidence": "if ((handler != nullptr) && (handler->GetEventReactor() == this) && (demultiplexer_ != nullptr)) {", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 37, "evidence": "if (demultiplexer_->UpdateEventHandler(handler) != 0) {", "description": "可能对指针 demultiplexer_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 49, "evidence": "uint32_t ret = demultiplexer_->StartUp();", "description": "可能对指针 demultiplexer_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 63, "evidence": "itor->Uninitialize();", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 74, "evidence": "std::vector<epoll_event> epollEvents(demultiplexer_->GetMaxEvents());", "description": "可能对指针 demultiplexer_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 76, "evidence": "if (demultiplexer_->Polling(timeout, epollEvents) == EPOLL_CRITICAL_ERROR) {", "description": "可能对指针 demultiplexer_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 99, "evidence": "handler->SetTimerCallback(cb);", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 100, "evidence": "uint32_t ret = handler->Initialize();", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 106, "evidence": "timerFd = handler->GetHandle();", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 117, "evidence": "if ((*itor)->GetHandle() == timerFd) {", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_reactor.cpp", "line": 118, "evidence": "(*itor)->Uninitialize();", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/file_ex.cpp", "line": 204, "evidence": "file.open(filePath.c_str(), ios::out | ios::trunc);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/file_ex.cpp", "line": 206, "evidence": "file.open(filePath.c_str(), ios::out | ios::app);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/file_ex.cpp", "line": 269, "evidence": "fclose(fp);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/file_ex.cpp", "line": 280, "evidence": "fclose(fp);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/file_ex.cpp", "line": 319, "evidence": "file.read(&content[0], fileLength);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/file_ex.cpp", "line": 339, "evidence": "file.write(&content[0], content.size());", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "base/src/file_ex.cpp", "line": 130, "evidence": "char fileName[PATH_MAX + 1] = {0};", "description": "string fileName 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "base/src/file_ex.cpp", "line": 137, "evidence": "fileName[ret] = '\\ ';", "description": "string fileName 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/timer_event_handler.cpp", "line": 41, "evidence": "close(GetHandle());", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 128, "evidence": "if (((*str16 & 0xFC00) == 0xD800) && ((str16 + 1) < str16End)", "description": "可能对指针 str16 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 135, "evidence": "charLen = Utf32CodePointUtf8Length(static_cast<char32_t>(*str16++));", "description": "可能对指针 str16 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 155, "evidence": "if (((*curUtf16 & 0xFC00) == 0xD800) && ((curUtf16 + 1) < endUtf16)", "description": "可能对指针 curUtf16 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 157, "evidence": "utf32 = (*curUtf16++ - 0xD800) << STR16_TO_STR8_SHIFT_WIDTH;", "description": "可能对指针 curUtf16 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 158, "evidence": "utf32 |= *curUtf16++ - 0xDC00;", "description": "可能对指针 curUtf16 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 161, "evidence": "utf32 = static_cast<char32_t>(*curUtf16++);", "description": "可能对指针 curUtf16 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 172, "evidence": "*cur = '\\ ';", "description": "可能对指针 cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 229, "evidence": "*codePoint <<= UTF8_SHIFT_WIDTH;", "description": "可能对指针 codePoint 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 230, "evidence": "*codePoint |= 0x3F & byte;", "description": "可能对指针 codePoint 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 300, "evidence": "*u16cur++ = static_cast<char16_t>(codepoint);", "description": "可能对指针 u16cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 304, "evidence": "*u16cur++ = static_cast<char16_t>((codepoint >> UTF16_SHIFT_WIDTH) + 0xD800);", "description": "可能对指针 u16cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 309, "evidence": "*u16cur++ = static_cast<char16_t>((codepoint & 0x3FF) + 0xDC00);", "description": "可能对指针 u16cur 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/unicode_ex.cpp", "line": 320, "evidence": "*result = 0;", "description": "可能对指针 result 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/unicode_ex.cpp", "line": 168, "evidence": "Utf32CodePointToUtf8(reinterpret_cast<uint8_t*>(cur), utf32, len);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/unicode_ex.cpp", "line": 186, "evidence": "str8 = reinterpret_cast<char*>(calloc(utf8Len, sizeof(char)));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/unicode_ex.cpp", "line": 336, "evidence": "str16 = reinterpret_cast<char16_t*>(calloc(utf16Len, sizeof(char16_t)));", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_handler.cpp", "line": 51, "evidence": "reactor_->UpdateEventHandler(this);", "description": "可能对指针 reactor_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "vla_usage", "file": "base/src/io_event_epoll.cpp", "line": 103, "evidence": "struct epoll_event epollEvents[maxEvents_];", "description": "检测到可变长度数组（VLA），在栈上进行不定大小分配，可能导致栈溢出/不可控内存使用。", "suggestion": "避免 VLA；改用堆分配并进行上界校验，或使用固定上界的静态分配。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/observer.cpp", "line": 78, "evidence": "o->Update(this, arg);", "description": "可能对指针 o 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "base/src/thread_ex.cpp", "line": 66, "evidence": "auto t = new ThreadParam;", "description": "内存/对象分配给 t 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "resource_leak", "pattern": "thread_leak_no_join", "file": "base/src/thread_ex.cpp", "line": 81, "evidence": "int result = pthread_create(&thread, &attr, reinterpret_cast<PThreadRoutine>(para.startRoutine), para.args);", "description": "pthread_create 创建线程 thread 后的邻近窗口内未检测到 join/detach，可能导致线程泄漏或资源占用。", "suggestion": "确保创建的线程被显式 join 或 detach；遵循统一的线程生命周期管理策略。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 38, "evidence": "ThreadFunc f = t->startRoutine;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 39, "evidence": "void* userData = t->args;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 40, "evidence": "int prio = t->priority;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 41, "evidence": "std::string threadName = t->name;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 67, "evidence": "t->startRoutine = para.startRoutine;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 68, "evidence": "t->args = para.args;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 69, "evidence": "t->priority = para.priority;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 70, "evidence": "t->name = para.name;", "description": "可能对指针 t 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 90, "evidence": "*threadId = thread;", "description": "可能对指针 threadId 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 187, "evidence": "if (self->ReadyToWork() && !self->IsExitPending()) {", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 188, "evidence": "result = self->Run();", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 191, "evidence": "result = self->Run();", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 195, "evidence": "std::unique_lock<std::mutex> lk(self->lock_);", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 196, "evidence": "if ((!result) || self->exitPending_) {", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 197, "evidence": "self->exitPending_ = true;", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 198, "evidence": "self->running_ = false;", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 199, "evidence": "self->thread_ = INVALID_PTHREAD_T;", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/thread_ex.cpp", "line": 200, "evidence": "self->cvThreadExited_.notify_all();", "description": "可能对指针 self 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/thread_ex.cpp", "line": 72, "evidence": "para.startRoutine = reinterpret_cast<ThreadFunc>(&ThreadParam::Proxy);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/thread_ex.cpp", "line": 81, "evidence": "int result = pthread_create(&thread, &attr, reinterpret_cast<PThreadRoutine>(para.startRoutine), para.args);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/event_demultiplexer.cpp", "line": 58, "evidence": "close(epollFd_);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 70, "evidence": "auto itor = eventHandlers_.find(handler->GetHandle());", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 72, "evidence": "eventHandlers_.insert(std::make_pair(handler->GetHandle(), handler->shared_from_this()));", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 76, "evidence": "if (handler->Events() == EventReactor::NONE_EVENT) {", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 81, "evidence": "if (handler != itor->second.get()) {", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 91, "evidence": "event.events   = Reactor2Epoll(handler->Events());", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 92, "evidence": "event.data.fd = handler->GetHandle();", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 94, "evidence": "if (epoll_ctl(epollFd_, operation, handler->GetHandle(), &event) != 0) {", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 96, "evidence": "epollFd_, operation, handler->GetHandle(), errno);", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 99, "evidence": "epollCtlErrQueue_.push(std::make_tuple(operation, errno, handler->GetHandle()));", "description": "可能对指针 handler 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/event_demultiplexer.cpp", "line": 135, "evidence": "taskQue.emplace_back(itor->second);", "description": "可能对指针 itor 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/ashmem.cpp", "line": 70, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/ashmem.cpp", "line": 76, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/ashmem.cpp", "line": 109, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/ashmem.cpp", "line": 116, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/ashmem.cpp", "line": 124, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/ashmem.cpp", "line": 189, "evidence": "::close(memoryFd_);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "pthread_ret_unchecked", "file": "base/src/ashmem.cpp", "line": 84, "evidence": "pthread_mutex_lock(&g_ashmemLock);", "description": "pthread 接口返回值可能未检查，错误处理缺失可能导致死锁/资源泄漏。", "suggestion": "检查 pthread 接口返回码并进行错误路径处理；必要时记录日志与清理资源。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/ashmem.cpp", "line": 261, "evidence": "auto tmpData = reinterpret_cast<char *>(startAddr_);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/ashmem.cpp", "line": 262, "evidence": "int ret = memcpy_s(tmpData + offset, memorySize_ - offset, reinterpret_cast<const char *>(data), size);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/src/ashmem.cpp", "line": 282, "evidence": "return reinterpret_cast<const char *>(startAddr_) + offset;", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/directory_ex.cpp", "line": 193, "evidence": "close(subFd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/directory_ex.cpp", "line": 276, "evidence": "close(subFd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/src/directory_ex.cpp", "line": 356, "evidence": "close(subFd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 176, "evidence": "string name = ptr->d_name;", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 180, "evidence": "if (ptr->d_type == DT_DIR) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 261, "evidence": "const char *name = ptr->d_name;", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 267, "evidence": "if (ptr->d_type == DT_DIR) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 340, "evidence": "const char *name = ptr->d_name;", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 347, "evidence": "if (ptr->d_type == DT_DIR) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 469, "evidence": "if (strcmp(ptr->d_name, \" \") == 0 || strcmp(ptr->d_name, \"  \") == 0) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 472, "evidence": "subPath = IncludeTrailingPathDelimiter(path) + string(ptr->d_name);", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/src/directory_ex.cpp", "line": 473, "evidence": "if (ptr->d_type == DT_DIR) {", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "base/src/directory_ex.cpp", "line": 230, "evidence": "char name[256];", "description": "string name 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "string_bounds_check", "file": "base/src/directory_ex.cpp", "line": 508, "evidence": "char tmpPath[PATH_MAX] = {0};", "description": "string tmpPath 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "base/include/refbase.h", "line": 895, "evidence": "T *ptr = new T(std::forward<Args>(args)...);", "description": "内存/对象分配给 ptr 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.8, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 775, "evidence": "inline T *operator->() const", "description": "可能对指针 operator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 898, "evidence": "ptr->IncStrongRef(ptr);", "description": "可能对指针 ptr 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 919, "evidence": "refs_->IncStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 928, "evidence": "refs_->IncStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 943, "evidence": "refs_->DecStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 955, "evidence": "refs_->IncStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 963, "evidence": "other->IncStrongRef(this);", "description": "可能对指针 other 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 967, "evidence": "refs_->DecStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 979, "evidence": "otherRef->IncStrongRef(this);", "description": "可能对指针 otherRef 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 983, "evidence": "refs_->DecStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 994, "evidence": "refs_->DecStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1011, "evidence": "otherRef->IncStrongRef(this);", "description": "可能对指针 otherRef 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1015, "evidence": "refs_->DecStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1053, "evidence": "refs_->DecStrongRef(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1060, "evidence": "if ((p != nullptr) && p->AttemptIncStrongRef(this)) {", "description": "可能对指针 p 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1061, "evidence": "refs_ = reinterpret_cast<T *>(p->GetRefPtr());", "description": "可能对指针 p 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1234, "evidence": "inline T *operator->() const", "description": "可能对指针 operator 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1236, "evidence": "return reinterpret_cast<T *>(refs_->GetRefPtr());", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1315, "evidence": "return refs_->GetWeakRefCount();", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1327, "evidence": "return refs_->AttemptIncStrongRef(objectId);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1350, "evidence": "return (refs_ != nullptr) ? reinterpret_cast<T *>(refs_->GetRefPtr()) : nullptr;", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1363, "evidence": "refs_ = other->CreateWeakRef(other);", "description": "可能对指针 other 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1365, "evidence": "refs_->IncWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1377, "evidence": "refs_->IncWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1385, "evidence": "refs_ = other->CreateWeakRef(other.GetRefPtr());", "description": "可能对指针 other 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1387, "evidence": "refs_->IncWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1398, "evidence": "refs_->IncWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1407, "evidence": "refs_ = other->CreateWeakRef(other.GetRefPtr());", "description": "可能对指针 other 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1409, "evidence": "refs_->IncWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1419, "evidence": "newWeakRef = other->CreateWeakRef(other);", "description": "可能对指针 other 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1421, "evidence": "newWeakRef->IncWeakRefCount(this);", "description": "可能对指针 newWeakRef 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1426, "evidence": "refs_->DecWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1440, "evidence": "newWeakRef = object->CreateWeakRef(object);", "description": "可能对指针 object 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1442, "evidence": "newWeakRef->IncWeakRefCount(this);", "description": "可能对指针 newWeakRef 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1447, "evidence": "refs_->DecWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1458, "evidence": "other.refs_->IncWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1462, "evidence": "refs_->DecWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1474, "evidence": "newWeakRef = other->CreateWeakRef(other.GetRefPtr());", "description": "可能对指针 other 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1476, "evidence": "newWeakRef->IncWeakRefCount(this);", "description": "可能对指针 newWeakRef 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1481, "evidence": "refs_->DecWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1493, "evidence": "other.refs_->IncWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1497, "evidence": "refs_->DecWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1510, "evidence": "newWeakRef = other->CreateWeakRef(other.GetRefPtr());", "description": "可能对指针 other 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1512, "evidence": "newWeakRef->IncWeakRefCount(this);", "description": "可能对指针 newWeakRef 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1517, "evidence": "refs_->DecWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/refbase.h", "line": 1552, "evidence": "refs_->DecWeakRefCount(this);", "description": "可能对指针 refs_ 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/include/refbase.h", "line": 1061, "evidence": "refs_ = reinterpret_cast<T *>(p->GetRefPtr());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/include/refbase.h", "line": 1236, "evidence": "return reinterpret_cast<T *>(refs_->GetRefPtr());", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/include/refbase.h", "line": 1350, "evidence": "return (refs_ != nullptr) ? reinterpret_cast<T *>(refs_->GetRefPtr()) : nullptr;", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "type_safety", "pattern": "reinterpret_cast_unsafe", "file": "base/include/refbase.h", "line": 1437, "evidence": "T *object = reinterpret_cast<T *>(other);", "description": "使用 reinterpret_cast 进行类型转换，可能导致未定义行为或类型安全问题。", "suggestion": "优先使用 static_cast 或 dynamic_cast；若必须使用 reinterpret_cast，需确保类型布局兼容并添加详细注释说明。", "confidence": 0.7999999999999999, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/safe_queue.h", "line": 55, "evidence": "if (*iter == object) {", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/include/unique_fd.h", "line": 53, "evidence": "close(fd);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "error_handling", "pattern": "io_call", "file": "base/include/unique_fd.h", "line": 284, "evidence": "Deleter::Close(fd_);", "description": "I/O/系统调用可能未检查返回值，存在错误处理缺失风险。", "suggestion": "检查返回值/errno；在错误路径上释放资源（句柄/内存/锁）。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "wild_pointer_deref", "file": "base/include/ashmem.h", "line": 237, "evidence": "void *startAddr_;", "description": "指针 startAddr_ 声明后未见初始化即被解引用，可能为野指针使用。", "suggestion": "在声明后立即将指针初始化为 NULL，并在使用前进行显式赋值与有效性校验。", "confidence": 0.65, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/parcel.h", "line": 725, "evidence": "bool WriteVector(const std::vector<T1> &val, bool (Parcel::*Write)(T2));", "description": "可能对指针 Write 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/parcel.h", "line": 727, "evidence": "bool WriteFixedAlignVector(const std::vector<T1> &originVal, bool (Parcel::*SpecialWrite)(T2));", "description": "可能对指针 SpecialWrite 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/parcel.h", "line": 753, "evidence": "bool ReadVector(std::vector<T> *val, bool (Parcel::*Read)(T &));", "description": "可能对指针 Read 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/parcel.h", "line": 755, "evidence": "bool ReadFixedAlignVector(std::vector<T1> *val, bool (Parcel::*SpecialRead)(T2 &));", "description": "可能对指针 SpecialRead 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "vla_usage", "file": "base/include/sorted_vector.h", "line": 152, "evidence": "inline const TYPE& operator[](size_t index) const { return vec_[index]; }", "description": "检测到可变长度数组（VLA），在栈上进行不定大小分配，可能导致栈溢出/不可控内存使用。", "suggestion": "避免 VLA；改用堆分配并进行上界校验，或使用固定上界的静态分配。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/sorted_vector.h", "line": 350, "evidence": "if (it == vec_.end() || !(*it == item)) {", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "base/include/sorted_vector.h", "line": 152, "evidence": "inline const TYPE& operator[](size_t index) const { return vec_[index]; }", "description": "vector vec_ 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "buffer_overflow", "pattern": "vector_bounds_check", "file": "base/include/sorted_vector.h", "line": 209, "evidence": "return vec_[index];", "description": "vector vec_ 使用 [] 访问可能越界，建议使用 .at() 进行边界检查。", "suggestion": "使用 .at() 方法进行安全访问，或在使用 [] 前显式检查索引范围。", "confidence": 0.6, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "alloc_no_null_check", "file": "base/include/singleton.h", "line": 183, "evidence": "instance_ = new T();", "description": "内存/对象分配给 instance_ 后可能未检查是否成功（NULL 检查缺失）。", "suggestion": "在使用前检查分配结果是否为 NULL，并在错误路径上释放已获取的资源。", "confidence": 0.65, "severity": "medium"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/safe_map.h", "line": 144, "evidence": "value = iter->second;", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/safe_map.h", "line": 167, "evidence": "oldValue = iter->second;", "description": "可能对指针 iter 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "possible_null_deref", "file": "base/include/safe_map.h", "line": 211, "evidence": "callback(it -> first, it -> second);", "description": "可能对指针 it 进行了解引用，但附近未见 NULL 检查，存在空指针解引用风险。", "suggestion": "在使用指针前执行 NULL 判定；确保所有返回/赋值路径均进行了合法性检查。", "confidence": 0.6, "severity": "high"}
{"language": "c/cpp", "category": "memory_mgmt", "pattern": "move_after_use", "file": "base/include/safe_map.h", "line": 54, "evidence": "return map_[key];", "description": "变量 map_ 在 std::move 后仍被使用，移动后的对象处于有效但未指定状态，可能导致未定义行为。", "suggestion": "移动后的对象不应再使用，除非重新赋值；考虑使用移动语义后立即停止使用该对象。", "confidence": 0.7, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/file_ex.rs", "line": 21, "evidence": "unsafe extern \"   \" {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 33, "evidence": "unsafe extern \"   \" {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 40, "evidence": "pub unsafe fn CreateAshmemStd(name: *const c_char, size: i32) -> SharedPtr<Ashmem>;", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 52, "evidence": "pub unsafe fn AsVoidPtr(inPtr: *const c_char) -> *const c_void;", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 56, "evidence": "pub unsafe fn AsCharPtr(inPtr: *const c_void) -> *const c_char;", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 90, "evidence": "pub unsafe fn WriteToAshmem(", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 101, "evidence": "pub unsafe fn ReadFromAshmem(self: &Ashmem, size: i32, offset: i32) -> *const c_void;", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 168, "evidence": "pub unsafe fn write_to_ashmem(&self, data: *const c_char, size: i32, offset: i32) -> bool {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 177, "evidence": "pub unsafe fn c_ashmem(&self) -> &SharedPtr<ffi::Ashmem> {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 184, "evidence": "pub unsafe fn read_from_ashmem(&self, size: i32, offset: i32) -> *const c_char {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/ashmem.rs", "line": 193, "evidence": "pub unsafe fn create_ashmem_instance(name: &str, size: i32) -> Option<Ashmem> {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "base/src/rust/ashmem.rs", "line": 40, "evidence": "pub unsafe fn CreateAshmemStd(name: *const c_char, size: i32) -> SharedPtr<Ashmem>;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "base/src/rust/ashmem.rs", "line": 52, "evidence": "pub unsafe fn AsVoidPtr(inPtr: *const c_char) -> *const c_void;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "base/src/rust/ashmem.rs", "line": 56, "evidence": "pub unsafe fn AsCharPtr(inPtr: *const c_void) -> *const c_char;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "base/src/rust/ashmem.rs", "line": 92, "evidence": "data: *const c_void,", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "base/src/rust/ashmem.rs", "line": 101, "evidence": "pub unsafe fn ReadFromAshmem(self: &Ashmem, size: i32, offset: i32) -> *const c_void;", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "base/src/rust/ashmem.rs", "line": 168, "evidence": "pub unsafe fn write_to_ashmem(&self, data: *const c_char, size: i32, offset: i32) -> bool {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "raw_pointer", "file": "base/src/rust/ashmem.rs", "line": 184, "evidence": "pub unsafe fn read_from_ashmem(&self, size: i32, offset: i32) -> *const c_char {", "description": "出现原始指针（*mut/*const），可能绕过借用/生命周期检查，带来未定义行为风险。", "suggestion": "优先使用引用/智能指针；必须使用原始指针时，严格证明无别名、对齐与生命周期安全。", "confidence": 0.75, "severity": "medium"}
{"language": "rust", "category": "error_handling", "pattern": "unwrap/expect", "file": "base/src/rust/ashmem.rs", "line": 194, "evidence": "let c_name = CString::new(name).expect(\"                    \");", "description": "直接 unwrap/expect 可能在错误条件下 panic，缺少健壮的错误处理路径。", "suggestion": "使用 ? 传播错误或 match 显式处理；为关键路径提供错误上下文与恢复策略。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "base/src/rust/ashmem.rs", "line": 16, "evidence": "use std::ffi::{c_char, CString};", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "ffi", "pattern": "CString/CStr", "file": "base/src/rust/ashmem.rs", "line": 194, "evidence": "let c_name = CString::new(name).expect(\"                    \");", "description": "FFI 中使用 CString/CStr 需要确保正确的生命周期管理与空字节处理。", "suggestion": "确保 CString 生命周期覆盖 FFI 调用期间；注意 CStr 不能包含内部空字节。", "confidence": 0.65, "severity": "medium"}
{"language": "rust", "category": "unsafe_usage", "pattern": "unsafe", "file": "base/src/rust/directory_ex.rs", "line": 45, "evidence": "unsafe extern \"   \" {", "description": "存在 unsafe 代码块/标识，需证明内存/别名/生命周期安全性。", "suggestion": "将不安全操作封装在最小作用域内，并提供 SAFETY 注释说明前置条件与不变式。", "confidence": 0.8, "severity": "high"}
