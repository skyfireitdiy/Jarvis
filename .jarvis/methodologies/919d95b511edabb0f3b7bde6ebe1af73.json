{
  "problem_type": "c_checker_rules测试编写",
  "content": "为c_checker_rules.py编写完整的单元测试，覆盖9个规则类的所有78个规则。\n\n## 测试结构\n\n### BaseRules测试\n- RE_UNSAFE_API: 测试strcpy/strcat/gets/sprintf/vsprintf匹配\n- RE_BOUNDARY_FUNCS: 测试memcpy/memmove/strncpy/strncat匹配\n- RE_MEM_MGMT: 测试malloc/calloc/realloc/free/new/delete匹配\n- RE_IO_API: 测试fopen/fclose/fread/fwrite/read/write/open/close匹配\n\n### FormatCommandRules测试\n- RE_PRINTF_LIKE: 测试printf/sprintf/snprintf/vsprintf/vsnprintf匹配\n- RE_FPRINTF: 测试fprintf匹配\n- RE_INSECURE_TMP: 测试tmpnam/tempnam/mktemp匹配\n- RE_SYSTEM_LIKE: 测试system/popen匹配\n- RE_EXEC_LIKE: 测试execvp/execlp等exec系列匹配\n- RE_SCANF_CALL: 测试scanf/sscanf/fscanf匹配\n\n### ThreadRules测试\n- RE_PTHREAD_LOCK: 测试pthread_mutex_lock匹配\n- RE_PTHREAD_UNLOCK: 测试pthread_mutex_unlock匹配\n- RE_PTHREAD_RET: 测试pthread返回函数匹配\n- RE_PTHREAD_COND_WAIT: 测试pthread_cond_wait匹配\n- RE_PTHREAD_CREATE: 测试pthread_create匹配\n- RE_PTHREAD_JOIN: 测试pthread_join匹配\n- RE_PTHREAD_DETACH: 测试pthread_detach匹配\n\n### CppLockRules测试\n- RE_STD_MUTEX: 测试std::mutex匹配\n- RE_MUTEX_LOCK: 测试mutex.lock()匹配\n- RE_MUTEX_UNLOCK: 测试mutex.unlock()匹配\n- RE_MUTEX_TRY_LOCK: 测试mutex.try_lock()匹配\n- RE_LOCK_GUARD: 测试std::lock_guard匹配\n- RE_UNIQUE_LOCK: 测试std::unique_lock匹配\n- RE_SHARED_LOCK: 测试std::shared_lock匹配\n- RE_STD_LOCK: 测试std::lock匹配\n\n### DataRaceRules测试\n- RE_STATIC_VAR: 测试静态变量匹配\n- RE_EXTERN_VAR: 测试extern变量匹配\n- RE_STD_THREAD: 测试std::thread匹配\n- RE_ATOMIC: 测试std::atomic匹配\n- RE_VOLATILE: 测试volatile匹配\n\n### DangerousUsageRules测试\n- RE_ATOI_FAMILY: 测试atoi/atol/atoll/atof匹配\n- RE_RAND: 测试rand/srand匹配\n- RE_STRTOK: 测试strtok匹配\n- RE_OPEN_PERMISSIVE: 测试open权限匹配\n- RE_FOPEN_MODE: 测试fopen模式匹配\n- RE_VAR_ACCESS: 测试变量访问匹配\n- RE_VAR_ASSIGN: 测试变量赋值匹配\n\n### MemoryHelperRules测试\n- RE_REALLOC_ASSIGN_BACK: 测试realloc回赋匹配\n- RE_MALLOC_ASSIGN: 测试malloc赋值匹配\n- RE_CALLOC_ASSIGN: 测试calloc赋值匹配\n- RE_NEW_ASSIGN: 测试new赋值匹配\n- RE_DEREF: 测试解引用匹配\n- RE_NULL_CHECK: 测试NULL检查匹配\n- RE_FREE_VAR: 测试free变量匹配\n- RE_USE_VAR: 测试变量使用匹配\n- RE_STRLEN_IN_SIZE: 测试strlen在大小参数中匹配\n- RE_SIZEOF_PTR: 测试sizeof(*ptr)匹配\n- RE_STRNCPY: 测试strncpy匹配\n- RE_STRNCAT: 测试strncat匹配\n\n### CppSpecificRules测试\n- RE_SHARED_PTR: 测试shared_ptr匹配\n- RE_UNIQUE_PTR: 测试unique_ptr匹配\n- RE_WEAK_PTR: 测试weak_ptr匹配\n- RE_SMART_PTR_ASSIGN: 测试智能指针赋值匹配\n- RE_NEW_ARRAY: 测试new[]匹配\n- RE_DELETE_ARRAY: 测试delete[]匹配\n- RE_DELETE: 测试delete匹配\n- RE_STATIC_CAST: 测试static_cast匹配\n- RE_DYNAMIC_CAST: 测试dynamic_cast匹配\n- RE_REINTERPRET_CAST: 测试reinterpret_cast匹配\n- RE_CONST_CAST: 测试const_cast匹配\n- RE_VECTOR_ACCESS: 测试vector访问匹配\n- RE_STRING_ACCESS: 测试string访问匹配\n- RE_VECTOR_VAR: 测试vector变量匹配\n- RE_STRING_VAR: 测试string变量匹配\n- RE_AT_METHOD: 测试.at()方法匹配\n- RE_VIRTUAL_DTOR: 测试虚析构函数匹配\n- RE_CLASS_DECL: 测试class声明匹配\n- RE_DTOR_DECL: 测试析构函数声明匹配\n- RE_MOVE: 测试std::move匹配\n- RE_MOVE_ASSIGN: 测试移动赋值匹配\n- RE_THROW: 测试throw匹配\n- RE_TRY: 测试try匹配\n- RE_CATCH: 测试catch匹配\n- RE_NOEXCEPT: 测试noexcept匹配\n\n### HelperRules测试\n- RE_GENERIC_ASSIGN: 测试通用赋值匹配\n- RE_ALLOCA: 测试alloca匹配\n- RE_VLA_DECL: 测试VLA声明匹配\n- RE_INET_LEGACY: 测试旧网络API匹配\n- RE_TIME_UNSAFE: 测试不安全时间API匹配\n- RE_GETENV: 测试getenv匹配\n\n## 验证标准\n1. 测试文件tests/jarvis_sec/test_c_checker_rules.py已创建\n2. 包含所有78个规则的测试用例\n3. 每个测试验证规则对象存在且是re.Pattern类型\n4. 每个测试验证规则能正确匹配预期的代码片段",
  "scope": "project"
}
