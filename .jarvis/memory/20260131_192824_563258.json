{
  "id": "20260131_192824_563258",
  "type": "project_long_term",
  "tags": ["evolution", "phase2", "methodology", "自动提取", "算法设计"],
  "content": "## 经验自动提取算法设计文档\n\n### 1. 设计目标\n\n将现有的被动式方法论生成（依赖用户确认和LLM判断）升级为智能自动提取系统，能够：\n- 自动识别值得提取的任务\n- 自动生成高质量的方法论\n- 自动评估和去重\n\n### 2. 触发条件设计\n\n**自动触发条件**（满足任一即触发）：\n1. **任务复杂度**：任务执行步骤≥5步\n2. **工具调用数**：工具调用次数≥3次\n3. **执行时间**：任务执行时间≥5分钟\n4. **用户满意度**：用户明确表示满意\n5. **任务类型**：涉及代码重构、架构设计、问题排查等高价值任务\n\n**排除条件**（满足任一则不触发）：\n1. 简单查询任务（单次工具调用）\n2. 失败的任务\n3. 已有高度相似的方法论\n\n### 3. 提取内容设计\n\n**从任务执行中提取**：\n```python\n@dataclass\nclass TaskExecutionContext:\n    user_input: str           # 用户原始输入\n    task_steps: List[str]     # 执行步骤列表\n    tool_calls: List[dict]    # 工具调用记录\n    decisions: List[str]      # 关键决策点\n    errors: List[str]         # 遇到的错误\n    solutions: List[str]      # 解决方案\n    duration: float           # 执行时长\n    success: bool             # 是否成功\n```\n\n### 4. 方法论生成模板\n\n```markdown\n# {problem_type}方法论\n\n## 规则简介\n{根据任务描述生成的简介}\n\n## 你必须遵守的原则\n{从执行过程中提取的关键原则}\n\n## 你必须执行的操作\n{从执行步骤中提取的操作流程}\n\n## 实践指导\n{从工具调用和决策中提取的实践建议}\n\n## 检查清单\n{从验证步骤中提取的检查项}\n```\n\n### 5. 质量评估标准\n\n**评分维度**（满分100分）：\n1. **完整性**（30分）：是否包含所有必要章节\n2. **可执行性**（30分）：步骤是否清晰可执行\n3. **通用性**（20分）：是否适用于类似问题\n4. **独特性**（20分）：与现有方法论的差异度\n\n**质量阈值**：≥70分才保存\n\n### 6. 去重机制\n\n**相似度计算**：\n1. problem_type的语义相似度\n2. 执行步骤的重叠度\n3. 工具调用模式的相似度\n\n**去重策略**：\n- 相似度≥80%：更新现有方法论\n- 相似度60-80%：询问用户是否合并\n- 相似度<60%：创建新方法论\n\n### 7. 集成方案\n\n**集成点**：\n1. 在`TaskAnalyzer._on_task_completed`中添加自动提取逻辑\n2. 复用现有`methodology`工具的add接口\n3. 复用现有JSON存储格式\n\n**新增模块**：\n```\nsrc/jarvis/jarvis_methodology_generator/\n├── __init__.py\n├── methodology_generator.py    # 主生成器\n├── task_context_extractor.py   # 任务上下文提取\n├── quality_evaluator.py        # 质量评估\n└── deduplicator.py             # 去重处理\n```\n\n### 8. 实现计划\n\n1. **Phase 1**：实现TaskContextExtractor，从Agent获取执行上下文\n2. **Phase 2**：实现MethodologyGenerator，使用LLM生成方法论\n3. **Phase 3**：实现QualityEvaluator，评估生成质量\n4. **Phase 4**：实现Deduplicator，处理重复检测\n5. **Phase 5**：集成到TaskAnalyzer，实现自动触发",
  "created_at": "2026-01-31T19:28:24.563279",
  "updated_at": "2026-01-31T19:28:24.563282"
}
