{
  "id": "20260118_161543_939050",
  "type": "project_long_term",
  "tags": ["context_optimization", "上下文管理", "压缩策略", "token管理"],
  "content": "Jarvis Agent的上下文压缩和管理策略包括：\n\n1. Token限制检测：在AgentRunLoop中，当剩余token低于输入窗口的25%时触发自动总结\n2. 多种压缩策略：\n   - 滑动窗口压缩：保留最近N轮对话\n   - 重要性评分压缩：根据消息重要性评分保留关键内容\n   - 增量摘要压缩：将对话历史分成chunks进行分段摘要\n   - 关键事件提取：提取关键事件保留重要信息\n   - 自适应压缩：根据任务类型（代码/分析/对话/混合）选择最适合的策略\n3. 自动总结机制：\n   - 基于token阈值：当剩余token低于25%时触发\n   - 基于对话轮次：可配置轮次阈值后触发\n   - 手动触发：支持!!!SUMMARY!!!标记\n4. Git diff优化：使用统计信息而非完整diff来减少token占用\n5. 消息截断：在BasePlatform中实现消息截断机制，避免超出token限制",
  "created_at": "2026-01-18T16:15:43.939081",
  "updated_at": "2026-01-18T16:15:43.939085"
}
