{
  "id": "20260113_010012_780778",
  "type": "project_long_term",
  "tags": ["worktree", "jarvis", "symlink", "分层软链接", "configuration"],
  "content": "Git Worktree分层软链接解决方案\n\n问题：\nworktree_manager.py的_link_jarvis_dir方法将整个.jarvis目录软链接到worktree，但.jarvis包含Git跟踪文件（rule和rules/），导致多个worktree间修改冲突。\n\n解决方案：\n实现分层软链接策略\n1. 在worktree中创建独立的.jarvis目录（不是软链接）\n2. Git跟踪文件（rule, rules/）保持独立，由Git自动检出\n3. 其他所有文件和目录创建软链接指向主仓库\n\n实现要点：\n- 处理已存在的.jarvis目录：如果是旧软链接则删除，如果是Git检出的则保留\n- 只创建缺失的软链接，避免重复操作\n- 方法幂等性：可重复执行\n- 向后兼容：自动处理旧配置\n\n修改文件：\n- src/jarvis/jarvis_code_agent/worktree_manager.py (_link_jarvis_dir方法)\n\n验证结果：\n✅ .jarvis目录为普通目录\n✅ rule和rules独立（Git跟踪）\n✅ 其他目录/文件软链接（memory, task_lists等）\n✅ Git状态干净\n✅ 方法幂等",
  "created_at": "2026-01-13T01:00:12.780798",
  "updated_at": "2026-01-13T01:00:12.780800"
}
